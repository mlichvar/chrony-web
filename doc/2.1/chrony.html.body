<a name="Top"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[ &lt; ]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="SEC_Top"></a>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Introduction">1 Introduction</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                What the chrony suite does
</td></tr>
<tr><td align="left" valign="top"><a href="#Installation">2 Installation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                How to compile and install the software
</td></tr>
<tr><td align="left" valign="top"><a href="#Typical-scenarios">3 Typical operating scenarios</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           How to configure the software for some common cases
</td></tr>
<tr><td align="left" valign="top"><a href="#Usage-reference">4 Usage reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Reference manual
</td></tr>
<tr><td align="left" valign="top"><a href="#GPL">Appendix A GNU General Public License</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                         The GNU General Public License
</td></tr>
</table>
<hr size="6">
<a name="Introduction"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Overview" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Introduction-1"></a>
<h1 class="chapter">1 Introduction</h1>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Overview">1.1 Overview</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    What the programs do
</td></tr>
<tr><td align="left" valign="top"><a href="#Acknowledgements">1.2 Acknowledgements</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Credit where credit is due
</td></tr>
<tr><td align="left" valign="top"><a href="#Availability">1.3 Availability</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Where to get the software
</td></tr>
<tr><td align="left" valign="top"><a href="#Other-time-synchronisation-packages">1.4 Relationship to other software packages</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Comparision with other software
</td></tr>
<tr><td align="left" valign="top"><a href="#Distribution-and-warranty">1.5 Distribution rights and (lack of) warranty</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   There is no warranty
</td></tr>
<tr><td align="left" valign="top"><a href="#Bug-reporting">1.6 Bug reporting and suggestions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               How to report bugs and make suggestions
</td></tr>
<tr><td align="left" valign="top"><a href="#Contributing">1.7 Contributions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Areas where contributions are particularly welcome
</td></tr>
</table>
<hr>
<a name="Overview"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgements" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Overview-1"></a>
<h2 class="section">1.1 Overview</h2>
<p>chrony is a versatile implementation of the Network Time Protocol (NTP).
It can synchronize the system clock with NTP servers, reference clocks
(e.g. GPS receiver), and manual input using wristwatch and keyboard.
It can also operate as an NTPv4 (RFC 5905) server and peer to provide
a time service to other computers in the network.
</p>
<p>It is designed to perform well in a wide range of conditions, including
intermittent network connections, heavily congested networks, changing
temperatures (ordinary computer clocks are sensitive to temperature),
and systems that do not run continuosly, or run on a virtual machine.
</p>
<p>Typical accuracy between two machines on a LAN is in tens, or a few
hundreds, of microseconds; over the Internet, accuracy is typically
within a few milliseconds.  With a good hardware reference clock
sub-microsecond accuracy is possible.
</p>
<p>Two programs are included in chrony, <code>chronyd</code> is a daemon that can
be started at boot time and <code>chronyc</code> is a command-line interface
program which can be used to monitor <code>chronyd</code>&rsquo;s performance and to
change various operating parameters whilst it is running.
</p>
<p>The IP addresses from which <code>chronyc</code> clients may connect can be tightly
controlled.  The default is just the computer that <code>chronyd</code> itself is
running on.
</p><hr>
<a name="Acknowledgements"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Overview" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Availability" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Acknowledgements-1"></a>
<h2 class="section">1.2 Acknowledgements</h2>

<p>The <code>chrony</code> suite makes use of the algorithm known as <em>RSA
Data Security, Inc. MD5 Message-Digest Algorithm</em> for authenticating
messages between different machines on the network.
</p>
<p>In writing the <code>chronyd</code> program, extensive use has been made of
RFC 1305 and RFC 5905, written by David Mills.  The source code of
the NTP reference implementation has been used to check details of the
protocol.
</p><hr>
<a name="Availability"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgements" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-the-software" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Availability-1"></a>
<h2 class="section">1.3 Availability</h2>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Getting-the-software">1.3.1 Getting the software</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Where can I get the software from?
</td></tr>
<tr><td align="left" valign="top"><a href="#Platforms">1.3.2 Platforms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                   Which platforms will it run on?
</td></tr>
</table>


<hr>
<a name="Getting-the-software"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Availability" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Availability" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Platforms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Getting-the-software-1"></a>
<h3 class="subsection">1.3.1 Getting the software</h3>
<p>Links on <a href="http://chrony.tuxfamily.org">the chrony home page</a>
describe how to obtain the software.
</p>

<hr>
<a name="Platforms"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-the-software" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Availability" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Other-time-synchronisation-packages" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Platforms-1"></a>
<h3 class="subsection">1.3.2 Platforms</h3>
<p>Although most of the program is portable between
Unix-like systems, there are parts that have to be tailored to each
specific vendor&rsquo;s system.  These are the parts that interface with the
operating system&rsquo;s facilities for adjusting the system clock;
different operating systems may provide different function calls to
achieve this, and even where the same function is used it may have
different quirks in its behaviour.
</p>
<p>The software is known to work on Linux, FreeBSD, NetBSD, Mac OS X and Solaris.
Closely related systems may work too.  Porting the software to other systems
(particularly to those supporting an <code>adjtime</code> system call) should not be
difficult, however it requires access to such systems to test out the driver.
</p><hr>
<a name="Other-time-synchronisation-packages"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Platforms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Comparison-with-ntpd" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Relationship-to-other-software-packages"></a>
<h2 class="section">1.4 Relationship to other software packages</h2>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Comparison-with-ntpd">1.4.1 ntpd</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Comparison-with-timed">1.4.2 timed</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       
</td></tr>
</table>

<hr>
<a name="Comparison-with-ntpd"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-time-synchronisation-packages" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-time-synchronisation-packages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Comparison-with-timed" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="ntpd"></a>
<h3 class="subsection">1.4.1 ntpd</h3>
<p>The &lsquo;reference&rsquo; implementation of the Network Time Protocol is the
program <code>ntpd</code>, available via
<a href="http://www.ntp.org/">The NTP home page</a>.
</p>
<p>One of the main differences between <code>ntpd</code> and <code>chronyd</code> is in
the algorithms used to control the computer&rsquo;s clock. Things
<code>chronyd</code> can do better than <code>ntpd</code>:
</p>
<ul>
<li>
<code>chronyd</code> can perform usefully in an environment where access to
the time reference is intermittent.  <code>ntpd</code> needs regular polling
of the reference to work well.
</li><li>
<code>chronyd</code> can usually synchronise the clock faster and with better
time accuracy.
</li><li>
<code>chronyd</code> quickly adapts to sudden changes in the rate of the clock
(e.g. due to changes in the temperature of the crystal oscillator).
<code>ntpd</code> may need a long time to settle down again.
</li><li>
<code>chronyd</code> can perform well even when the network is congested for
longer periods of time.
</li><li>
<code>chronyd</code> in the default configuration never steps the time to not
upset other running programs.  <code>ntpd</code> can be configured to never
step the time too, but it has to use a different means of adjusting the
clock, which has some
disadvantages.
</li><li>
<code>chronyd</code> can adjust the rate of the clock on Linux in a larger
range, which allows it to operate even on machines with broken or
unstable clock (e.g. in some virtual machines).
</li></ul>

<p>Things <code>chronyd</code> can do that <code>ntpd</code> can&rsquo;t:
</p>
<ul>
<li>
<code>chronyd</code> provides support for isolated networks whether the only
method of time correction is manual entry (e.g. by the administrator
looking at a clock).  <code>chronyd</code> can look at the errors corrected at
different updates to work out the rate at which the computer gains or
loses time, and use this estimate to trim the computer clock
subsequently.

</li><li>
<code>chronyd</code> provides support to work out the gain or loss rate of the
&lsquo;real-time clock&rsquo;, i.e. the clock that maintains the time when the
computer is turned off.  It can use this data when the system boots to
set the system time from a corrected version of the real-time clock.
These real-time clock facilities are only available on Linux, so far.
</li></ul>

<p>Things <code>ntpd</code> can do that <code>chronyd</code> can&rsquo;t:
</p>
<ul>
<li>
<code>ntpd</code> supports all operating modes from RFC 5905, including
broadcast, multicast and manycast client / server.  It supports the
orphan mode and it also supports authentication based on public-key
cryptography described in RFC 5906.

</li><li>
<code>ntpd</code> has been ported to more types of computer / operating
system.

</li><li>
<code>ntpd</code> includes drivers for many reference clocks. <code>chronyd</code>
relies on other programs (e.g. gpsd) to access the data from the
reference clocks.
</li></ul>

<hr>
<a name="Comparison-with-timed"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Comparison-with-ntpd" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-time-synchronisation-packages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Distribution-and-warranty" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="timed"></a>
<h3 class="subsection">1.4.2 timed</h3>
<p><code>timed</code> is a program that is part of the BSD networking suite.  It
uses broadcast packets to find all machines running the daemon within a
subnet.  The machines elect a master which periodically measures the
system clock offsets of the other computers using ICMP timestamps.
Corrections are sent to each member as a result of this process.
</p>
<p>Problems that may arise with <code>timed</code> are :
</p>
<ul>
<li>
Because it uses broadcasts, it is not possible to isolate its
functionality to a particular group of computers; there is a risk of
upsetting other computers on the same network (e.g. where a whole
company is on the same subnet but different departments are independent
from the point of view of administering their computers.)
</li><li>
The update period appears to be 10 minutes.  Computers can build up
significant offsets relative to each other in that time.  If a
computer can estimate its rate of drift it can keep itself closer to
the other computers between updates by adjusting its clock every few
seconds.  <code>timed</code> does not seem to do this.
</li><li>
<code>timed</code> does not have any integrated capability for feeding
real-time into its estimates, or for estimating the average rate of time
loss/gain of the machines relative to real-time (unless one of the
computers in the group has access to an external reference and is always
appointed as the &lsquo;master&rsquo;).
</li></ul>

<p><code>timed</code> does have the benefit over <code>chronyd</code> that for isolated
networks of computers, they will track the &lsquo;majority vote&rsquo; time.  For
such isolated networks, <code>chronyd</code> requires one computer to be the
&lsquo;master&rsquo; with the others slaved to it.  If the master has a particular
defective clock, the whole set of computers will tend to slip relative
to real time (but they <em>will</em> stay accurate relative to one
another).
</p><hr>
<a name="Distribution-and-warranty"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Comparison-with-timed" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Bug-reporting" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Distribution-rights-and-_0028lack-of_0029-warranty"></a>
<h2 class="section">1.5 Distribution rights and (lack of) warranty</h2>

<p>Chrony may be distributed in accordance with the GNU General Public License
version 2, reproduced in See section <a href="#GPL">GNU General Public License</a>.
</p>
<hr>
<a name="Bug-reporting"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Distribution-and-warranty" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Contributing" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Bug-reporting-and-suggestions"></a>
<h2 class="section">1.6 Bug reporting and suggestions</h2>

<p>If you think you&rsquo;ve found a bug in chrony, or have a suggestion, please let us
know.  You can join chrony users mailing list by sending a message with the
subject subscribe to <a href="mailto:chrony-users-request@chrony.tuxfamily.org">chrony-users-request@chrony.tuxfamily.org</a>.  Only
subscribers can post to the list.
</p>
<p>When you are reporting a bug, please send us all the information you can.
Unfortunately, chrony has proven to be one of those programs where it is very
difficult to reproduce bugs in a different environment.  So we may have to
interact with you quite a lot to obtain enough extra logging and tracing to
pin-point the problem in some cases.  Please be patient and plan for this!
</p>
<p>Of course, if you can debug the problem yourself and send us a source code
patch to fix it, we will be very grateful!
</p>
<hr>
<a name="Contributing"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Bug-reporting" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Contributions"></a>
<h2 class="section">1.7 Contributions</h2>

<p>Although chrony is now a fairly mature and established project, there are still
areas that could be improved.  If you can program in C and have some expertise
in these areas, you might be able to fill the gaps.
</p>
<p>Particular areas that need addressing are :
</p>
<ol>
<li> Porting to other Unices

<p>This involves creating equivalents of sys_solaris.c, sys_linux.c etc for the
new system.
</p>
</li><li> Porting to Windows NT

<p>A small amount of work on this was done under Cygwin.  Only the sorting
out of the include files has really been achieved so far.  The two main
areas still to address are
</p>
<ol>
<li> The system clock driver.
</li><li> How to make chronyd into an NT service (i.e. what to replace fork(),
setsid() etc with so that chronyd can be automatically started in the system
bootstrap.
</li></ol>

</li><li> More drivers for reference clock support

</li></ol>
<hr>
<a name="Installation"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Contributing" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#line-editing-support" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installation-1"></a>
<h1 class="chapter">2 Installation</h1>

<p>The software is distributed as source code which has to be compiled.
The source code is supplied in the form of a gzipped tar file, which
unpacks to a subdirectory identifying the name and version of the
program.
</p>
<p>After unpacking the source code, change directory into it, and type
</p>
<div class="example">
<pre class="example">./configure
</pre></div>

<p>This is a shell script that automatically determines the system type.
There is a single optional parameter, <code>--prefix</code> which indicates
the directory tree where the software should be installed.  For example,
</p>
<div class="example">
<pre class="example">./configure --prefix=/opt/free
</pre></div>

<p>will install the <code>chronyd</code> daemon into /opt/free/sbin and the
<code>chronyc</code> control program into /opt/free/bin.  The default value for the
prefix is /usr/local.
</p>
<p>The configure script assumes you want to use gcc as your compiler.
If you want to use a different compiler, you can configure this way:
</p>
<div class="example">
<pre class="example">CC=cc CFLAGS=-O ./configure --prefix=/opt/free
</pre></div>

<p>for Bourne-family shells, or
</p>    
<div class="example">
<pre class="example">setenv CC cc
setenv CFLAGS -O
./configure --prefix=/opt/free
</pre></div>

<p>for C-family shells.
</p>
<p>If the software cannot (yet) be built on your system, an error message
will be shown.  Otherwise, &lsquo;<tt>Makefile</tt>&rsquo; will be generated.
</p>
<p>If editline or readline library is available, chronyc will be built with line
editing support.  If you don&rsquo;t want this, specify the &ndash;disable-readline flag
to configure.  Please refer to see section <a href="#line-editing-support">Support for line editing libraries</a> for more information.
</p>
<p>If a &lsquo;<tt>timepps.h</tt>&rsquo; header is available (e.g. from the
<a href="http://linuxpps.org/">LinuxPPS project</a>), <code>chronyd</code> will be built with PPS API
reference clock driver.  If the header is installed in a location that isn&rsquo;t
normally searched by the compiler, you can add it to the searched locations by
setting <code>CPPFLAGS</code> variable to <code>-I/path/to/timepps</code>.
</p>
<p>Now type
</p>
<div class="example">
<pre class="example">make
</pre></div>

<p>to build the programs.
</p>
<p>If you want to build the manual in plain text, HTML and info versions, type
</p>
<div class="example">
<pre class="example">make docs
</pre></div>

<p>Once the programs have been successfully compiled, they need to be
installed in their target locations.  This step normally needs to be
performed by the superuser, and requires the following command to be
entered.
</p>
<div class="example">
<pre class="example">make install
</pre></div>

<p>This will install the binaries, plain text manual and manpages.
</p>
<p>To install the HTML and info versions of the manual as well, enter the command
</p>
<div class="example">
<pre class="example">make install-docs
</pre></div>

<p>If you want chrony to appear in the top level info directory listing, you need
to run the <code>install-info</code> command manually after this step.
<code>install-info</code> takes 2 arguments.  The first is the path to the
&lsquo;<tt>chrony.info</tt>&rsquo; file you have just installed.  This will be the argument you
gave to &ndash;prefix when you configured (&lsquo;<tt>/usr/local</tt>&rsquo; by default), with
&lsquo;<tt>/share/info/chrony.info</tt>&rsquo; on the end.  The second argument is the location of
the file called &lsquo;<tt>dir</tt>&rsquo;.  This will typically be &lsquo;<tt>/usr/share/info/dir</tt>&rsquo;.  So
the typical command line would be
</p>
<div class="example">
<pre class="example">install-info /usr/local/share/info/chrony.info /usr/share/info/dir
</pre></div>
    
<p>Now that the software is successfully installed, the next step is to
set up a configuration file.  The default location of the file
is &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;.  Several examples of configuration with
comments are included in the examples directory.  Suppose you want to use
public NTP servers from the pool.ntp.org project as your time reference.  A
minimal useful configuration file could be
</p>
<div class="example">
<pre class="example">pool pool.ntp.org iburst
makestep 10 3
rtcsync
</pre></div>

<p>Then, <code>chronyd</code> can be run.
</p><table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#line-editing-support">2.1 Support for line editing libraries</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        If libraries are in a non-standard place
</td></tr>
<tr><td align="left" valign="top"><a href="#package-builders">2.2 Extra options for package builders</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Extra options useful to package builders
</td></tr>
</table>
<hr>
<a name="line-editing-support"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#package-builders" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Support-for-line-editing-libraries"></a>
<h2 class="section">2.1 Support for line editing libraries</h2>
<p>Chronyc can be built with support for line editing, this allows you to use the
cursor keys to replay and edit old commands.  Two libraries are supported which
provide such functionality, editline and GNU readline.
</p>
<p>Please note that readline since version 6.0 is licensed under GPLv3+ which is
incompatible with chrony&rsquo;s license GPLv2.  You should use editline instead if
you don&rsquo;t want to use older readline versions.
</p>
<p>The configure script will automatically enable the line editing support if one
of the supported libraries is available.  If they are both available, the
editline library will be used.
</p>
<p>If you don&rsquo;t want to use it (in which case chronyc will use a minimal command
line interface), invoke configure like this:
</p>
<div class="example">
<pre class="example">./configure --disable-readline other-options...
</pre></div>

<p>If you have editline, readline or ncurses installed in locations that aren&rsquo;t
normally searched by the compiler and linker, you need to use extra options:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>--with-readline-includes=directory_name</samp>&rsquo;</dt>
<dd><p>This defines the name of the directory above the one where &lsquo;<tt>readline.h</tt>&rsquo;
is.  &lsquo;<tt>readline.h</tt>&rsquo; is assumed to be in &lsquo;<tt>editline</tt>&rsquo; or &lsquo;<tt>readline</tt>&rsquo;
subdirectory of the named directory.
</p>
</dd>
<dt>&lsquo;<samp>--with-readline-library=directory_name</samp>&rsquo;</dt>
<dd><p>This defines the directory containing the &lsquo;<tt>libedit.a</tt>&rsquo; or &lsquo;<tt>libedit.so</tt>&rsquo;
file, or &lsquo;<tt>libreadline.a</tt>&rsquo; or &lsquo;<tt>libreadline.so</tt>&rsquo; file.
</p>
</dd>
<dt>&lsquo;<samp>--with-ncurses-library=directory_name</samp>&rsquo;</dt>
<dd><p>This defines the directory containing the &lsquo;<tt>libncurses.a</tt>&rsquo; or
&lsquo;<tt>libncurses.so</tt>&rsquo; file.
</p></dd>
</dl>

<hr>
<a name="package-builders"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#line-editing-support" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Extra-options-for-package-builders"></a>
<h2 class="section">2.2 Extra options for package builders</h2>
<p>The configure and make procedures have some extra options that may be useful if
you are building a distribution package for chrony.
</p>
<p>The &ndash;infodir=DIR option to configure specifies an install directory
for the info files.  This overrides the &lsquo;<tt>info</tt>&rsquo; subdirectory of the
argument to the &ndash;prefix option.  For example, you might use
</p>
<div class="example">
<pre class="example">./configure --prefix=/usr --infodir=/usr/share/info
</pre></div>

<p>The &ndash;mandir=DIR option to configure specifies an install directory
for the man pages.  This overrides the &lsquo;<tt>man</tt>&rsquo; subdirectory of the
argument to the &ndash;prefix option.
</p>
<div class="example">
<pre class="example">./configure --prefix=/usr --infodir=/usr/share/info --mandir=/usr/share/man
</pre></div>

<p>to set both options together.
</p>
<p>The final option is the DESTDIR option to the make command.  For example, you
could use the commands
</p>
<div class="example">
<pre class="example">./configure --prefix=/usr --infodir=/usr/share/info --mandir=/usr/share/man
make all docs
make install DESTDIR=./tmp
cd tmp
tar cvf - . | gzip -9 &gt; chrony.tar.gz
</pre></div>

<p>to build a package.  When untarred within the root directory, this will install
the files to the intended final locations.
</p>

<hr>
<a name="Typical-scenarios"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#package-builders" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Computers-on-the-net" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Typical-operating-scenarios"></a>
<h1 class="chapter">3 Typical operating scenarios</h1>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Computers-on-the-net">3.1 Computers connected to the internet</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Your computer is on the Internet most of the time
                                (or on a private network with NTP servers)
</td></tr>
<tr><td align="left" valign="top"><a href="#Infrequent-connection">3.2 Infrequent connection to true NTP servers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       You connect to the Internet sometimes (e.g. via a modem)
</td></tr>
<tr><td align="left" valign="top"><a href="#Isolated-networks">3.3 Isolated networks</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           You have an isolated network with no reference clocks
</td></tr>
<tr><td align="left" valign="top"><a href="#Dial_002dup-home-PCs">3.4 The home PC with a dial-up connection</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Additional considerations if you turn your computer off
                                when it&rsquo;s not in use
</td></tr>
<tr><td align="left" valign="top"><a href="#Configuration-options-overview">3.5 Other important configuration options</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Overview of some configuration options
</td></tr>
</table>
<hr>
<a name="Computers-on-the-net"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Infrequent-connection" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Computers-connected-to-the-internet"></a>
<h2 class="section">3.1 Computers connected to the internet</h2>
<p>In this section we discuss how to configure chrony for computers that
are connected to the Internet (or to any network containing true NTP
servers which ultimately derive their time from a reference clock)
permanently or most of the time.
</p>
<p>To operate in this mode, you will need to know the names of the NTP
server machines you wish to use.  You may be able to find names of
suitable servers by one of the following methods:
</p>
<ul>
<li> Your institution may already operate servers on its network.
Contact your system administrator to find out.

</li><li> Your ISP probably has one or more NTP servers available for its
customers.

</li><li> Somewhere under the NTP homepage there is a list of public
stratum 1 and stratum 2 servers.  You should find one or more servers
that are near to you &mdash; check that their access policy allows you to
use their facilities.

</li><li> Use public servers from
<a href="http://www.pool.ntp.org/">the pool.ntp.org project</a>.
</li></ul>

<p>Assuming that you have found some servers, you need to set up a
configuration file to run chrony.  The (compiled-in) default location
for this file is &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;.  Assuming that your NTP
servers are called <code>foo.example.net</code>, <code>bar.example.net</code> and
<code>baz.example.net</code>, your &lsquo;<tt>chrony.conf</tt>&rsquo; file could contain as a minimum
</p>
<div class="example">
<pre class="example">server foo.example.net
server bar.example.net
server baz.example.net
</pre></div>

<p>However, you will probably want to include some of the other directives
described later.  The following directives may be particularly useful :
<code>driftfile</code>, <code>makestep</code>, <code>rtcsync</code>.  Also, the <code>iburst</code>
server option is useful to speed up the initial synchronization.  The smallest
useful configuration file would look something like
</p>
<div class="example">
<pre class="example">server foo.example.net iburst
server bar.example.net iburst
server baz.example.net iburst
driftfile /var/lib/chrony/drift
makestep 10 3
rtcsync
</pre></div>

<p>When using a pool of NTP servers (one name is used for multiple servers which
may change over time), it&rsquo;s better to specify them with the <code>pool</code>
directive instead of multiple <code>server</code> directives.  The configuration file
could in this case look like
</p>
<div class="example">
<pre class="example">pool pool.ntp.org iburst
driftfile /var/lib/chrony/drift
makestep 10 3
rtcsync
</pre></div>
<hr>
<a name="Infrequent-connection"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Computers-on-the-net" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-for-infrequent-connections" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Infrequent-connection-to-true-NTP-servers"></a>
<h2 class="section">3.2 Infrequent connection to true NTP servers</h2>
<p>In this section we discuss how to configure chrony for computers that
have occasional connections to the internet.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Configuration-for-infrequent-connections">3.2.1 Setting up the configuration file for infrequent connections</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  How to set up the <code>/etc/chrony.conf</code> file
</td></tr>
<tr><td align="left" valign="top"><a href="#Advising-chronyd-of-internet-availability">3.2.2 How to tell chronyd when the internet link is available.</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  How to tell chronyd when the link is available
</td></tr>
</table>

<hr>
<a name="Configuration-for-infrequent-connections"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Infrequent-connection" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Infrequent-connection" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Advising-chronyd-of-internet-availability" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Setting-up-the-configuration-file-for-infrequent-connections"></a>
<h3 class="subsection">3.2.1 Setting up the configuration file for infrequent connections</h3>
<p>As in the previous section, you will need access to NTP servers on the
internet.  The same remarks apply for how to find them.
</p>
<p>In this case, you will need some additional configuration to tell
<code>chronyd</code> when the connection to the internet goes up and down.
This saves the program from continuously trying to poll the servers when
they are inaccessible.
</p>
<p>Again, assuming that your NTP servers are called <code>foo.example.net</code>,
<code>bar.example.net</code> and <code>baz.example.net</code>, your &lsquo;<tt>chrony.conf</tt>&rsquo; file
would need to contain something like
</p>
<div class="example">
<pre class="example">server foo.example.net
server bar.example.net
server baz.example.net
</pre></div>

<p>However, your computer will keep trying to contact the servers to obtain
timestamps, even whilst offline.  If you operate a dial-on-demand
system, things are even worse, because the link to the internet will
keep getting established.
</p>
<p>For this reason, it would be better to specify this part of your
configuration file in the following way:
</p>
<div class="example">
<pre class="example">server foo.example.net offline
server bar.example.net offline
server baz.example.net offline
</pre></div>

<p>The <code>offline</code> keyword indicates that the servers start
in an offline state, and that they should not be contacted until <code>chronyd</code>
receives notification that the link to the internet is present.
</p>
<p>In order to notify <code>chronyd</code> of the presence of the link, you will need to
be able to log in to it with the program <code>chronyc</code>.  To do this,
<code>chronyd</code> needs to be configured with an administrator password.  The
password is read from a file specified by the <code>keyfile</code> directive.  The
<code>generatecommandkey</code> directive can be used to generate a random password
automatically on the first <code>chronyd</code> start.
</p>
<p>The smallest useful configuration file would look something like
</p>
<div class="example">
<pre class="example">server foo.example.net offline
server bar.example.net offline
server baz.example.net offline
keyfile /etc/chrony.keys
generatecommandkey
driftfile /var/lib/chrony/drift
makestep 10 3
</pre></div>

<p>The next section describes how to tell <code>chronyd</code> when the internet link
goes up and down.
</p>
<hr>
<a name="Advising-chronyd-of-internet-availability"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-for-infrequent-connections" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Infrequent-connection" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Isolated-networks" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="How-to-tell-chronyd-when-the-internet-link-is-available_002e"></a>
<h3 class="subsection">3.2.2 How to tell chronyd when the internet link is available.</h3>
<p>To use this option, you will need to configure a command key in
<code>chronyd's</code> configuration file &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;, as described in
the previous section.
</p>
<p>To tell <code>chronyd</code> when to start and finish sampling the servers, the
<code>online</code> and <code>offline</code> commands of chronyc need to be used.
To give an example of their use, we assume that <code>pppd</code> is the
program being used to connect to the internet, and that chronyc has been
installed at its default location &lsquo;<tt>/usr/local/bin/chronyc</tt>&rsquo;.  We
also assume that the command key has been set up as described in the
previous section.
</p>
<p>In the file &lsquo;<tt>/etc/ppp/ip-up</tt>&rsquo; we add the command sequence
</p>
<div class="example">
<pre class="example">/usr/local/bin/chronyc -a online
</pre></div>

<p>and in the file &lsquo;<tt>/etc/ppp/ip-down</tt>&rsquo; we add the sequence
</p>
<div class="example">
<pre class="example">/usr/local/bin/chronyc -a offline
</pre></div>

<p><code>chronyd's</code> polling of the servers will now only occur whilst the
machine is actually connected to the Internet.
</p><hr>
<a name="Isolated-networks"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Advising-chronyd-of-internet-availability" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-home-PCs" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Isolated-networks-1"></a>
<h2 class="section">3.3 Isolated networks</h2>
<p>In this section we discuss how to configure chrony for computers that
never have network conectivity to any computer which ultimately derives
its time from a reference clock.
</p>
<p>In this situation, one computer is selected to be the master timeserver.
The other computers are either direct clients of the master, or clients
of clients.
</p>
<p>The rate value in the master&rsquo;s drift file needs to be set to the average
rate at which the master gains or loses time.  <code>chronyd</code> includes
support for this, in the form of the <code>manual</code> directive in the
configuration file and the <code>settime</code> command in the <code>chronyc</code>
program.
</p>
<p>If the master is rebooted, <code>chronyd</code> can re-read the drift rate
from the drift file.  However, the master has no accurate estimate of
the current time.  To get around this, the system can be configured so
that the master can initially set itself to a &lsquo;majority-vote&rsquo; of
selected clients&rsquo; times; this allows the clients to &lsquo;flywheel&rsquo; the
master across its outage.
</p>
<p>A typical configuration file for the master (called <code>master</code>) might
be (assuming the clients are in the 192.168.165.x subnet and that the
master&rsquo;s address is 192.168.169.170)
</p>
<div class="example">
<pre class="example">driftfile /var/lib/chrony/drift
generatecommandkey
keyfile /etc/chrony.keys
initstepslew 10 client1 client3 client6
local stratum 8
manual
allow 192.168.165
</pre></div>

<p>For the clients that have to resynchronise the master when it restarts,
the configuration file might be
</p>
<div class="example">
<pre class="example">server master
driftfile /var/lib/chrony/drift
logdir /var/log/chrony
log measurements statistics tracking
keyfile /etc/chrony.keys
generatecommandkey
local stratum 10
initstepslew 20 master
allow 192.168.169.170
</pre></div>

<p>The rest of the clients would be the same, except that the <code>local</code>
and <code>allow</code> directives are not required.
</p><hr>
<a name="Dial_002dup-home-PCs"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Isolated-networks" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-overview" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-home-PC-with-a-dial_002dup-connection"></a>
<h2 class="section">3.4 The home PC with a dial-up connection</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Dial_002dup-overview">3.4.1 Assumptions/how the software works</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            General discussion of how the software operates in this mode
</td></tr>
<tr><td align="left" valign="top"><a href="#Dial_002dup-configuration">3.4.2 Typical configuration files.</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>

<hr>
<a name="Dial_002dup-overview"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-home-PCs" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-home-PCs" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-configuration" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Assumptions_002fhow-the-software-works"></a>
<h3 class="subsection">3.4.1 Assumptions/how the software works</h3>
<p>This section considers the home computer which has a dial-up connection.
It assumes that Linux is run exclusively on the computer.  Dual-boot
systems may work; it depends what (if anything) the other system does to
the system&rsquo;s real-time clock.
</p>
<p>Much of the configuration for this case is discussed earlier
(see section <a href="#Infrequent-connection">Infrequent connection to true NTP servers</a>).  This section addresses specifically
the case of a computer which is turned off between &rsquo;sessions&rsquo;.
</p>
<p>In this case, <code>chronyd</code> relies on the computer&rsquo;s real-time clock
(RTC) to maintain the time between the periods when it is powered up.
The arrangement is shown in the figure below.
</p>
<div class="example">
<pre class="example">            trim if required                          PSTN
      +---------------------------+               +----------+
      |                           |               |          |
      v                           |               |          |
+---------+                    +-------+       +-----+     +---+
| System's|  measure error/    |chronyd|       |modem|     |ISP|
|real-time|-------------------&gt;|       |-------|     |     |   |
|  clock  |   drift rate       +-------+       +-----+     +---+
+---------+                       ^                          |
      |                           |                          |
      +---------------------------+                  --o-----o---
         set time at boot up                           |
                                                  +----------+
                                                  |NTP server|
                                                  +----------+
</pre></div>

<p>When the computer is connected to the Internet (via the modem),
<code>chronyd</code> has access to external NTP servers which it makes
measurements from.  These measurements are saved, and straight-line fits
are performed on them to provide an estimate of the computer&rsquo;s time
error and rate of gaining/losing time.
</p>
<p>When the computer is taken offline from the Internet, the best estimate
of the gain/loss rate is used to free-run the computer until it next
goes online.
</p>
<p>Whilst the computer is running, <code>chronyd</code> makes measurements of the
real-time clock (RTC) (via the &lsquo;<tt>/dev/rtc</tt>&rsquo; interface, which must be
compiled into the kernel).  An estimate is made of the RTC error at a
particular RTC second, and the rate at which the RTC gains or loses time
relative to true time.
</p>
<p>On 2.6 and later kernels, if your motherboard has a HPET, you need to enable the
&lsquo;<samp>HPET_EMULATE_RTC</samp>&rsquo; option in your kernel configuration.  Otherwise, chrony
will not be able to interact with the RTC device and will give up using it.
</p>
<p>When the computer is powered down, the measurement histories for all the
NTP servers are saved to files (if the <code>dumponexit</code> directive is
specified in the configuration file), and the RTC tracking information
is also saved to a file (if the <code>rtcfile</code> directive has been
specified).  These pieces of information are also saved if the
<code>dump</code> and <code>writertc</code> commands respectively are issued through
<code>chronyc</code>.
</p>
<p>When the computer is rebooted, <code>chronyd</code> reads the current RTC time
and the RTC information saved at the last shutdown.  This information is
used to set the system clock to the best estimate of what its time would
have been now, had it been left running continuously.  The measurement
histories for the servers are then reloaded.
</p>
<p>The next time the computer goes online, the previous sessions&rsquo;
measurements can contribute to the line-fitting process, which gives a
much better estimate of the computer&rsquo;s gain/loss rate.
</p>
<p>One problem with saving the measurements and RTC data when the machine
is shut down is what happens if there is a power failure; the most
recent data will not be saved.  Although <code>chronyd</code> is robust enough
to cope with this, some performance may be lost.  (The main danger
arises if the RTC has been changed during the session, with the
<code>trimrtc</code> command in <code>chronyc</code>.  Because of this,
<code>trimrtc</code> will make sure that a meaningful RTC file is saved out
after the change is completed).
</p>
<p>The easiest protection against power failure is to put the <code>dump</code>
and <code>writertc</code> commands in the same place as the <code>offline</code>
command is issued to take <code>chronyd</code> offline; because <code>chronyd</code>
free-runs between online sessions, no parameters will change
significantly between going offline from the Internet and any power
failure.
</p>
<p>A final point regards home computers which are left running for extended
periods and where it is desired to spin down the hard disc when it is
not in use (e.g. when not accessed for 15 minutes).  <code>chronyd</code> has
been planned so it supports such operation; this is the reason why the
RTC tracking parameters are not saved to disc after every update, but
only when the user requests such a write, or during the shutdown
sequence.  The only other facility that will generate periodic writes to
the disc is the <code>log rtc</code> facility in the configuration file; this
option should not be used if you want your disc to spin down.
</p>
<hr>
<a name="Dial_002dup-configuration"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-overview" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-home-PCs" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-options-overview" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Typical-configuration-files_002e"></a>
<h3 class="subsection">3.4.2 Typical configuration files.</h3>

<p>To illustrate how a dial-up home computer might be configured, example
configuration files are shown in this section.
</p>
<p>For the &lsquo;<tt>/etc/chrony.conf</tt>&rsquo; file, the following can be used as an
example.
</p>
<div class="example">
<pre class="example">server foo.example.net maxdelay 0.4 offline
server bar.example.net maxdelay 0.4 offline
server baz.example.net maxdelay 0.4 offline
logdir /var/log/chrony
log statistics measurements tracking
driftfile /var/lib/chrony/drift
keyfile /etc/chrony.keys
generatecommandkey
makestep 10 3
maxupdateskew 100.0
dumponexit
dumpdir /var/lib/chrony
rtcfile /var/lib/chrony/rtc
</pre></div>

<p><code>pppd</code> is used for connecting to the internet.  This runs two scripts
&lsquo;<tt>/etc/ppp/ip-up</tt>&rsquo; and &lsquo;<tt>/etc/ppp/ip-down</tt>&rsquo; when the link goes
online and offline respectively.
</p>
<p>The relevant part of the &lsquo;<tt>/etc/ppp/ip-up</tt>&rsquo; file is
</p>
<div class="example">
<pre class="example">/usr/local/bin/chronyc -a online
</pre></div>

<p>and the relevant part of the &lsquo;<tt>/etc/ppp/ip-down</tt>&rsquo; script is
</p>
<div class="example">
<pre class="example">/usr/local/bin/chronyc -a -m offline dump writertc
</pre></div>

<p>To start <code>chronyd</code> during the boot sequence, the following
is in &lsquo;<tt>/etc/rc.d/rc.local</tt>&rsquo; (this is a Slackware system)
</p>
<div class="example">
<pre class="example">if [ -f /usr/local/sbin/chronyd -a -f /etc/chrony.conf ]; then
  /usr/local/sbin/chronyd -r -s
  echo &quot;Start chronyd&quot;
fi
</pre></div>

<p>The placement of this command may be important on some systems.  In
particular, <code>chronyd</code> may need to be started before any software
that depends on the system clock not jumping or moving backwards,
depending on the directives in <code>chronyd's</code> configuration file.
</p>
<p>For the system shutdown, <code>chronyd</code> should receive a SIGTERM several
seconds before the final SIGKILL; the SIGTERM causes the measurement
histories and RTC information to be saved out.
</p><hr>
<a name="Configuration-options-overview"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Dial_002dup-configuration" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Typical-scenarios" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Other-important-configuration-options"></a>
<h2 class="section">3.5 Other important configuration options</h2>
<p>The most common option to include in the configuration file is the
<code>driftfile</code> option.  One of the major tasks of <code>chronyd</code> is to
work out how fast or how slow the system clock runs relative to real
time - e.g. in terms of seconds gained or lost per day.  Measurements
over a long period are usually required to refine this estimate to an
acceptable degree of accuracy.  Therefore, it would be bad if
<code>chronyd</code> had to work the value out each time it is restarted,
because the system clock would not run so accurately whilst the
determination is taking place.
</p>
<p>To avoid this problem, <code>chronyd</code> allows the gain or loss rate to be
stored in a file, which can be read back in when the program is
restarted.  This file is called the drift file, and might typically be
stored in &lsquo;<tt>/var/lib/chrony/drift</tt>&rsquo;.  By specifying an option like the
following
</p>
<div class="example">
<pre class="example">driftfile /var/lib/chrony/drift
</pre></div>

<p>in the configuration file (&lsquo;<tt>/etc/chrony.conf</tt>&rsquo;), the drift file
facility will be activated.
</p><hr>
<a name="Usage-reference"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Typical-scenarios" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-options-overview" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Starting-chronyd" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Usage-reference-1"></a>
<h1 class="chapter">4 Usage reference</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Starting-chronyd">4.1 Starting chronyd</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Command line options for the daemon
</td></tr>
<tr><td align="left" valign="top"><a href="#Configuration-file">4.2 The chronyd configuration file</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Format of the configuration file
</td></tr>
<tr><td align="left" valign="top"><a href="#Running-chronyc">4.3 Running chronyc</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             The run-time configuration program
</td></tr>
</table>
<hr>
<a name="Starting-chronyd"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Starting-chronyd-1"></a>
<h2 class="section">4.1 Starting chronyd</h2>
<p>If <code>chronyd</code> has been installed to its default location
&lsquo;<tt>/usr/local/sbin/chronyd</tt>&rsquo;, starting it is simply a matter of
entering the command
</p>
<div class="example">
<pre class="example">/usr/local/sbin/chronyd
</pre></div>

<p>Information messages and warnings will be logged to syslog.
</p>
<p>If no configuration commands are specified on the command line,
<code>chronyd</code> will read the commands from the configuration file
(default &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;).
</p>
<p>The command line options supported are as follows:
</p>
<dl compact="compact">
<dt><code>-n</code></dt>
<dd><p>When run in this mode, the program will not detach itself from the
terminal.
</p></dd>
<dt><code>-d</code></dt>
<dd><p>When run in this mode, the program will not detach itself from the
terminal, and all messages will be sent to the terminal instead of to
syslog.  When <code>chronyd</code> was compiled with debugging support,
this option can be used twice to print also debugging messages.
</p></dd>
<dt><code>-f &lt;conf-file&gt;</code></dt>
<dd><p>This option can be used to specify an alternate location for the
configuration file (default &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;).
</p></dd>
<dt><code>-r</code></dt>
<dd><p>This option will reload sample histories for each of the servers and refclocks being
used.  These histories are created by using the <code>dump</code> command in
<code>chronyc</code>, or by setting the <code>dumponexit</code> directive in the
configuration file.  This option is useful if you want to stop and
restart <code>chronyd</code> briefly for any reason, e.g. to install a new
version.  However, it only makes sense on systems where the kernel can
maintain clock compensation whilst not under <code>chronyd's</code> control.
The only version where this happens so far is Linux.  On other systems
this option should not be used.
</p></dd>
<dt><code>-R</code></dt>
<dd><p>When this option is used, the <code>initstepslew</code> directive and the
<code>makestep</code> directive used with a positive limit will be ignored.
This option is useful when restarting <code>chronyd</code> and can be used
in conjunction with the &lsquo;-r&rsquo; option.
</p>
</dd>
<dt><code>-s</code></dt>
<dd><p>This option will set the system clock from the computer&rsquo;s real-time
clock.  This is analogous to supplying the &lsquo;-s&rsquo; flag to the
&lsquo;<tt>/sbin/hwclock</tt>&rsquo; program during the Linux boot sequence.
</p>
<p>Support for real-time clocks is limited at present - the criteria are
described in the section on the <code>rtcfile</code> directive (see section <a href="#rtcfile-directive">rtcfile</a>).
</p>
<p>If used in conjunction with the &lsquo;-r&rsquo; flag, <code>chronyd</code> will attempt
to preserve the old samples after setting the system clock from the real
time clock (RTC).  This can be used to allow <code>chronyd</code> to perform long
term averaging of the gain or loss rate across system reboots, and is
useful for dial-up systems that are shut down when not in use.  For this
to work well, it relies on <code>chronyd</code> having been able to determine
accurate statistics for the difference between the RTC and
system clock last time the computer was on.
</p>
<p>If <code>chronyd</code> doesn&rsquo;t support the RTC on your computer or there is no RTC
installed, the system clock will be set with this option forward to the time of
the last modification of the drift file (specified by the <code>driftfile</code>
directive) to restore the system time at which <code>chronyd</code> was previously
stopped.
</p></dd>
<dt><code>-u &lt;user&gt;</code></dt>
<dd><p>This option sets the name of the user to which will <code>chronyd</code> switch to
drop root privileges if compiled with Linux capabilities support (default
<code>root</code>).
</p></dd>
<dt><code>-q</code></dt>
<dd><p>When run in this mode, <code>chronyd</code> will set the system clock once
and exit.  It will not detach from the terminal.
</p></dd>
<dt><code>-Q</code></dt>
<dd><p>This option is similar to &lsquo;-q&rsquo;, but it will only print the offset and
not correct the clock.
</p></dd>
<dt><code>-v</code></dt>
<dd><p>This option displays <code>chronyd's</code> version number to the terminal and
exits.
</p></dd>
<dt><code>-P &lt;priority&gt;</code></dt>
<dd><p>This option will select the SCHED_FIFO real-time scheduler at the
specified priority (which must be between 0 and 100).  This mode is
supported only on Linux.
</p></dd>
<dt><code>-m</code></dt>
<dd><p>This option will lock chronyd into RAM so that it will never be paged
out.  This mode is only supported on Linux.
</p></dd>
<dt><code>-4</code></dt>
<dd><p>With this option hostnames will be resolved only to IPv4 addresses and only
IPv4 sockets will be created.
</p></dd>
<dt><code>-6</code></dt>
<dd><p>With this option hostnames will be resolved only to IPv6 addresses and only
IPv6 sockets will be created.
</p></dd>
</dl>

<p>On systems that support an &lsquo;<tt>/etc/rc.local</tt>&rsquo; file for starting
programs at boot time, <code>chronyd</code> can be started from there.
</p>
<p>On systems with a System V style initialisation, a
suitable start/stop script might be as shown below.  This might be
placed in the file &lsquo;<tt>/etc/rc2.d/S83chrony</tt>&rsquo;.
</p>
<div class="example">
<pre class="example">#!/bin/sh
# This file should have uid root, gid sys and chmod 744
#

killproc() {            # kill the named process(es)
        pid=`/usr/bin/ps -e |
             /usr/bin/grep -w $1 |
             /usr/bin/sed -e 's/^  *//' -e 's/ .*//'`
        [ &quot;$pid&quot; != &quot;&quot; ] &amp;&amp; kill $pid
}

case &quot;$1&quot; in

'start')
   if [ -f /opt/free/sbin/chronyd -a -f /etc/chrony.conf ]; then
     /opt/free/sbin/chronyd
   fi
   ;;
'stop')
   killproc chronyd
   ;;
*)
   echo &quot;Usage: /etc/rc2.d/S83chrony { start | stop }&quot;
   ;;
esac
</pre></div>

<p>(In both cases, you may want to bear in mind that <code>chronyd</code> can
step the time when it starts.  There may be other programs started at
boot time that could be upset by this, so you may need to consider the
ordering carefully.  However, <code>chronyd</code> will need to start after
daemons providing services that it may require, e.g. the domain name
service.)
</p><hr>
<a name="Configuration-file"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Starting-chronyd" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#comments-in-config-file" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-chronyd-configuration-file"></a>
<h2 class="section">4.2 The chronyd configuration file</h2>
<p>The configuration file is normally called &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;; in
fact, this is the compiled-in default. However, other locations can be
specified with a command line option.
</p>
<p>Each command in the configuration file is placed on a separate line.
The following sections describe each of the commands in turn.  The
directives can occur in any order in the file and they are not
case-sensitive.
</p>
<p>The configuration commands can also be specified directly on the
<code>chronyd</code> command line, each argument is parsed as a line and
the configuration file is ignored.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#comments-in-config-file">4.2.1 Comments in the configuration file</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     How to write a comment
</td></tr>
<tr><td align="left" valign="top"><a href="#acquisitionport-directive">4.2.2 acquisitionport</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   Set NTP client port
</td></tr>
<tr><td align="left" valign="top"><a href="#allow-directive">4.2.3 allow</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Give access to NTP clients
</td></tr>
<tr><td align="left" valign="top"><a href="#bindacqaddress-directive">4.2.4 bindacqaddress</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    Limit network interface used by NTP client
</td></tr>
<tr><td align="left" valign="top"><a href="#bindaddress-directive">4.2.5 bindaddress</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Limit network interface used by NTP server
</td></tr>
<tr><td align="left" valign="top"><a href="#bindcmdaddress-directive">4.2.6 bindcmdaddress</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    Limit network interface used for commands
</td></tr>
<tr><td align="left" valign="top"><a href="#broadcast-directive">4.2.7 broadcast</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Make chronyd act as an NTP broadcast server
</td></tr>
<tr><td align="left" valign="top"><a href="#clientloglimit-directive">4.2.8 clientloglimit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    Set client log memory limit
</td></tr>
<tr><td align="left" valign="top"><a href="#cmdallow-directive">4.2.9 cmdallow</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Give control access to chronyc on other computers
</td></tr>
<tr><td align="left" valign="top"><a href="#cmddeny-directive">4.2.10 cmddeny</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Deny control access to chronyc on other computers
</td></tr>
<tr><td align="left" valign="top"><a href="#cmdport-directive">4.2.11 cmdport</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Set port to use for runtime commanding
</td></tr>
<tr><td align="left" valign="top"><a href="#combinelimit-directive">4.2.12 combinelimit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Limit sources included in combining algorithm
</td></tr>
<tr><td align="left" valign="top"><a href="#commandkey-directive">4.2.13 commandkey</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Set runtime command key
</td></tr>
<tr><td align="left" valign="top"><a href="#corrtimeratio-directive">4.2.14 corrtimeratio</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Set correction time ratio
</td></tr>
<tr><td align="left" valign="top"><a href="#deny-directive">4.2.15 deny</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Deny access to NTP clients
</td></tr>
<tr><td align="left" valign="top"><a href="#driftfile-directive">4.2.16 driftfile</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Specify location of file containing drift data
</td></tr>
<tr><td align="left" valign="top"><a href="#dumpdir-directive">4.2.17 dumpdir</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Specify directory for dumping measurements
</td></tr>
<tr><td align="left" valign="top"><a href="#dumponexit-directive">4.2.18 dumponexit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Dump measurements when daemon exits
</td></tr>
<tr><td align="left" valign="top"><a href="#fallbackdrift-directive">4.2.19 fallbackdrift</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Specify fallback drift intervals
</td></tr>
<tr><td align="left" valign="top"><a href="#generatecommandkey-directive">4.2.20 generatecommandkey</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> Generate command key automatically
</td></tr>
<tr><td align="left" valign="top"><a href="#hwclockfile-directive">4.2.21 hwclockfile</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Specify location of hwclock&rsquo;s adjtime file
</td></tr>
<tr><td align="left" valign="top"><a href="#include-directive">4.2.22 include</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Include a configuration file
</td></tr>
<tr><td align="left" valign="top"><a href="#initstepslew-directive">4.2.23 initstepslew</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Trim the system clock on boot-up
</td></tr>
<tr><td align="left" valign="top"><a href="#keyfile-directive">4.2.24 keyfile</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Specify location of file containing keys
</td></tr>
<tr><td align="left" valign="top"><a href="#leapsecmode-directive">4.2.25 leapsecmode</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Select leap second handling mode
</td></tr>
<tr><td align="left" valign="top"><a href="#leapsectz-directive">4.2.26 leapsectz</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Read leap second data from tz database
</td></tr>
<tr><td align="left" valign="top"><a href="#local-directive">4.2.27 local</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Allow unsynchronised machine to act as server
</td></tr>
<tr><td align="left" valign="top"><a href="#lock_005fall-directive">4.2.28 lock_all</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Require that chronyd be locked into RAM
</td></tr>
<tr><td align="left" valign="top"><a href="#log-directive">4.2.29 log</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Make daemon log certain sets of information
</td></tr>
<tr><td align="left" valign="top"><a href="#logbanner-directive">4.2.30 logbanner</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Specify how often is banner written to log files
</td></tr>
<tr><td align="left" valign="top"><a href="#logchange-directive">4.2.31 logchange</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Generate syslog messages if large offsets occur
</td></tr>
<tr><td align="left" valign="top"><a href="#logdir-directive">4.2.32 logdir</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Specify directory for logging
</td></tr>
<tr><td align="left" valign="top"><a href="#mailonchange-directive">4.2.33 mailonchange</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Send email if a clock correction above a threshold occurs
</td></tr>
<tr><td align="left" valign="top"><a href="#makestep-directive">4.2.34 makestep</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Step system clock if large correction is needed
</td></tr>
<tr><td align="left" valign="top"><a href="#manual-directive">4.2.35 manual</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Allow manual entry using chronyc&rsquo;s settime cmd
</td></tr>
<tr><td align="left" valign="top"><a href="#maxchange-directive">4.2.36 maxchange</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Set maximum allowed offset
</td></tr>
<tr><td align="left" valign="top"><a href="#maxclockerror-directive">4.2.37 maxclockerror</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Set maximum frequency error of local clock
</td></tr>
<tr><td align="left" valign="top"><a href="#maxsamples-directive">4.2.38 maxsamples</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Set maximum number of samples per source
</td></tr>
<tr><td align="left" valign="top"><a href="#maxslewrate-directive">4.2.39 maxslewrate</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Set maximum slew rate
</td></tr>
<tr><td align="left" valign="top"><a href="#maxupdateskew-directive">4.2.40 maxupdateskew</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Stop bad estimates upsetting machine clock
</td></tr>
<tr><td align="left" valign="top"><a href="#minsamples-directive">4.2.41 minsamples</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Set minimum number of samples per source
</td></tr>
<tr><td align="left" valign="top"><a href="#minsources-directive">4.2.42 minsources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Set minimum number of selectable sources to update clock
</td></tr>
<tr><td align="left" valign="top"><a href="#noclientlog-directive">4.2.43 noclientlog</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Prevent chronyd from gathering data about clients
</td></tr>
<tr><td align="left" valign="top"><a href="#peer-directive">4.2.44 peer</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Specify an NTP peer
</td></tr>
<tr><td align="left" valign="top"><a href="#pidfile-directive">4.2.45 pidfile</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Specify the file where chronyd&rsquo;s pid is written
</td></tr>
<tr><td align="left" valign="top"><a href="#pool-directive">4.2.46 pool</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Specify an NTP pool
</td></tr>
<tr><td align="left" valign="top"><a href="#port-directive">4.2.47 port</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Set NTP server port
</td></tr>
<tr><td align="left" valign="top"><a href="#refclock-directive">4.2.48 refclock</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Specify a reference clock
</td></tr>
<tr><td align="left" valign="top"><a href="#reselectdist-directive">4.2.49 reselectdist</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Set improvement in distance needed to reselect a source
</td></tr>
<tr><td align="left" valign="top"><a href="#rtcautotrim-directive">4.2.50 rtcautotrim</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Specify threshold at which RTC is trimmed automatically
</td></tr>
<tr><td align="left" valign="top"><a href="#rtcdevice-directive">4.2.51 rtcdevice</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Specify name of enhanced RTC device (if not /dev/rtc)
</td></tr>
<tr><td align="left" valign="top"><a href="#rtcfile-directive">4.2.52 rtcfile</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Specify the file where real-time clock data is stored
</td></tr>
<tr><td align="left" valign="top"><a href="#rtconutc-directive">4.2.53 rtconutc</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Specify that the real time clock keeps UTC not local time
</td></tr>
<tr><td align="left" valign="top"><a href="#rtcsync-directive">4.2.54 rtcsync</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Specify that RTC should be automatically synchronised by kernel
</td></tr>
<tr><td align="left" valign="top"><a href="#sched_005fpriority-directive">4.2.55 sched_priority</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    Require real-time scheduling and specify a priority for it
</td></tr>
<tr><td align="left" valign="top"><a href="#server-directive">4.2.56 server</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Specify an NTP server
</td></tr>
<tr><td align="left" valign="top"><a href="#smoothtime-directive">4.2.57 smoothtime</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Smooth served time to keep clients close together
</td></tr>
<tr><td align="left" valign="top"><a href="#stratumweight-directive">4.2.58 stratumweight</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Specify how important is stratum when selecting source
</td></tr>
<tr><td align="left" valign="top"><a href="#tempcomp-directive">4.2.59 tempcomp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Specify temperature sensor and compensation coefficients
</td></tr>
<tr><td align="left" valign="top"><a href="#user-directive">4.2.60 user</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Specify user for dropping root privileges
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr></table>
<hr>
<a name="comments-in-config-file"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#acquisitionport-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Comments-in-the-configuration-file"></a>
<h3 class="subsection">4.2.1 Comments in the configuration file</h3>
<p>The configuration file may contain comment lines.  A comment line is any line
that starts with zero or more spaces followed by any one of the following
characters:
</p><ul>
<li> !
</li><li> ;
</li><li> #
</li><li> %
</li></ul>
<p>Any line with this format will be ignored.
</p><hr>
<a name="acquisitionport-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#comments-in-config-file" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#allow-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="acquisitionport"></a>
<h3 class="subsection">4.2.2 acquisitionport</h3>
<p>By default, <code>chronyd</code> uses a separate client socket for each configured
server and their source port is chosen arbitrarily by the operating system.
However, you can use the <code>acquisitionport</code> directive to explicitly specify
a port and use only one socket (per IPv4/IPv6 address family) for all
configured servers.  This may be useful for getting through firewalls.  If set
to 0, the source port of the socket will be chosen arbitrarily.
</p>
<p>It may be set to the same port as used by the NTP server (see section <a href="#port-directive">port</a>) to use only one socket for all NTP packets.
</p>
<p>An example of the <code>acquisitionport</code> command is
</p>
<div class="example">
<pre class="example">acquisitionport 1123
</pre></div>

<p>This would change the source port used for client requests to udp/1123.  You
could then persuade the firewall administrator to let that port through.
</p><hr>
<a name="allow-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#acquisitionport-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#bindacqaddress-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="allow-1"></a>
<h3 class="subsection">4.2.3 allow</h3>
<p>The <code>allow</code> command is used to designate a particular subnet from
which NTP clients are allowed to access the computer as an NTP server.
</p>
<p>The default is that no clients are allowed access, i.e. <code>chronyd</code>
operates purely as an NTP client.  If the <code>allow</code> directive is
used, <code>chronyd</code> will be both a client of its servers, and a server
to other clients.
</p>
<p>Examples of use of the command are as follows:
</p>
<div class="example">
<pre class="example">allow foo.example.net
allow 1.2
allow 3.4.5
allow 6.7.8/22
allow 6.7.8.9/22
allow 2001:db8::/32
allow 0/0
allow ::/0
allow
</pre></div>

<p>The first command allows the named node to be an NTP client of this computer.
The second command allows any node with an IPv4 address of the form 1.2.x.y (with
x and y arbitrary) to be an NTP client of this computer.  Likewise, the third
command allows any node with an IPv4 address of the form 3.4.5.x to have client
NTP access.  The fourth and fifth forms allow access from any node with an IPv4
address of the form 6.7.8.x, 6.7.9.x, 6.7.10.x or 6.7.11.x (with x arbitrary),
i.e. the value 22 is the number of bits defining the specified subnet.  (In the
fifth form, the final byte is ignored).  The sixth form is used for IPv6
addresses.  The seventh and eighth forms allow access by any IPv4 and IPv6 node
respectively.  The ninth forms allows access by any node (IPv4 or IPv6).  
</p>
<p>A second form of the directive, <code>allow all</code>, has a greater effect,
depending on the ordering of directives in the configuration file.  To
illustrate the effect, consider the two examples
</p>
<div class="example">
<pre class="example">allow 1.2.3.4
deny 1.2.3
allow 1.2
</pre></div>

<p>and 
</p>
<div class="example">
<pre class="example">allow 1.2.3.4
deny 1.2.3
allow all 1.2
</pre></div>

<p>In the first example, the effect is the same regardles of what order the
three directives are given in.  So the 1.2.x.y subnet is allowed access,
except for the 1.2.3.x subnet, which is denied access, however the host
1.2.3.4 is allowed access.
</p>
<p>In the second example, the <code>allow all 1.2</code> directives overrides the
effect of <em>any</em> previous directive relating to a subnet within the
specified subnet.  Within a configuration file this capability is
probably rather moot; however, it is of greater use for reconfiguration
at run-time via <code>chronyc</code> (see section <a href="#allow-all-command">allow all</a>).
</p>
<p>Note, if the <code>initstepslew</code> directive (see section <a href="#initstepslew-directive">initstepslew</a>) is used in the configuration file, each of the computers
listed in that directive must allow client access by this computer for
it to work.
</p><hr>
<a name="bindacqaddress-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#allow-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#bindaddress-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="bindacqaddress"></a>
<h3 class="subsection">4.2.4 bindacqaddress</h3>
<p>The <code>bindacqaddress</code> directive sets the network interface to which will
<code>chronyd</code> bind its NTP client sockets. The syntax is similar to the
<code>bindaddress</code> and <code>bindcmdaddress</code> directives.
</p>
<p>For each of IPv4 and IPv6 protocols, only one <code>bindacqaddress</code>
directive can be specified.
</p><hr>
<a name="bindaddress-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#bindacqaddress-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#bindcmdaddress-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="bindaddress"></a>
<h3 class="subsection">4.2.5 bindaddress</h3>
<p>The <code>bindaddress</code> directive allows you to restrict the network interface
to which <code>chronyd</code> will listen for NTP requests.  This provides an
additional level of access restriction above that available through the
<code>deny</code> mechanism.
</p>
<p>Suppose you have a local ethernet with addresses in the 192.168.1.0
subnet together with an internet connection.  The ethernet interface&rsquo;s IP
address is 192.168.1.1.  Suppose you want to block all access through the
internet connection.  You could add the line
</p>
<div class="example">
<pre class="example">bindaddress 192.168.1.1
</pre></div>

<p>to the configuration file.
</p>
<p>For each of IPv4 and IPv6 protocols, only one <code>bindaddress</code> directive can
be specified.  Therefore, it&rsquo;s not useful on computers which should serve NTP
on multiple network interfaces.
</p><hr>
<a name="bindcmdaddress-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#bindaddress-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#broadcast-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="bindcmdaddress"></a>
<h3 class="subsection">4.2.6 bindcmdaddress</h3>
<p>The <code>bindcmdaddress</code> directive allows you to specify the network
interface to which <code>chronyd</code> will listen for command packets (issued by
<code>chronyc</code>).  This provides an additional level of access restriction above
that available through <code>cmddeny</code> mechanism.
</p>
<p>By default, <code>chronyd</code> binds to the loopback interface (with addresses
<code>127.0.0.1</code> and <code>::1</code>).  This blocks all access except from
localhost.  To listen for command packets on all interfaces, you can add the
lines
</p>
<div class="example">
<pre class="example">bindcmdaddress 0.0.0.0
bindcmdaddress ::
</pre></div>

<p>to the configuration file.
</p>
<p>For each of IPv4 and IPv6 protocols, only one <code>bindcmdaddress</code>
directive can be specified.
</p><hr>
<a name="broadcast-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#bindcmdaddress-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#clientloglimit-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="broadcast"></a>
<h3 class="subsection">4.2.7 broadcast</h3>
<p>The <code>broadcast</code> directive is used to declare a broadcast address to which
chronyd should send packets in NTP broadcast mode (i.e. make chronyd act as a
broadcast server).  Broadcast clients on that subnet will be able to
synchronise.
</p>
<p>The syntax is as follows
</p>
<div class="example">
<pre class="example">broadcast 30 192.168.1.255
broadcast 60 192.168.2.255 12123
broadcast 60 ff02::101
</pre></div>

<p>In the first example, the destination port defaults to 123/udp (the normal NTP
port).  In the second example, the destionation port is specified as 12123.
The first parameter in each case (30 or 60 respectively) is the interval in
seconds between broadcast packets being sent.  The second parameter in each
case is the broadcast address to send the packet to.  This should correspond to
the broadcast address of one of the network interfaces on the computer where
chronyd is running.
</p>
<p>You can have more than 1 <code>broadcast</code> directive if you have more than 1
network interface onto which you wish to send NTP broadcast packets.
</p>
<p><code>chronyd</code> itself cannot currently act as a broadcast client; it must always be
configured as a point-to-point client by defining specific NTP servers and
peers.  This broadcast server feature is intended for providing a time source
to other NTP software (e.g. various MS Windows clients).
</p>
<p>If ntpd is used as the broadcast client, it will try to use a point-to-point
client/server NTP access to measure the round-trip delay.  Thus, the broadcast
subnet should also be the subject of an <code>allow</code> directive (see section <a href="#allow-directive">allow</a>).
</p><hr>
<a name="clientloglimit-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#broadcast-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmdallow-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="clientloglimit"></a>
<h3 class="subsection">4.2.8 clientloglimit</h3>
<p>This directive specifies the maximum size of the memory allocated to
log client accesses.  When the limit is reached, only information for
clients that have already been logged will be updated.  If 0 is
specified, the memory size will be unlimited.  The default is 524288
bytes.
</p>
<p>An example of the use of this directive is
</p>
<div class="example">
<pre class="example">clientloglimit 1048576
</pre></div>
<hr>
<a name="cmdallow-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clientloglimit-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmddeny-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmdallow-1"></a>
<h3 class="subsection">4.2.9 cmdallow</h3>

<p>This is similar to the <code>allow</code> directive (see section <a href="#allow-directive">allow</a>), except
that it allows control access (rather than NTP client access) to a particular
subnet or host.  (By &rsquo;control access&rsquo; is meant that chronyc can be run on those
hosts and successfully connect to chronyd on this computer.)
</p>
<p>The syntax is identical to the <code>allow</code> directive.
</p>
<p>There is also a <code>cmdallow all</code> directive with similar behaviour to the
<code>allow all</code> directive (but applying to control access in this case, of
course).
</p>
<p>Note that <code>chronyd</code> has to be configured with the <code>bindcmdaddress</code>
directive to not listen only on the loopback interface to actually allow remote
access.
</p><hr>
<a name="cmddeny-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmdallow-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmdport-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmddeny-1"></a>
<h3 class="subsection">4.2.10 cmddeny</h3>

<p>This is similar to the <code>cmdallow</code> directive (see section <a href="#cmdallow-directive">cmdallow</a>),
except that it denies control access to a particular subnet or host,
rather than allowing it.
</p>
<p>The syntax is identical.
</p>
<p>There is also a <code>cmddeny all</code> directive with similar behaviour to the
<code>cmdallow all</code> directive.
</p><hr>
<a name="cmdport-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmddeny-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#combinelimit-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmdport"></a>
<h3 class="subsection">4.2.11 cmdport</h3>

<p>The <code>cmdport</code> directive allows the port that is used for run-time
command and monitoring (via the program <code>chronyc</code>) to be altered
from its default (323/udp).  If set to 0, <code>chronyd</code> will not open the
port, this is useful to disable the <code>chronyc</code> access completely.
</p>
<p>An example shows the syntax
</p>
<div class="example">
<pre class="example">cmdport 257
</pre></div>

<p>This would make <code>chronyd</code> use 257/udp as its command port.
(<code>chronyc</code> would need to be run with the <code>-p 257</code> switch to
inter-operate correctly).
</p><hr>
<a name="combinelimit-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmdport-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#commandkey-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="combinelimit"></a>
<h3 class="subsection">4.2.12 combinelimit</h3>
<p>When <code>chronyd</code> has multiple sources available for synchronization, it has
to select one source as the synchronization source. The measured offsets and
frequencies of the system clock relative to the other sources, however, can be
combined with the selected source to improve the accuracy of the system clock.
</p>
<p>The <code>combinelimit</code> directive limits which sources are included in the
combining algorithm. Their synchronization distance has to be shorter than the
distance of the selected source multiplied by the value of the limit. Also,
their measured frequencies have to be close to the frequency of the selected
source.
</p>
<p>By default, the limit is 3. Setting the limit to 0 effectively disables the
source combining algorithm and only the selected source will be used to
control the system clock.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">combinelimit &lt;limit&gt;
</pre></div>
<hr>
<a name="commandkey-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#combinelimit-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#corrtimeratio-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="commandkey"></a>
<h3 class="subsection">4.2.13 commandkey</h3>
<p>The commandkey command is used to set the key number used for
authenticating user commands via the chronyc program at run time.
This allows certain actions of the chronyc program to be restricted to
administrators.
</p>
<p>An example of the commandkey command is
</p>
<div class="example">
<pre class="example">commandkey 20
</pre></div>

<p>By default, the key number is 0.
</p>
<p>In the key file (see the keyfile command) there should be a line of
the form
</p>
<div class="example">
<pre class="example">20 MD5 HEX:B028F91EA5C38D06C2E140B26C7F41EC
</pre></div>

<p>When running the chronyc program to perform run-time configuration,
the command
</p>
<div class="example">
<pre class="example">password HEX:B028F91EA5C38D06C2E140B26C7F41EC
</pre></div>

<p>must be entered before any commands affecting the operation of the
daemon can be entered, or chronyc must be started with the &lsquo;-a&rsquo; option to run
the password command automatically.
</p><hr>
<a name="corrtimeratio-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#commandkey-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#deny-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="corrtimeratio"></a>
<h3 class="subsection">4.2.14 corrtimeratio</h3>
<p>When <code>chronyd</code> makes a time correction, it controls how quickly
the system clock is slewed (so far only on Linux).  This rate
affects the frequency error of the system clock.
</p>
<p>The <code>corrtimeratio</code> directive sets the ratio between the
duration in which the clock is slewed for an average correction
according to the source history and the interval in which the
corrections are done (usually the NTP polling interval).  Corrections
larger than the average take less time and smaller corrections take
more time, the amount of the correction and the correction time are
inversely proportional.
</p>
<p>Increasing <code>corrtimeratio</code> improves the overall frequency error
of the system clock, but increases the overall time error as the
corrections take longer.
</p>
<p>By default, the ratio is set to 3, the time accuracy of the clock is
preferred over its frequency accuracy.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">corrtimeratio 100
</pre></div>

<p>The maximum allowed slew rate can be set by the <code>maxslewrate</code>
directive (see section <a href="#maxslewrate-directive">maxslewrate</a>.  The current remaining
correction is shown in the <code>tracking</code> report (see section <a href="#tracking-command">tracking</a>) as the <code>System time</code> value.
</p><hr>
<a name="deny-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#corrtimeratio-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#driftfile-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deny"></a>
<h3 class="subsection">4.2.15 deny</h3>

<p>This is similar to the <code>allow</code> directive (see section <a href="#allow-directive">allow</a>),
except that it denies NTP client access to a particular subnet or host,
rather than allowing it.
</p>
<p>The syntax is identical.
</p>
<p>There is also a <code>deny all</code> directive with similar behaviour to the
<code>allow all</code> directive.
</p><hr>
<a name="driftfile-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deny-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#dumpdir-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="driftfile"></a>
<h3 class="subsection">4.2.16 driftfile</h3>
<p>One of the main activities of the <code>chronyd</code> program is to work out
the rate at which the system clock gains or loses time relative to real
time.
</p>
<p>Whenever <code>chronyd</code> computes a new value of the gain/loss rate, it
is desirable to record it somewhere.  This allows <code>chronyd</code> to
begin compensating the system clock at that rate whenever it is
restarted, even before it has had a chance to obtain an equally good
estimate of the rate during the new run.  (This process may take many
minutes, at least).
</p>
<p>The driftfile command allows a file to be specified into which
<code>chronyd</code> can store the rate information.  Two parameters are
recorded in the file.  The first is the rate at which the system clock
gains or loses time, expressed in parts per million, with gains
positive.  Therefore, a value of 100.0 indicates that when the system
clock has advanced by a second, it has gained 100 microseconds on
reality (so the true time has only advanced by 999900 microseconds).
The second is an estimate of the error bound around the first value in
which the true rate actually lies.
</p>
<p>An example of the driftfile command is
</p>
<div class="example">
<pre class="example">driftfile /var/lib/chrony/drift
</pre></div>
<hr>
<a name="dumpdir-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#driftfile-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#dumponexit-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dumpdir"></a>
<h3 class="subsection">4.2.17 dumpdir</h3>
<p>To compute the rate of gain or loss of time, <code>chronyd</code> has to store
a measurement history for each of the time sources it uses.
</p>
<p>Certain systems (so far only Linux) have operating system support for
setting the rate of gain or loss to compensate for known errors.  (On
other systems, <code>chronyd</code> must simulate such a capability by
periodically slewing the system clock forwards or backwards by a
suitable amount to compensate for the error built up since the previous
slew).
</p>
<p>For such systems, it is possible to save the measurement history across
restarts of <code>chronyd</code> (assuming no changes are made to the system
clock behaviour whilst it is not running).  If this capability is to be
used (via the dumponexit command in the configuration file, or the dump
command in chronyc), the dumpdir command should be used to define the
directory where the measurement histories are saved.
</p>
<p>An example of the command is
</p>
<div class="example">
<pre class="example">dumpdir /var/lib/chrony
</pre></div>

<p>A source whose reference id (the IP address for IPv4 sources) is
1.2.3.4 would have its measurement history saved in the file
&lsquo;<tt>/var/lib/chrony/1.2.3.4.dat</tt>&rsquo;.
</p><hr>
<a name="dumponexit-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dumpdir-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#fallbackdrift-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dumponexit"></a>
<h3 class="subsection">4.2.18 dumponexit</h3>
<p>If this command is present, it indicates that <code>chronyd</code> should save
the measurement history for each of its time sources recorded whenever
the program exits.  (See the dumpdir command above).
</p><hr>
<a name="fallbackdrift-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dumponexit-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#generatecommandkey-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="fallbackdrift"></a>
<h3 class="subsection">4.2.19 fallbackdrift</h3>
<p>Fallback drifts are long-term averages of the system clock drift
calculated over exponentially increasing intervals.  They are used
when the clock is no longer synchronised to avoid quickly drifting
away from true time if there was a short-term deviation in the drift
before the synchronisation was lost.
</p>
<p>The directive specifies the minimum and maximum interval since last
clock update to switch between fallback drifts.  They are defined as a
power of 2 (in seconds).  The syntax is as follows
</p>
<div class="example">
<pre class="example">fallbackdrift 16 19
</pre></div>

<p>In this example, the minimum interval is 16 (18 hours) and maximum
interval is 19 (6 days).  The system clock frequency will be set to
the first fallback 18 hours after last clock update, to the
second after 36 hours, etc.  This might be a good setting to cover
daily and weekly temperature fluctuations.
</p>
<p>By default (or if the specified maximum or minimum is 0), no fallbacks
are used and the clock frequency changes only with new measurements from
NTP, reference clocks or manual input.
</p><hr>
<a name="generatecommandkey-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#fallbackdrift-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#hwclockfile-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="generatecommandkey"></a>
<h3 class="subsection">4.2.20 generatecommandkey</h3>
<p>With this directive, if the command key is not found on start in the file
specified by the <code>keyfile</code> directive, <code>chronyd</code> will generate a new
command key from the /dev/urandom file and write it to the key file.
</p>
<p>The generated key will use SHA1 if <code>chronyd</code> is compiled with the support,
otherwise MD5 will be used.
</p><hr>
<a name="hwclockfile-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#generatecommandkey-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#include-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="hwclockfile"></a>
<h3 class="subsection">4.2.21 hwclockfile</h3>
<p>The <code>hwclockfile</code> directive sets the location of the adjtime file which is
used by the &lsquo;<tt>/sbin/hwclock</tt>&rsquo; program.  With this directive, <code>chronyd</code>
will parse the file to find out if the RTC keeps local time or UTC.  It
overrides the <code>rtconutc</code> directive (see section <a href="#rtconutc-directive">rtconutc</a>).
</p>
<p>An example of the command is
</p>
<div class="example">
<pre class="example">hwclockfile /etc/adjtime
</pre></div>
<hr>
<a name="include-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#hwclockfile-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#initstepslew-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="include"></a>
<h3 class="subsection">4.2.22 include</h3>
<p>The <code>include</code> directive includes a specified configuration file.
This is useful when maintaining configuration on multiple hosts to
keep the differences in a separate file.
</p>
<div class="example">
<pre class="example">include /etc/chrony/local.conf
</pre></div>
<hr>
<a name="initstepslew-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#include-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#keyfile-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="initstepslew"></a>
<h3 class="subsection">4.2.23 initstepslew</h3>
<p>In normal operation, <code>chronyd</code> slews the time when it needs to
adjust the system clock.  For example, to correct a system clock which
is 1 second slow, <code>chronyd</code> slightly increases the amount by which the
system clock is advanced on each clock interrupt, until the error is
removed.  (Actually, this is done by calling the <code>adjtime()</code> or
similar system function which does it for us.)  Note that at no time
does time run backwards with this method.
</p>
<p>On most Unix systems it is not desirable to step the system clock,
because many programs rely on time advancing monotonically forwards.
</p>
<p>When the <code>chronyd</code> daemon is initially started, it is possible that the
system clock is considerably in error.  Attempting to correct such an
error by slewing may not be sensible, since it may take several hours
to correct the error by this means.
</p>
<p>The purpose of the <code>initstepslew</code> directive is to allow <code>chronyd</code> to
make a rapid measurement of the system clock error at boot time, and to
correct the system clock by stepping before normal operation begins.
Since this would normally be performed only at an appropriate point in
the system boot sequence, no other software should be adversely affected
by the step.
</p>
<p>If the correction required is less than a specified threshold, a slew is
used instead.  This makes it easier to restart <code>chronyd</code> whilst the
system is in normal operation.
</p>
<p>The <code>initstepslew</code> directive takes a threshold and a list of NTP
servers as arguments.  Each of the servers
is rapidly polled several times, and a majority voting mechanism used to
find the most likely range of system clock error that is present.  A
step (or slew) is applied to the system clock to correct this error.
<code>chronyd</code> then enters its normal operating mode.
</p>
<p>An example of use of the command is
</p>
<div class="example">
<pre class="example">initstepslew 30 foo.example.net bar.example.net
</pre></div>

<p>where 2 NTP servers are used to make the measurement.  The <code>30</code>
indicates that if the system&rsquo;s error is found to be 30 seconds or less,
a slew will be used to correct it; if the error is above 30 seconds, a
step will be used.
</p>
<p>The <code>initstepslew</code> directive can also be used in an isolated LAN
environment, where the clocks are set manually.  The most stable
computer is chosen as the master, and the other computers are slaved to
it.  If each of the slaves is configured with the local option (see
below), the master can be set up with an <code>initstepslew</code> directive
which references some or all of the slaves.  Then, if the master machine
has to be rebooted, the slaves can be relied on to &rsquo;flywheel&rsquo; the time
for the master.
</p>
<p>The <code>initstepslew</code> directive is functionally similar to a
combination of the <code>makestep</code> and <code>server</code> directives with
the <code>iburst</code> option. The main difference is that the
<code>initstepslew</code> servers are used only before normal operation
begins and that the foreground <code>chronyd</code> process waits for
<code>initstepslew</code> to finish before exiting.  This is useful to
prevent programs started in the boot sequence after <code>chronyd</code>
from reading the clock before it&rsquo;s stepped.
</p><hr>
<a name="keyfile-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#initstepslew-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#leapsecmode-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="keyfile"></a>
<h3 class="subsection">4.2.24 keyfile</h3>
<p>This command is used to specify the location of the file containing
ID/key pairs for the following 2 uses:
</p>
<ul>
<li> Authentication of NTP packets.
</li><li> Authentication of administrator commands entered via chronyc.
</li></ul>

<p>The format of the command is shown in the example below
</p>
<div class="example">
<pre class="example">keyfile /etc/chrony.keys
</pre></div>

<p>The argument is simply the name of the file containing the ID/key
pairs.  The format of the file is shown below
</p>
<div class="example">
<pre class="example">10 tulip
11 hyacinth
20 MD5 ASCII:crocus
25 SHA1 HEX:1dc764e0791b11fa67efc7ecbc4b0d73f68a070c 
 ...
</pre></div>

<p>Each line consists of an ID, a name of authentication hash function (optional)
and a password. The ID can be any unsigned integer in the range 0 through
2**32-1, but ID of 0 can be used only for the command key and not for the NTP
authentication. The hash function is MD5 by default, depending on how was
<code>chronyd</code> compiled other allowed hash functions may be SHA1, SHA256,
SHA384, SHA512, RMD128, RMD160, RMD256, RMD320, TIGER and WHIRLPOOL.  The
password can be encoded as a string of characters not containing a space with
optional <code>ASCII:</code> prefix or as a hexadecimal number with <code>HEX:</code>
prefix.
</p>
<p>The password is used with the hash function to generate and verify a message
authentication code (MAC) in NTP and command packets.
For maximum security, it&rsquo;s recommended to use SHA1 or stronger hash function.
The passwords should be random and they should be as long as the output size of
the configured hash function, e.g. 160 bits with SHA1.
</p>
<p>The ID for the chronyc authentication key is specified with the commandkey
command (see earlier). The command key can be generated automatically on
start with the <code>generatecommandkey</code> directive.
</p><hr>
<a name="leapsecmode-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#keyfile-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#leapsectz-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="leapsecmode"></a>
<h3 class="subsection">4.2.25 leapsecmode</h3>
<p>A leap second is an adjustment that is occasionally applied to UTC to keep it
close to the mean solar time.  When a leap second is inserted, the last day of
June or December has an extra second 23:59:60.
</p>
<p>For computer clocks that is a problem.  The Unix time is defined as number of
seconds since 00:00:00 UTC on 1 January 1970 without leap seconds.  The system
clock cannot have time 23:59:60, every minute has 60 seconds and every day has
86400 seconds by definition.  The inserted leap second is skipped and the clock
is suddenly ahead of UTC by one second.  The <code>leapsecmode</code> directive
selects how that error is corrected.  There are four options:
</p>
<dl compact="compact">
<dt><code>system</code></dt>
<dd><p>When inserting a leap second, the kernel steps the system clock backwards by
one second when the clock gets to 00:00:00 UTC.  When deleting a leap second,
it steps forward by one second when the clock gets to 23:59:59 UTC.  This is
the default mode when the system driver supports leap seconds (currently Linux
only).
</p></dd>
<dt><code>step</code></dt>
<dd><p>This is similar to the <code>system</code> mode, except the clock is stepped by
<code>chronyd</code> instead of the kernel.  It can be useful to avoid bugs in the
kernel code that would be executed in the <code>system</code> mode.  This is the
default mode when the system driver doesn&rsquo;t support leap seconds.
</p></dd>
<dt><code>slew</code></dt>
<dd><p>The clock is corrected by slewing started at 00:00:00 UTC when a leap second is
inserted or 23:59:59 UTC when a leap second is deleted.  This may be preferred
over the <code>system</code> and <code>step</code> modes when applications running on the
system are sensitive to jumps in the system time and it&rsquo;s acceptable that the
clock will be off for a longer time.  On Linux with the default
<code>maxslewrate</code> value (see section <a href="#maxslewrate-directive">maxslewrate</a>) the correction takes
12 seconds.
</p></dd>
<dt><code>ignore</code></dt>
<dd><p>No correction is applied to the clock for the leap second.  The clock will be
corrected later in normal operation when new measurements are made and the
estimated offset includes the one second error.
</p></dd>
</dl>

<p>An example of the command is
</p>
<div class="example">
<pre class="example">leapsecmode slew
</pre></div>

<p>When serving time to NTP clients that can&rsquo;t be configured to correct their
clocks for a leap second by slewing or they would correct them at slightly
different rates when it&rsquo;s necessary to keep them close together, the
<code>slew</code> mode can be combined with the <code>smoothtime</code> directive
(see section <a href="#smoothtime-directive">smoothtime</a>) to enable a server leap smear.
</p>
<p>When smearing a leap second, the leap status is suppressed on the server and
the served time is corrected slowly be slewing instead of stepping. The clients
don&rsquo;t need any special configuration as they don&rsquo;t know there is any leap
second and they follow the server time which eventually brings them back to
UTC.  Care must be taken to ensure they use for synchronization only NTP
servers which smear the leap second in exactly the same way.
</p>
<p>This feature needs to be used carefully, because the server is intentionally
not serving its best estimate of the true time.
</p>
<p>A recommended configuration to enable a server leap smear is:
</p>
<div class="example">
<pre class="example">leapsecmode slew
maxslewrate 1000
smoothtime 400 0.001 leaponly
</pre></div>

<p>The first directive is necessary to disable the clock step which would reset
the smoothing process.  The second directive limits the slewing rate of the
local clock to 1000 ppm, which improves the stability of the smoothing process
when the local correction starts and ends.  The third directive enables the
server time smoothing process.  It will start when the clock gets to 00:00:00
UTC and it will take 17 hours 34 minutes to finish.  The frequency offset will
be changing by 0.001 ppm per second and will reach maximum of 31.623 ppm.  The
<code>leaponly</code> option makes the duration of the leap smear constant and allows
the clients to safely synchronise with multiple identically configured leap
smearing servers.
</p><hr>
<a name="leapsectz-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#leapsecmode-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#local-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="leapsectz"></a>
<h3 class="subsection">4.2.26 leapsectz</h3>
<p>This directive is used to set the name of the timezone in the system
tz database which <code>chronyd</code> can use to find out when will the
next leap second occur.  It will periodically check if the times
23:59:59 and 23:59:60 are valid on Jun 30 and Dec 31 in the timezone.
A useful timezone is <code>right/UTC</code>.
This is mainly useful with reference clocks which don&rsquo;t provide the
leap second information.  It is not necessary to restart
<code>chronyd</code> if the tz database is updated with a new leap second at
least 12 hours before the event.
</p>
<p>An example of the command is
</p>
<div class="example">
<pre class="example">leapsectz right/UTC
</pre></div>

<p>The following shell command verifies that the timezone contains leap
seconds and can be used with this directive
</p>
<div class="example">
<pre class="example">$ TZ=right/UTC date -d 'Dec 31 2008 23:59:60'
Wed Dec 31 23:59:60 UTC 2008
</pre></div>

<hr>
<a name="local-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#leapsectz-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#lock_005fall-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="local-1"></a>
<h3 class="subsection">4.2.27 local</h3>
<p>The local keyword is used to allow <code>chronyd</code> to appear synchronised
to real time (from the viewpoint of clients polling it), even if it has
no current synchronisation source.
</p>
<p>This option is normally used on computers in an isolated network,
where several computers are required to synchronise to one other, this
being the &quot;master&quot; which is kept vaguely in line with real time by
manual input.
</p>
<p>An example of the command is 
</p>
<div class="example">
<pre class="example">local stratum 10
</pre></div>

<p>The value 10 may be substituted with other values in the range 1
through 15.  Stratum 1 indicates a computer that has a true real-time
reference directly connected to it (e.g. GPS, atomic clock etc)
&amp;ndash; such computers are expected to be very close to real time.
Stratum 2 computers are those which have a stratum 1 server; stratum 3
computers have a stratum 2 server and so on.
</p>
<p>A large value of 10 indicates that the clock is so many hops away from
a reference clock that its time is fairly unreliable.  Put another
way, if the computer ever has access to another computer which is
ultimately synchronised to a reference clock, it will almost certainly
be at a stratum less than 10.  Therefore, the choice of a high value
like 10 for the local command prevents the machine&rsquo;s own time from
ever being confused with real time, were it ever to leak out to
clients that have visibility of real servers.
</p><hr>
<a name="lock_005fall-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#local-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="lock_005fall"></a>
<h3 class="subsection">4.2.28 lock_all</h3>

<p>The <code>lock_all</code> directive will lock chronyd into RAM so that it
will never be paged out.  This mode is only supported on Linux.  This
directive uses the Linux mlockall() system call to prevent <code>chronyd</code>
from ever being swapped out.  This should result in lower and more
consistent latency.  It should not have significant impact on
performance as <code>chronyd's</code> memory usage is modest.  The mlockall man
page has more details.
</p><hr>
<a name="log-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#lock_005fall-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#measurements-log" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="log"></a>
<h3 class="subsection">4.2.29 log</h3>
<p>The log command indicates that certain information is to be logged.
</p>
<dl compact="compact">
<dt><code>measurements</code></dt>
<dd><p>This option logs the raw NTP measurements and related information to a
file called measurements.log.
</p>
</dd>
<dt><code>statistics</code></dt>
<dd><p>This option logs information about the regression processing to a file
called statistics.log.
</p>
</dd>
<dt><code>tracking</code></dt>
<dd><p>This option logs changes to the estimate of the system&rsquo;s gain or loss
rate, and any slews made, to a file called tracking.log.
</p>
</dd>
<dt><code>rtc</code></dt>
<dd><p>This option logs information about the system&rsquo;s real-time clock.
</p>
</dd>
<dt><code>refclocks</code></dt>
<dd><p>This option logs the raw and filtered reference clock measurements to
a file called refclocks.log.
</p></dd>
<dt><code>tempcomp</code></dt>
<dd><p>This option logs the temperature measurements and system rate
compensations to a file called tempcomp.log.
</p></dd>
</dl>

<p>The files are written to the directory specified by the logdir
command.
</p>
<p>An example of the command is
</p>
<div class="example">
<pre class="example">log measurements statistics tracking
</pre></div>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#measurements-log">4.2.29.1 Measurements log file format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            The format of the measurements log
</td></tr>
<tr><td align="left" valign="top"><a href="#statistics-log">4.2.29.2 Statistics log file format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              The format of the statistics log
</td></tr>
<tr><td align="left" valign="top"><a href="#tracking-log">4.2.29.3 Tracking log file format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                The format of the tracking log
</td></tr>
<tr><td align="left" valign="top"><a href="#RTC-log">4.2.29.4 Real-time clock log file format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     The format of the RTC log
</td></tr>
<tr><td align="left" valign="top"><a href="#refclocks-log">4.2.29.5 Refclocks log file format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               The format of the refclocks log
</td></tr>
<tr><td align="left" valign="top"><a href="#tempcomp-log">4.2.29.6 Tempcomp log file format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                The format of the tempcomp log
</td></tr>
</table>
<hr>
<a name="measurements-log"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#statistics-log" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Measurements-log-file-format"></a>
<h4 class="subsubsection">4.2.29.1 Measurements log file format</h4>

<p>An example line (which actually appears as a single line in the file)
from the measurements log file is shown below.
</p>
<div class="example">
<pre class="example">2014-10-13 05:40:50 158.152.1.76    N  2 111 111 1111  10 10 1.0 \
   -4.966e-03  2.296e-01  1.577e-05  1.615e-01  7.446e-03
</pre></div>

<p>The columns are as follows (the quantities in square brackets are the
values from the example line above) :
</p>
<ol>
<li>
Date [2014-10-13]
</li><li>
Hour:Minute:Second [05:40:50].  Note that the date/time pair is
expressed in UTC, not the local time zone.
</li><li>
IP address of server/peer from which measurement comes [158.152.1.76]
</li><li>
Leap status (<code>N</code> means normal, <code>+</code> means that the last minute
of the current month has 61 seconds, <code>-</code> means that the last minute
of the month has 59 seconds, <code>?</code> means the remote computer is not
currently synchronised.) [N]
</li><li>
Stratum of remote computer. [2]
</li><li>
RFC 5905 tests 1 through 3 (1=pass, 0=fail) [111]
</li><li>
RFC 5905 tests 5 through 7 (1=pass, 0=fail) [111]
</li><li>
Tests for maximum delay, maximum delay ratio and maximum delay dev ratio,
against defined parameters, and a test for synchronisation loop
(1=pass, 0=fail) [1111]
</li><li>
Local poll [10]
</li><li>
Remote poll [10]
</li><li>
&lsquo;Score&rsquo; (an internal score within each polling level used to decide when
to increase or decrease the polling level.  This is adjusted based on number
of measurements currently being used for the regression algorithm). [1.0]
</li><li>
The estimated local clock error (&lsquo;theta&rsquo; in RFC 5905).  Positive
indicates that the local clock is slow of the remote source. [-4.966e-03].
</li><li>
The peer delay (&lsquo;delta&rsquo; in RFC 5905). [2.296e-01]
</li><li>
The peer dispersion (&lsquo;epsilon&rsquo; in RFC 5905). [1.577e-05]
</li><li>
The root delay (&lsquo;DELTA&rsquo; in RFC 5905). [1.615e-01]
</li><li>
The root dispersion (&lsquo;EPSILON&rsquo; in RFC 5905). [7.446e-03]
</li></ol>

<p>A banner is periodically written to the log file to indicate the
meanings of the columns.
</p><hr>
<a name="statistics-log"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#measurements-log" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#tracking-log" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Statistics-log-file-format"></a>
<h4 class="subsubsection">4.2.29.2 Statistics log file format</h4>

<p>An example line (which actually appears as a single line in the file)
from the statistics log file is shown below.
</p>
<div class="example">
<pre class="example">1998-07-22 05:40:50 158.152.1.76     6.261e-03 -3.247e-03 \
     2.220e-03  1.874e-06  1.080e-06 7.8e-02  16   0   8
</pre></div>

<p>The columns are as follows (the quantities in square brackets are the
values from the example line above) :
</p>
<ol>
<li>
Date [1998-07-22]
</li><li>
Hour:Minute:Second [05:40:50].  Note that the date/time pair is
expressed in UTC, not the local time zone.
</li><li>
IP address of server/peer from which measurement comes [158.152.1.76]
</li><li>
The estimated standard deviation of the measurements from the source (in
seconds). [6.261e-03]
</li><li>
The estimated offset of the source (in seconds, positive means the local
clock is estimated to be fast, in this case). [-3.247e-03]
</li><li>
The estimated standard deviation of the offset estimate (in
seconds). [2.220e-03]
</li><li>
The estimated rate at which the local clock is gaining or losing time
relative to the source (in seconds per second, positive means the local
clock is gaining).  This is relative to the compensation currently being
applied to the local clock, <em>not</em> to the local clock without any
compensation. [1.874e-06]
</li><li>
The estimated error in the rate value (in seconds per
second). [1.080e-06].
</li><li>
The ration of |old_rate - new_rate| / old_rate_error.  Large values
indicate the statistics are not modelling the source very well. [7.8e-02]
</li><li>
The number of measurements currently being used for the regression
algorithm. [16]
</li><li>
The new starting index (the oldest sample has index 0; this is the
method used to prune old samples when it no longer looks like the
measurements fit a linear model). [0, i.e. no samples discarded this
time]
</li><li>
The number of runs.  The number of runs of regression residuals with the
same sign is computed.  If this is too small it indicates that the
measurements are no longer represented well by a linear model and that
some older samples need to be discarded.  The number of runs for the
data that is being retained is tabulated.  Values of approximately half
the number of samples are expected. [8]
</li></ol>

<p>A banner is periodically written to the log file to indicate the
meanings of the columns.
</p><hr>
<a name="tracking-log"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#statistics-log" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#RTC-log" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Tracking-log-file-format"></a>
<h4 class="subsubsection">4.2.29.3 Tracking log file format</h4>

<p>An example line (which actually appears as a single line in the file)
from the tracking log file is shown below.
</p>
<div class="example">
<pre class="example">2012-02-23 05:40:50 158.152.1.76     3    340.529      1.606  1.046e-03 N \
            4  6.849e-03 -4.670e-04
</pre></div>

<p>The columns are as follows (the quantities in square brackets are the
values from the example line above) :
</p>
<ol>
<li>
Date [2012-02-03]
</li><li>
Hour:Minute:Second [05:40:50].  Note that the date/time pair is
expressed in UTC, not the local time zone.
</li><li>
The IP address of the server/peer to which the local system is
synchronised. [158.152.1.76]
</li><li>
The stratum of the local system. [3]
</li><li>
The local system frequency (in ppm, positive means the local system runs
fast of UTC). [340.529]
</li><li>
The error bounds on the frequency (in ppm) [1.606]
</li><li>
The estimated local offset at the epoch (which is rapidly corrected by
slewing the local clock.  (In seconds, positive indicates the local
system is fast of UTC). [1.046e-3]
</li><li>
Leap status (<code>N</code> means normal, <code>+</code> means that the last minute
of this month has 61 seconds, <code>-</code> means that the last minute of the month
has 59 seconds, <code>?</code> means the clock is not currently synchronised.) [N]
</li><li>
The number of combined sources. [4]
</li><li>
The estimated standard deviation of the combined offset (in seconds).
[6.849e-03]
</li><li>
The remaining offset correction from the previous update (in seconds, positive
means the system clock is slow of UTC). [-4.670e-04]
</li></ol>

<p>A banner is periodically written to the log file to indicate the
meanings of the columns.
</p><hr>
<a name="RTC-log"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#tracking-log" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#refclocks-log" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Real_002dtime-clock-log-file-format"></a>
<h4 class="subsubsection">4.2.29.4 Real-time clock log file format</h4>

<p>An example line (which actually appears as a single line in the file)
from the measurements log file is shown below.
</p>
<div class="example">
<pre class="example">1998-07-22 05:40:50     -0.037360 1       -0.037434\
          -37.948  12   5  120
</pre></div>

<p>The columns are as follows (the quantities in square brackets are the
values from the example line above) :
</p>
<ol>
<li>
Date [1998-07-22]
</li><li>
Hour:Minute:Second [05:40:50].  Note that the date/time pair is
expressed in UTC, not the local time zone.
</li><li>
The measured offset between the system&rsquo;s real time clock and the system
(<code>gettimeofday()</code>) time.  In seconds, positive indicates that the
RTC is fast of the system time. [-0.037360].
</li><li>
Flag indicating whether the regression has produced valid
coefficients. (1 for yes, 0 for no). [1]
</li><li>
Offset at the current time predicted by the regression process.  A large
difference between this value and the measured offset tends to indicate
that the measurement is an outlier with a serious measurement
error. [-0.037434].
</li><li>
The rate at which the RTC is losing or gaining time relative to the
system clock.  In ppm, with positive indicating that the RTC is gaining
time. [-37.948]
</li><li>
The number of measurements used in the regression. [12]
</li><li>
The number of runs of regression residuals of the same sign.  Low values
indicate that a straight line is no longer a good model of the measured
data and that older measurements should be discarded. [5]
</li><li>
The measurement interval used prior to the measurement being made (in
seconds). [120]
</li></ol>

<p>A banner is periodically written to the log file to indicate the
meanings of the columns.
</p><hr>
<a name="refclocks-log"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#RTC-log" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#tempcomp-log" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Refclocks-log-file-format"></a>
<h4 class="subsubsection">4.2.29.5 Refclocks log file format</h4>

<p>An example line (which actually appears as a single line in the file)
from the refclocks log file is shown below.
</p>
<div class="example">
<pre class="example">2009-11-30 14:33:27.000000 PPS2    7 N 1  4.900000e-07 -6.741777e-07  1.000e-06
</pre></div>

<p>The columns are as follows (the quantities in square brackets are the
values from the example line above) :
</p>
<ol>
<li>
Date [2009-11-30]
</li><li>
Hour:Minute:Second.Microsecond [14:33:27.000000].  Note that the
date/time pair is expressed in UTC, not the local time zone.
</li><li>
Reference ID of refclock from which measurement comes. [PPS2]
</li><li>
Sequence number of driver poll within one polling interval for raw
samples, or <code>-</code> for filtered samples. [7]
</li><li>
Leap status (<code>N</code> means normal, <code>+</code> means that the last minute
of the current month has 61 seconds, <code>-</code> means that the last minute
of the month has 59 seconds). [N]
</li><li>
Flag indicating whether the sample comes from PPS source. (1 for yes,
0 for no, or <code>-</code> for filtered sample). [1]
</li><li>
Local clock error measured by refclock driver, or <code>-</code> for
filtered sample. [4.900000e-07]
</li><li>
Local clock error with applied corrections.  Positive indicates
that the local clock is slow. [-6.741777e-07]
</li><li>
Assumed dispersion of the sample. [1.000e-06]
</li></ol>

<p>A banner is periodically written to the log file to indicate the
meanings of the columns.
</p><hr>
<a name="tempcomp-log"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#refclocks-log" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#log-directive" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#logbanner-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Tempcomp-log-file-format"></a>
<h4 class="subsubsection">4.2.29.6 Tempcomp log file format</h4>

<p>An example line (which actually appears as a single line in the file)
from the tempcomp log file is shown below.
</p>
<div class="example">
<pre class="example">2010-04-19 10:39:48  2.8000e+04  3.6600e-01
</pre></div>

<p>The columns are as follows (the quantities in square brackets are the
values from the example line above) :
</p>
<ol>
<li>
Date [2010-04-19]
</li><li>
Hour:Minute:Second [10:39:48].  Note that the
date/time pair is expressed in UTC, not the local time zone.
</li><li>
Temperature read from tempcomp file. [2.8000e+04]
</li><li>
Applied compensation in ppm, positive means the system clock is
running faster than it would be without the compensation. [3.6600e-01]
</li></ol>

<p>A banner is periodically written to the log file to indicate the
meanings of the columns.
</p><hr>
<a name="logbanner-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#tempcomp-log" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#logchange-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="logbanner"></a>
<h3 class="subsection">4.2.30 logbanner</h3>
<p>A banner is periodically written to the log files enabled by the
<code>log</code> directive to indicate the meanings of the columns.
</p>
<p>The <code>logbanner</code> directive specifies after how many entries in the
log file should be the banner written. The default is 32, and 0 can be
used to disable it entirely.
</p><hr>
<a name="logchange-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#logbanner-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#logdir-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="logchange"></a>
<h3 class="subsection">4.2.31 logchange</h3>
<p>This directive forces <code>chronyd</code> to send a message to syslog if it
makes a system clock adjustment larger than a threshold value.  An
example of use is
</p>
<div class="example">
<pre class="example">logchange 0.5
</pre></div>

<p>which would cause a syslog message to be generated a system clock error
of over 0.5 seconds starts to be compensated.
</p>
<p>Clock errors detected either via NTP packets or via timestamps entered
via the <code>settime</code> command of <code>chronyc</code> are logged.
</p>
<p>This directive assumes that syslog messages are appearing where somebody
can see them.  This allows that person to see if a large error has
arisen, e.g. because of a fault, or because of faulty timezone handling,
for example when summer time (daylight saving) starts or ends.
</p><hr>
<a name="logdir-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#logchange-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#mailonchange-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="logdir"></a>
<h3 class="subsection">4.2.32 logdir</h3>
<p>This directive allows the directory where log files are written to be
specified.
</p>
<p>An example of the use of this directive is
</p>
<div class="example">
<pre class="example">logdir /var/log/chrony
</pre></div>
<hr>
<a name="mailonchange-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#logdir-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#makestep-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="mailonchange"></a>
<h3 class="subsection">4.2.33 mailonchange</h3>
<p>This directive defines an email address to which mail should be sent if
chronyd applies a correction exceeding a particular threshold to the
system clock.
</p>
<p>An example of use of this directive is
</p>
<div class="example">
<pre class="example">mailonchange root@localhost 0.5
</pre></div>

<p>This would send a mail message to root if a change of more than 0.5
seconds were applied to the system clock.
</p><hr>
<a name="makestep-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#mailonchange-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#manual-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="makestep-1"></a>
<h3 class="subsection">4.2.34 makestep</h3>
<p>Normally chronyd will cause the system to gradually correct any time
offset, by slowing down or speeding up the clock as required.  In
certain situations, the system clock may be so far adrift that this
slewing process would take a very long time to correct the system clock.
</p>
<p>This directive forces <code>chronyd</code> to step system clock if the
adjustment is larger than a threshold value, but only if there were no
more clock updates since <code>chronyd</code> was started than a specified
limit (a negative value can be used to disable the limit).
</p>
<p>This is particularly useful when using reference clocks, because the
<code>initstepslew</code> directive (see section <a href="#initstepslew-directive">initstepslew</a>) works
only with NTP sources.
</p>
<p>An example of the use of this directive is
</p>
<div class="example">
<pre class="example">makestep 1000 10
</pre></div>

<p>This would step system clock if the adjustment is larger than 1000
seconds, but only in the first ten clock updates.
</p><hr>
<a name="manual-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#makestep-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxchange-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="manual-1"></a>
<h3 class="subsection">4.2.35 manual</h3>
<p>The <code>manual</code> directive enables support at run-time for the
<code>settime</code> command in chronyc (see section <a href="#settime-command">settime</a>).  If no
<code>manual</code> directive is included, any attempt to use the
<code>settime</code> command in chronyc will be met with an error message.
</p>
<p>Note that the <code>settime</code> command can be enabled at run-time using
the <code>manual</code> command in chronyc (see section <a href="#manual-command">manual</a>).  (The
idea of the two commands is that the <code>manual</code> command controls the
manual clock driver&rsquo;s behaviour, whereas the <code>settime</code> command
allows samples of manually entered time to be provided).
</p><hr>
<a name="maxchange-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#manual-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxclockerror-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxchange"></a>
<h3 class="subsection">4.2.36 maxchange</h3>
<p>This directive sets the maximum allowed offset corrected on a clock
update.  The check is performed only after the specified number of
updates to allow a large initial adjustment of the system clock.  When
an offset larger than the specified maximum occurs, it will be ignored
for the specified number of times and then <code>chronyd</code> will give up
and exit (a negative value can be used to never exit).  In both cases
a message is sent to syslog.
</p>
<p>An example of the use of this directive is
</p>
<div class="example">
<pre class="example">maxchange 1000 1 2
</pre></div>

<p>After the first clock update, <code>chronyd</code> will check the offset on
every clock update, it will ignore two adjustments larger than 1000
seconds and exit on another one.
</p><hr>
<a name="maxclockerror-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxchange-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxsamples-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxclockerror"></a>
<h3 class="subsection">4.2.37 maxclockerror</h3>
<p>The <code>maxclockerror</code> directive sets the maximum assumed frequency
error of the local clock.  This is a frequency stability of the clock,
not an absolute frequency error.
</p>
<p>By default, the maximum assumed error is set to 1 ppm.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">maxclockerror &lt;error-in-ppm&gt;
</pre></div>

<p>Typical values for &lt;error-in-ppm&gt; might be 10 for a low quality clock
to 0.1 for a high quality clock using a temperature compensated
crystal oscillator.
</p><hr>
<a name="maxsamples-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxclockerror-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxslewrate-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxsamples"></a>
<h3 class="subsection">4.2.38 maxsamples</h3>
<p>The <code>maxsamples</code> directive sets the default maximum number of samples
<code>chronyd</code> should keep for each source.  This setting can be overriden for
individual sources in the <code>server</code> and <code>refclock</code> directives
(see section <a href="#server-directive">server</a>, see section <a href="#refclock-directive">refclock</a>).  The default value is
0, which disables the configurable limit.  The useful range is 4 to 64.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">maxsamples &lt;samples&gt;
</pre></div>
<hr>
<a name="maxslewrate-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxsamples-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxupdateskew-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxslewrate"></a>
<h3 class="subsection">4.2.39 maxslewrate</h3>
<p>The <code>maxslewrate</code> directive sets the maximum rate at which <code>chronyd</code>
is allowed to slew the time.  It limits the slew rate controlled by the
correction time ratio (see section <a href="#corrtimeratio-directive">corrtimeratio</a>) and is effective
only on systems where <code>chronyd</code> is able to control the rate (so
far only Linux).
</p>
<p>By default, the maximum slew rate is 83333.333 ppm (one twelfth).
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">maxslewrate &lt;rate-in-ppm&gt;
</pre></div>
<hr>
<a name="maxupdateskew-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxslewrate-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#minsamples-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxupdateskew-1"></a>
<h3 class="subsection">4.2.40 maxupdateskew</h3>
<p>One of <code>chronyd's</code> tasks is to work out how fast or slow the computer&rsquo;s
clock runs relative to its reference sources.  In addition, it computes
an estimate of the error bounds around the estimated value.
</p>
<p>If the range of error is too large, it probably indicates that the
measurements have not settled down yet, and that the estimated gain or
loss rate is not very reliable.
</p>
<p>The <code>maxupdateskew</code> parameter allows the threshold for determining
whether an estimate may be so unreliable that it should not be used.
By default, the threshold is 1000 ppm.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">maxupdateskew &lt;skew-in-ppm&gt;
</pre></div>

<p>Typical values for &lt;skew-in-ppm&gt; might be 100 for a dial-up connection
to servers over a phone line, and 5 or 10 for a computer on a LAN.
</p>
<p>It should be noted that this is not the only means of protection against
using unreliable estimates.  At all times, <code>chronyd</code> keeps track of
both the estimated gain or loss rate, and the error bound on the
estimate.  When a new estimate is generated following another
measurement from one of the sources, a weighted combination algorithm is
used to update the master estimate.  So if <code>chronyd</code> has an existing
highly-reliable master estimate and a new estimate is generated which
has large error bounds, the existing master estimate will dominate in
the new master estimate.
</p><hr>
<a name="minsamples-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxupdateskew-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#minsources-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="minsamples"></a>
<h3 class="subsection">4.2.41 minsamples</h3>
<p>The <code>minsamples</code> directive sets the default minimum number of samples
<code>chronyd</code> should keep for each source.  This setting can be overriden for
individual sources in the <code>server</code> and <code>refclock</code> directives
(see section <a href="#server-directive">server</a>, see section <a href="#refclock-directive">refclock</a>).  The default value is
0.  The useful range is 4 to 64.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">minsamples &lt;samples&gt;
</pre></div>
<hr>
<a name="minsources-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#minsamples-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#noclientlog-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="minsources"></a>
<h3 class="subsection">4.2.42 minsources</h3>
<p>The <code>minsources</code> directive sets the minimum number of sources that need
to be considered as selectable in the source selection algorithm before the
local clock is updated.  The default value is 1.
</p>
<p>Setting this option to a larger number can be used to improve the reliability.
More sources will have to agree with each other and the clock will not be
updated when only one source (which could be serving wrong time) is reachable.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">minsources &lt;sources&gt;
</pre></div>
<hr>
<a name="noclientlog-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#minsources-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#peer-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="noclientlog"></a>
<h3 class="subsection">4.2.43 noclientlog</h3>
<p>This directive, which takes no arguments, specifies that client accesses
are not to be logged.  Normally they are logged, allowing statistics to
be reported using the <code>clients</code> command in <code>chronyc</code>.
</p><hr>
<a name="peer-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#noclientlog-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#pidfile-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="peer"></a>
<h3 class="subsection">4.2.44 peer</h3>
<p>The syntax of this directive is identical to that for the <code>server</code>
directive (see section <a href="#server-directive">server</a>), except that it is used to specify
an NTP peer rather than an NTP server.
</p>
<p>Please note that NTP peers that are not configured with a key to enable
authentication are vulnerable to a denial-of-service attack.  An attacker
knowing that NTP hosts A and B are peering with each other can send a packet
with random timestamps to host A with source address of B which will set the
NTP state variables on A to the values sent by the attacker.  Host A will then
send on its next poll to B a packet with originate timestamp that doesn&rsquo;t match
the transmit timestamp of B and the packet will be dropped.  If the attacker
does this periodically for both hosts, they won&rsquo;t be able to synchronize to
each other.
</p>
<p>This attack can be prevented by enabling authentication with the key option, or
using the <code>server</code> directive on both sides to specify the other host as a
server instead of peer, the only drawback is that it will double the network
traffic between the two hosts.
</p><hr>
<a name="pidfile-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#peer-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#pool-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="pidfile"></a>
<h3 class="subsection">4.2.45 pidfile</h3>
<p>chronyd always writes its process ID (pid) to a file, and checks this file on startup to see if another chronyd may already be running on the system.  By default, the file used is <code>/var/run/chronyd.pid</code>.  The <code>pidfile</code> directive allows the name to be changed, e.g.
</p>
<div class="example">
<pre class="example">pidfile /var/tmp/chronyd.pid
</pre></div>
<hr>
<a name="pool-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#pidfile-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#port-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="pool"></a>
<h3 class="subsection">4.2.46 pool</h3>
<p>The syntax of this directive is similar to that for the <code>server</code>
directive (see section <a href="#server-directive">server</a>), except that it is used to specify a pool
of NTP servers rather than a single NTP server.  The pool name is expected to
resolve to multiple addresses which may change over time.
</p>
<p>All options valid in the <code>server</code> directive can be used in this directive
too.  There is one option specific to <code>pool</code> directive: <code>maxsources</code>
sets the maximum number of sources that can be used from the pool, the default
value is 4.
</p>
<p>On start, when the pool name is resolved, <code>chronyd</code> will add up to 16
sources, one for each resolved address.  When the number of sources from which
at least one valid reply was received reaches <code>maxsources</code>, the other
sources will be removed.  When a pool source is unreachable or marked as
falseticker, <code>chronyd</code> will try to replace the source with a newly
resolved address of the pool.
</p>
<p>An example of the pool directive is
</p>
<div class="example">
<pre class="example">pool pool.ntp.org iburst maxsources 3
</pre></div>
<hr>
<a name="port-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#pool-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#refclock-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="port"></a>
<h3 class="subsection">4.2.47 port</h3>
<p>This option allows you to configure the port on which <code>chronyd</code>
will listen for NTP requests.  The port will be open only when an address is
allowed by the <code>allow</code> directive or command, an NTP peer is configured, or
the broadcast server mode is enabled.
</p>
<p>The compiled in default is udp/123, the standard NTP port.  If set to 0,
<code>chronyd</code> will never open the server port and will operate strictly in a
client-only mode.  The source port used in NTP client requests can be set by
the <code>acquisitionport</code> directive.
</p>
<p>An example of the port command is
</p>
<div class="example">
<pre class="example">port 11123
</pre></div>

<p>This would change the NTP port served by <code>chronyd</code> on the computer to
udp/11123.
</p><hr>
<a name="refclock-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#port-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#reselectdist-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="refclock"></a>
<h3 class="subsection">4.2.48 refclock</h3>
<p>Reference clocks allows very accurate synchronisation and <code>chronyd</code>
can function as a stratum 1 server.  They are specified by the
<code>refclock</code> directive.  It has two mandatory parameters, a refclock driver
name and a driver specific parameter.
</p>
<p>There are currently four drivers included:
</p>
<dl compact="compact">
<dt><code>PPS</code></dt>
<dd><p>PPSAPI (pulse per second) driver.  The parameter is the path to a PPS
device.  Assert events are used by default.  Driver option <code>:clear</code>
can be appended to the path if clear events should be used instead.
</p>
<p>As PPS refclock gets only sub-second time information, it needs another
source (NTP or non-PPS refclock) or local directive (see section <a href="#local-directive">local</a>) enabled to work.  For example:
</p>
<div class="example">
<pre class="example">refclock PPS /dev/pps0 lock NMEA
refclock SHM 0 offset 0.5 delay 0.2 refid NMEA noselect
</pre></div>

</dd>
<dt><code>SHM</code></dt>
<dd><p>NTP shared memory driver.  This driver uses a shared memory segment to
receive data from another daemon which communicates with an actual
reference clock.  The parameter is the number of a shared memory segment,
usually 0, 1, 2 or 3.  For example:
</p>
<div class="example">
<pre class="example">refclock SHM 1 poll 3 refid GPS1
</pre></div>

<p>A driver option in form <code>:perm=NNN</code> can be appended to the
segment number to create the segment with permissions other than the
default <code>0600</code>. 
</p>
<p>Some examples of applications that can be used as SHM sources are
<a href="http://catb.org/gpsd/"><code>gpsd</code></a>, <code>shmpps</code> and
<a href="http://www.buzzard.me.uk/jonathan/radioclock.html"><code>radioclk</code></a>.
</p></dd>
<dt><code>SOCK</code></dt>
<dd><p>Unix domain socket driver.  It is similar to the SHM driver, but uses a
different format and uses a socket instead of shared memory.  It does not
require polling and it
supports transmitting of PPS data.  The parameter is a path to the socket which
will be created by <code>chronyd</code> and used to receive the messages.  The format
of messages sent over the socket is described in the
<code>refclock_sock.c</code> file.
</p>
<p>Recent versions of the <code>gpsd</code> daemon include support for the SOCK
protocol.  The path where the socket should be created is described in the
<code>gpsd(8)</code> man page.  For example:
</p>
<div class="example">
<pre class="example">refclock SOCK /var/run/chrony.ttyS0.sock
</pre></div>

</dd>
<dt><code>PHC</code></dt>
<dd><p>PTP hardware clock (PHC) driver.  The parameter is the path to the device of
the PTP clock, which can be synchronised by a PTP daemon (e.g. <code>ptp4l</code>
from the <a href="http://linuxptp.sourceforge.net/">Linux PTP project</a>.  The PTP
clocks are typically kept in TAI instead of UTC.  The <code>offset</code> option can
be used to compensate for the current UTC/TAI offset.  For example:
</p>
<div class="example">
<pre class="example">refclock PHC /dev/ptp0 poll 3 dpoll -2 offset -35
</pre></div>

</dd>
</dl>

<p>The <code>refclock</code> command also supports a number of subfields (which
may be defined in any order):
</p>
<dl compact="compact">
<dt><code>poll</code></dt>
<dd><p>Timestamps produced by refclock drivers are not used immediately, but
they are stored and processed by a median filter in the polling interval
specified by this option.  This is defined as a power of 2 and may be
negative to specify a sub-second interval.  The
default is 4 (16 seconds).  A shorter interval allows <code>chronyd</code>
to react faster to changes in clock frequency, but it may decrease
the accuracy if the source is too noisy.
</p></dd>
<dt><code>dpoll</code></dt>
<dd><p>Some drivers don&rsquo;t listen for external events and try to produce
samples in their own polling interval.  This is defined as a power of
2 and may be negative to specify a sub-second interval.  The default
is 0 (1 second).
</p></dd>
<dt><code>refid</code></dt>
<dd><p>This option is used to specify a reference id of the refclock, as up
to four ASCII characters.  By default, first three characters from
driver name and the number of the refclock are used as refid.  Each
refclock must have an unique refid.
</p></dd>
<dt><code>filter</code></dt>
<dd><p>This option sets the length of the median filter which is used to
reduce noise.  With each poll about 40 percent of the stored samples is
discarded and one final sample is calculated as average of the
remaining samples.  If the length is 4 or above, at least 4 samples
have to be collected between polls.  For lengths below 4, the filter
has to be full.  The default is 64.
</p></dd>
<dt><code>rate</code></dt>
<dd><p>PPS signal frequency (in Hz).  This option only controls how the
received pulses are aligned.  To actually receive more than one
pulse per second, a negative <code>dpoll</code> has to be specified (-3 for
5Hz signal).  The default is 1.
</p></dd>
<dt><code>lock</code></dt>
<dd><p>This option can be used to lock a PPS refclock to another refclock
whose reference id is specified by this option.  In this mode received
pulses are aligned directly to unfiltered samples from the refclock.
By default, pulses are aligned to local clock, but only when it is
well synchronised.
</p></dd>
<dt><code>offset</code></dt>
<dd><p>This option can be used to compensate a constant error.  The specified
offset (in seconds) is applied to all samples produced by the
refclock.  The default is 0.0.
</p></dd>
<dt><code>delay</code></dt>
<dd><p>This option sets the NTP delay of the source (in seconds).  Half of
this value is included in the maximum assumed error which is used in the
source selection algorithm.  Increasing the delay is useful to avoid
having no majority in the algorithm or to make it prefer other
sources.  The default is 1e-9 (1 nanosecond).
</p></dd>
<dt><code>precision</code></dt>
<dd><p>Refclock precision (in seconds).  The default is 1e-6 (1 microsecond)
for SHM refclock, and 1e-9 (1 nanosecond) for SOCK, PPS and PHC refclocks.
</p></dd>
<dt><code>maxdispersion</code></dt>
<dd><p>Maximum allowed dispersion for filtered samples (in seconds).  Samples
with larger estimated dispersion are ignored.  By default, this limit
is disabled.
</p></dd>
<dt><code>prefer</code></dt>
<dd><p>Prefer this source over sources without prefer option.
</p></dd>
<dt><code>noselect</code></dt>
<dd><p>Never select this source.  This is useful for monitoring or with sources
which are not very accurate, but are locked with a PPS refclock.
</p></dd>
<dt><code>minsamples</code></dt>
<dd><p>Set the minimum number of samples kept for this source.  This overrides the
<code>minsamples</code> directive (see section <a href="#minsamples-directive">minsamples</a>).
</p></dd>
<dt><code>maxsamples</code></dt>
<dd><p>Set the maximum number of samples kept for this source.  This overrides the
<code>maxsamples</code> directive (see section <a href="#maxsamples-directive">maxsamples</a>).
</p></dd>
</dl>

<hr>
<a name="reselectdist-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#refclock-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#rtcautotrim-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="reselectdist"></a>
<h3 class="subsection">4.2.49 reselectdist</h3>
<p>When <code>chronyd</code> selects synchronisation source from available sources, it
will prefer the one with minimum synchronisation distance.  However, to
avoid frequent reselecting when there are sources with similar distance, a
fixed distance is added to the distance for sources that are currently not
selected.  This can be set with the <code>reselectdist</code> option.  By default, the
distance is 100 microseconds.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">reselectdist &lt;dist-in-seconds&gt;
</pre></div>
<hr>
<a name="rtcautotrim-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#reselectdist-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#rtcdevice-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="rtcautotrim"></a>
<h3 class="subsection">4.2.50 rtcautotrim</h3>
<p>The <code>rtcautotrim</code> directive is used to keep the real time clock (RTC)
close to the system clock automatically.  When the system clock is synchronized
and the estimated error between the two clocks is larger than the specified
threshold, <code>chronyd</code> will trim the RTC as if the <code>trimrtc</code>
(see section <a href="#trimrtc-command">trimrtc</a>) command was issued.
</p>
<p>This directive is effective only with the <code>rtcfile</code> directive.
</p>
<p>An example of the use of this directive is
</p>
<div class="example">
<pre class="example">rtcautotrim 30
</pre></div>

<p>This would set the threshold error to 30 seconds.
</p><hr>
<a name="rtcdevice-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rtcautotrim-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#rtcfile-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="rtcdevice"></a>
<h3 class="subsection">4.2.51 rtcdevice</h3>
<p>The <code>rtcdevice</code> directive defines the name of the device file for
accessing the real time clock.  By default this is <code>/dev/rtc</code>, unless the
directive is used to set a different value.  This applies to Linux systems with
devfs.  An example of use is
</p>
<div class="example">
<pre class="example">rtcdevice /dev/misc/rtc
</pre></div>
<hr>
<a name="rtcfile-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rtcdevice-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#rtconutc-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="rtcfile"></a>
<h3 class="subsection">4.2.52 rtcfile</h3>
<p>The <code>rtcfile</code> directive defines the name of the file in which
<code>chronyd</code> can save parameters associated with tracking the accuracy
of the system&rsquo;s real-time clock (RTC).
</p>
<p>The syntax is illustrated in the following example
</p>
<div class="example">
<pre class="example">rtcfile /var/lib/chrony/rtc
</pre></div>

<p><code>chronyd</code> saves information in this file when it exits and when the
<code>writertc</code> command is issued in <code>chronyc</code>.  The information
saved is the RTC&rsquo;s error at some epoch, that epoch (in seconds since
January 1 1970), and the rate at which the RTC gains or loses time.
</p>
<p>So far, the support for real-time clocks is limited - their code is even
more system-specific than the rest of the software.  You can only use
the real time clock facilities (the <code>rtcfile</code> directive and the
<code>-s</code> command line option to <code>chronyd</code>) if the following three
conditions apply:
</p>
<ol>
<li>
You are running Linux version 2.2.x or later.

</li><li>
You have compiled the kernel with extended real-time clock support
(i.e. the &lsquo;<tt>/dev/rtc</tt>&rsquo; device is capable of doing useful things).

</li><li>
You don&rsquo;t have other applications that need to make use of
&lsquo;<tt>/dev/rtc</tt>&rsquo; at all.

</li></ol>
<hr>
<a name="rtconutc-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rtcfile-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#rtcsync-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="rtconutc"></a>
<h3 class="subsection">4.2.53 rtconutc</h3>

<p><code>chronyd</code> assumes by default that the real time clock (RTC) keeps
local time (including any daylight saving changes).  This is convenient
on PCs running Linux which are dual-booted with DOS or Windows.
</p>
<p>NOTE : IF YOU KEEP THE REAL TIME CLOCK ON LOCAL TIME AND YOUR COMPUTER
IS OFF WHEN DAYLIGHT SAVING (SUMMER TIME) STARTS OR ENDS, THE COMPUTER&rsquo;S
SYSTEM TIME WILL BE ONE HOUR IN ERROR WHEN YOU NEXT BOOT AND START
CHRONYD.
</p>
<p>An alternative is for the RTC to keep Universal Coordinated Time (UTC).
This does not suffer from the 1 hour problem when daylight saving starts
or ends.
</p>
<p>If the <code>rtconutc</code> directive appears, it means the RTC is required
to keep UTC.  The directive takes no arguments.  It is equivalent to
specifying the <code>-u</code> switch to the Linux &lsquo;<tt>/sbin/hwclock</tt>&rsquo; program.
</p>
<p>Note that this setting is overriden when the <code>hwclockfile</code> directive
(see section <a href="#hwclockfile-directive">hwclockfile</a>) is used.
</p><hr>
<a name="rtcsync-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rtconutc-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#sched_005fpriority-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="rtcsync"></a>
<h3 class="subsection">4.2.54 rtcsync</h3>

<p>The <code>rtcsync</code> directive will enable a kernel mode where the
system time is copied to the real time clock (RTC) every 11 minutes.
</p>
<p>This directive is supported only on Linux and cannot be used when the
normal RTC tracking is enabled, i.e. when the <code>rtcfile</code> directive
is used.
</p><hr>
<a name="sched_005fpriority-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rtcsync-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#server-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="sched_005fpriority"></a>
<h3 class="subsection">4.2.55 sched_priority</h3>

<p>The <code>sched_priority</code> directive will select the SCHED_FIFO real-time
scheduler at the specified priority (which must be between 0 and 100).
This mode is supported only on Linux.
</p>
<p>This directive uses the Linux sched_setscheduler() system call to
instruct the kernel to use the SCHED_FIFO first-in, first-out
real-time scheduling policy for <code>chronyd</code> with the specified priority.
This means that whenever <code>chronyd</code> is ready to run it will run,
interrupting whatever else is running unless it is a higher priority
real-time process.  This should not impact performance as <code>chronyd's</code>
resource requirements are modest, but it should result in lower and
more consistent latency since <code>chronyd</code> will not need to wait for the
scheduler to get around to running it.  You should not use this unless
you really need it.  The sched_setscheduler man page has more details.
</p><hr>
<a name="server-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#sched_005fpriority-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#smoothtime-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="server"></a>
<h3 class="subsection">4.2.56 server</h3>
<p>The <code>server</code> directive allows NTP servers to be specified.  The
client/server relationship is strictly hierarchical : a client may
synchronise its system time to that of the server, but the server&rsquo;s
system time will never be influenced by that of a client.
</p>
<p>The <code>server</code> directive is immediately followed by either the name
of the server, or its IP address.  The server command also supports a
number of subfields (which may be defined in any order):
</p>
<dl compact="compact">
<dt><code>port</code></dt>
<dd><p>This option allows the UDP port on which the server understands NTP
requests to be specified.  For normal servers this option should not be
required (the default is 123, the standard NTP port).
</p></dd>
<dt><code>minpoll</code></dt>
<dd><p>Although <code>chronyd</code> will trim the rate at which it samples the
server during normal operation, the user may wish to constrain the
minimum polling interval.  This is always defined as a power of 2, so
<code>minpoll 5</code> would mean that the polling interval cannot drop below 32
seconds.  The default is 6 (64 seconds).
</p></dd>
<dt><code>maxpoll</code></dt>
<dd><p>In a similar way, the user may wish to constrain the maximum polling
interval.  Again this is specified as a power of 2, <code>maxpoll 9</code>
indicates that the polling interval must stay at or below 512 seconds.
The default is 10 (1024 seconds).
</p></dd>
<dt><code>maxdelay</code></dt>
<dd><p><code>chronyd</code> uses the network round-trip delay to the server to
determine how accurate a particular measurement is likely to be.  Long
round-trip delays indicate that the request, or the response, or both
were delayed.  If only one of the messages was delayed the measurement
error is likely to be substantial.
</p>
<p>For small variations in round trip delay, <code>chronyd</code> uses a
weighting scheme when processing the measurements.  However, beyond a
certain level of delay the measurements are likely to be so corrupted as
to be useless.  (This is particularly so on dial-up or other slow links,
where a long delay probably indicates a highly asymmetric delay caused
by the response waiting behind a lot of packets related to a download of
some sort).
</p>
<p>If the user knows that round trip delays above a certain level should
cause the measurement to be ignored, this level can be defined with the
maxdelay command.  For example, <code>maxdelay 0.3</code> would indicate that
measurements with a round-trip delay of 0.3 seconds or more should be
ignored.  The default value is 3 seconds.
</p>
</dd>
<dt><code>maxdelayratio</code></dt>
<dd><p>This option is similar to the maxdelay option above.  <code>chronyd</code>
keeps a record of the minimum round-trip delay amongst the previous
measurements that it has buffered.  If a measurement has a round trip
delay that is greater than the maxdelayratio times the minimum delay, it
will be rejected.
</p>
</dd>
<dt><code>maxdelaydevratio</code></dt>
<dd><p>If a measurement has ratio of the increase in round-trip delay from
the minimum delay amongst the previous measurements to the standard
deviation of the previous measurements that is greater than
maxdelaydevratio, it will be rejected. The default is 10.0.
</p>
</dd>
<dt><code>presend</code></dt>
<dd><p>If the timing measurements being made by <code>chronyd</code> are the only
network data passing between two computers, you may find that some
measurements are badly skewed due to either the client or the server
having to do an ARP lookup on the other party prior to transmitting a
packet.  This is more of a problem with long sampling intervals, which
may be similar in duration to the lifetime of entries in the ARP caches
of the machines.
</p>
<p>In order to avoid this problem, the <code>presend</code> option may be used.
It takes a single integer argument, which is the smallest polling
interval for which an extra pair of NTP packets will be exchanged
between the client and the server prior to the actual measurement.
For example, with the following option included in a
<code>server</code> directive :
</p>
<div class="example">
<pre class="example">presend 9
</pre></div>

<p>when the polling interval is 512 seconds or more, an extra NTP client
packet will be sent to the server a short time (currently 4 seconds)
before making the actual measurement.
</p>
</dd>
<dt><code>key</code></dt>
<dd><p>The NTP protocol supports the inclusion of checksums in the packets, to
prevent computers having their system time upset by rogue packets being
sent to them.  The checksums are generated as a function of a password,
using the cryptographic hash function set in the key file.
</p>
<p>The association between key numbers and passwords is contained in the
keys file, defined by the keyfile command.
</p>
<p>If the key option is present, <code>chronyd</code> will attempt to use
authenticated packets when communicating with this server.  The key
number used will be the single argument to the key option (an
unsigned integer in the range 1 through 2**32-1). The server
must have the same password for this key number configured, otherwise no
relationship between the computers will be possible.
</p>
</dd>
<dt><code>offline</code></dt>
<dd><p>If the server will not be reachable when <code>chronyd</code> is started, the
offline option may be specified.  <code>chronyd</code> will not try to poll
the server until it is enabled to do so (by using the online option of
<code>chronyc</code>).
</p>
</dd>
<dt><code>auto_offline</code></dt>
<dd><p>If this option is set, the server will be assumed to have gone offline when 2
requests have been sent to it without receiving a response.  This option avoids
the need to run the <code>offline</code> (see section <a href="#offline-command">offline</a>) command from
chrony when disconnecting the dial-up link.  (It will still be necessary to use
chronyc&rsquo;s <code>online</code> (see section <a href="#online-command">online</a>) command when the link has been
established, to enable measurements to start.)
</p>
</dd>
<dt><code>iburst</code></dt>
<dd><p>On start, make four measurements over a short duration (rather than
the usual periodic measurements).
</p>
</dd>
<dt><code>minstratum</code></dt>
<dd><p>When the synchronisation source is selected from available sources, sources
with lower stratum are normally preferred.  This option can be used to increase
stratum of the source to the specified minimum, so <code>chronyd</code> will avoid
selecting that source.  This is useful with low stratum sources that are known
to be unrealiable or inaccurate and which should be used only when other
sources are unreachable.
</p>
</dd>
<dt><code>polltarget</code></dt>
<dd><p>Target number of measurements to use for the regression algorithm which
<code>chronyd</code> will try to maintain by adjusting polling interval between
<code>minpoll</code> and <code>maxpoll</code>.  A higher target makes <code>chronyd</code> prefer
shorter polling intervals.  The default is 6 and a useful range is 6 to 60.
</p>
</dd>
<dt><code>version</code></dt>
<dd><p>This option sets the NTP version number used in packets sent to the server.
This can be useful when the server runs an old NTP implementation that doesn&rsquo;t
respond to newer versions.  The default version number is 4.
</p>
</dd>
<dt><code>prefer</code></dt>
<dd><p>Prefer this source over sources without prefer option.
</p>
</dd>
<dt><code>noselect</code></dt>
<dd><p>Never select this source.  This is particularly useful for monitoring.
</p>
</dd>
<dt><code>minsamples</code></dt>
<dd><p>Set the minimum number of samples kept for this source.  This overrides the
<code>minsamples</code> directive (see section <a href="#minsamples-directive">minsamples</a>).
</p>
</dd>
<dt><code>maxsamples</code></dt>
<dd><p>Set the maximum number of samples kept for this source.  This overrides the
<code>maxsamples</code> directive (see section <a href="#maxsamples-directive">maxsamples</a>).
</p>
</dd>
</dl>
<hr>
<a name="smoothtime-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#server-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#stratumweight-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="smoothtime"></a>
<h3 class="subsection">4.2.57 smoothtime</h3>
<p>The <code>smoothtime</code> directive can be used to enable smoothing of the time
that <code>chronyd</code> serves to its clients to make it easier for them to track
it and keep their clocks close together even when large offset or frequency
corrections are applied to the server&rsquo;s clock, for example after being offline
for a longer time.
</p>
<p>BE WARNED - the server is intentionally not serving its best estimate of the
true time.  If a large offset has been accumulated, it may take a very long
time to smooth it out.  This directive should be used only when the clients are
not configured to poll also another NTP server, because they could reject this
server as a falseticker or fail to select a source completely.
</p>
<p>The smoothing process is implemented with a quadratic spline function with two
or three pieces. It&rsquo;s independent from any slewing applied to the local system
clock, but the accumulated offset and frequency will be reset when the clock is
corrected by stepping, e.g. by the <code>makestep</code> directive or command.  The
process can be reset without stepping the clock by the <code>smoothtime reset</code>
command (see section <a href="#smoothtime-command">smoothtime</a>).
</p>
<p>The first two arguments of the directive are the maximum frequency offset of
the smoothed time to the tracked NTP time (in ppm) and the maximum rate at
which the frequency offset is allowed to change (in ppm per second).
<code>leaponly</code> is an optional third argument which enables a mode where only
leap seconds are smoothed out and normal offset/frequency changes are ignored.
The <code>leaponly</code> option is useful in a combination with the
<code>leapsecmode slew</code> option (see section <a href="#leapsecmode-directive">leapsecmode</a>) to allow clients
use multiple time smoothing servers safely.
</p>
<p>The smoothing process is activated automatically when 1/10000 of the estimated
skew of the local clock falls below the maximum rate of frequency change.  It
can be also activated manually by the <code>smoothtime activate</code> command,
which is particularly useful when the clock is synchronized only with manual
input and the skew is always larger than the threshold.  The <code>smoothing</code>
command (see section <a href="#smoothing-command">smoothing</a>) can be used to monitor the process.
</p>
<p>An example suitable for clients using <code>ntpd</code> and 1024 second polling
interval could be
</p>
<div class="example">
<pre class="example">smoothtime 400 0.001
</pre></div>

<p>An example suitable for clients using <code>chronyd</code> on Linux could be
</p>
<div class="example">
<pre class="example">smoothtime 50000 0.01
</pre></div>
<hr>
<a name="stratumweight-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#smoothtime-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#tempcomp-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="stratumweight"></a>
<h3 class="subsection">4.2.58 stratumweight</h3>

<p>The <code>stratumweight</code> directive sets how much distance should be added
per stratum to the synchronisation distance when <code>chronyd</code> selects
the synchronisation source from available sources.
</p>
<p>The syntax is
</p>
<div class="example">
<pre class="example">stratumweight &lt;dist-in-seconds&gt;
</pre></div>

<p>By default, the weight is 0.001 seconds.  This means that stratum of the
sources in the selection process matters only when the differences between the
distances are in milliseconds.
</p>
<hr>
<a name="tempcomp-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#stratumweight-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#user-directive" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="tempcomp"></a>
<h3 class="subsection">4.2.59 tempcomp</h3>
<p>Normally, changes in the rate of drift of the system clock are caused mainly by
changes in the temperature of the crystal oscillator on the mainboard.
</p>
<p>If there are temperature measurements available from a sensor close to the
oscillator, the <code>tempcomp</code> directive can be used to compensate for the
changes in the temperature and improve the stability and accuracy of the clock.
</p>
<p>The result depends on many factors, including the resolution of the sensor,
the amount of noise in the measurements, the polling interval of the time
source, the compensation update interval, how well is the compensation
specified, and how close is the sensor to the oscillator.  When it&rsquo;s working
well, the frequency reported in the &lsquo;<tt>tracking.log</tt>&rsquo; file is more stable and
the maximum reached offset is smaller.
</p>
<p>There are two forms of the directive.  The first one has six parameters: a
path to the file containing the current temperature from the sensor (in
text format), the compensation update interval (in seconds), and temperature
coefficients T0, k0, k1, k2.
</p>
<p>The frequency compensation is calculated (in ppm) as 
</p>
<p><code>k0 + (T - T0) * k1 + (T - T0)^2 * k2</code>
</p>
<p>The result has to be between -10 ppm and 10 ppm, otherwise the measurement is
considered invalid and will be ignored.  The k0 coefficient can be used to get
the results in that range.
</p>
<p>An example of use is
</p>
<div class="example">
<pre class="example">tempcomp /sys/class/hwmon/hwmon0/temp2_input 30 26000 0.0 0.000183 0.0
</pre></div>

<p>The measured temperature will be read from the file in the Linux sysfs
filesystem every 30 seconds.  When the temperature is 26000 (26 degrees
Celsius), the frequency correction will be zero.  When it is 27000 (27 degrees
Celsius), the clock will be set to run 0.183ppm faster, etc.
</p>
<p>The second form has three parameters, the path to the sensor file, the update
interval and a path to a file containing a list of (temperature, compensation)
points, from which the compensation is linearly interpolated or extrapolated.
</p>
<p>An example is
</p>
<div class="example">
<pre class="example">tempcomp /sys/class/hwmon/hwmon0/temp2_input 30 /etc/chrony.tempcomp
</pre></div>

<p>where the &lsquo;<tt>chrony.tempcomp</tt>&rsquo; file could have
</p>
<div class="example">
<pre class="example">20000 1.0
21000 0.64
22000 0.36
23000 0.16
24000 0.04
25000 0.0
26000 0.04
27000 0.16
28000 0.36
29000 0.64
30000 1.0
</pre></div>

<p>Valid measurements with corresponding compensations are logged to the
&lsquo;<tt>tempcomp.log</tt>&rsquo; file if enabled by the <code>log tempcomp</code> directive.
</p><hr>
<a name="user-directive"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#tempcomp-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Configuration-file" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Running-chronyc" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="user"></a>
<h3 class="subsection">4.2.60 user</h3>
<p>The <code>user</code> directive sets the name of the user to which will
<code>chronyd</code> switch on initialisation to drop root privileges.
So far, it works only on Linux when compiled with capabilities support.
Setting the name to root will disable it.
</p>
<p>The default value is <code>root</code>.
</p><hr>
<a name="Running-chronyc"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#user-directive" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Usage-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-basic-use" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Running-chronyc-1"></a>
<h2 class="section">4.3 Running chronyc</h2>
<p>Chronyc is the program that can be used to reconfigure options within
the <code>chronyd</code> program whilst it is running.  Chronyc can also be
used to generate status reports about the operation of <code>chronyd</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Chronyc-basic-use">4.3.1 Basic use</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           How to run chronyc
</td></tr>
<tr><td align="left" valign="top"><a href="#Chronyc-command-line-options">4.3.2 Command line options</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  Chrony&rsquo;s command line options
</td></tr>
<tr><td align="left" valign="top"><a href="#Security-with-chronyc">4.3.3 Security with chronyc</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       How chronyd restricts access
</td></tr>
<tr><td align="left" valign="top"><a href="#Chronyc-command-reference">4.3.4 Command reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">   All the commands chronyc supports
</td></tr>
</table>
<hr>
<a name="Chronyc-basic-use"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Running-chronyc" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Running-chronyc" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-line-options" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Basic-use"></a>
<h3 class="subsection">4.3.1 Basic use</h3>
<p>The program chronyc is run by entering
</p>
<div class="example">
<pre class="example">chronyc
</pre></div>

<p>at the command line.  The prompt <code>chronyc</code> is displayed whilst
chronyc is expecting input from the user, when it is being run from a
terminal.  If chronyc&rsquo;s input or output are redirected from/to a file,
the prompt is now shown.
</p>
<p>When you are finished entering commands, the commands <code>exit</code> or
<code>quit</code> will terminate the program.  (Entering &lt;Control-D&gt; will
also terminate the program.)
</p><hr>
<a name="Chronyc-command-line-options"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-basic-use" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Running-chronyc" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Security-with-chronyc" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Command-line-options"></a>
<h3 class="subsection">4.3.2 Command line options</h3>
<p>Chronyc supports the following command line options.
</p>
<dl compact="compact">
<dt><code>-v</code></dt>
<dd><p>Displays the version number of chronyc on the terminal, and exists.
</p></dd>
<dt><code>-h &lt;host&gt;</code></dt>
<dd><p>This option allows the user to specify which host running the
<code>chronyd</code> program is to be contacted.  This allows for remote
configuration, without having to ssh to the other host first.
</p>
<p>The default is to contact <code>chronyd</code> running on the same host as
that where chronyc is being run.
</p></dd>
<dt><code>-p &lt;port&gt;</code></dt>
<dd><p>This option allows the user to specify the UDP port number which the
target <code>chronyd</code> is using for its command &amp; monitoring connections.
This defaults to the compiled-in default; there would rarely be a need
to change this.
</p></dd>
<dt><code>-n</code></dt>
<dd><p>This option disables resolving IP addresses to hostnames.
</p></dd>
<dt><code>-4</code></dt>
<dd><p>With this option hostnames will be resolved only to IPv4 addresses.
</p></dd>
<dt><code>-6</code></dt>
<dd><p>With this option hostnames will be resolved only to IPv6 addresses.
</p></dd>
<dt><code>-m</code></dt>
<dd><p>With this option multiple commands can be specified on the command line.
Each argument will be interpreted as a whole command.
</p></dd>
<dt><code>-f &lt;conf-file&gt;</code></dt>
<dd><p>This option can be used to specify an alternate location of the <code>chronyd</code>
configuration file (default &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;). The configuration file is
needed for the &lsquo;-a&rsquo; option.
</p></dd>
<dt><code>-a</code></dt>
<dd><p>With this option <code>chronyc</code> will try to authenticate automatically on
start. It will read the configuration file, read the command key from the
keyfile and run the authhash and password commands.
</p></dd>
</dl>
<hr>
<a name="Security-with-chronyc"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-line-options" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Running-chronyc" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Security-with-chronyc-1"></a>
<h3 class="subsection">4.3.3 Security with chronyc</h3>
<p>Many of the commands available through chronyc have a fair amount of
power to reconfigure the run-time behaviour of <code>chronyd</code>.  Consequently,
<code>chronyc</code> is quite dangerous for the integrity of the target
system&rsquo;s clock performance.  Having access to <code>chronyd</code> via chronyc is
more or less equivalent to being able to modify <code>chronyd's</code> configuration
file (typically &lsquo;<tt>/etc/chrony.conf</tt>&rsquo;) and to restart <code>chronyd</code>.
</p>
<p>Chronyc also provides a number of monitoring (as opposed to commanding)
commands, which will not affect the behaviour of <code>chronyd</code>.  However, you
may still want to restrict access to these commands.
</p>
<p>In view of this, access to some of the capabilities of chronyc will
usually be tightly controlled.  There are two mechanisms supported:
</p>
<ol>
<li>
The set of hosts from which <code>chronyd</code> will accept commands can be
restricted.  By default, commands will only be accepted from the same
host that <code>chronyd</code> is running on.
</li><li>
Any command that actually reconfigures some aspect of <code>chronyd's</code>
behaviour requires the user of chronyc to know a password.  This
password is specified in <code>chronyd's</code> keys file (see section <a href="#keyfile-directive">keyfile</a>)
and specified via the commandkey option in its configuration file
(see section <a href="#commandkey-directive">commandkey</a>).
</li></ol>

<p>Only the following commands can be used <em>without</em> providing a
password:
</p>
<ul>
<li> <code>activity</code>
</li><li> <code>authhash</code>
</li><li> <code>dns</code>
</li><li> <code>exit</code>
</li><li> <code>help</code>
</li><li> <code>password</code>
</li><li> <code>quit</code>
</li><li> <code>rtcdata</code>
</li><li> <code>smoothing</code>
</li><li> <code>sources</code>
</li><li> <code>sourcestats</code>
</li><li> <code>tracking</code>
</li><li> <code>waitsync</code>
</li></ul>

<p>All other commands require a password to have been specified previously,
because they affect <code>chronyd's</code> operation.
</p><hr>
<a name="Chronyc-command-reference"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Security-with-chronyc" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Running-chronyc" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#accheck-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Command-reference"></a>
<h3 class="subsection">4.3.4 Command reference</h3>
<p>This section describes each of the commands available within the chronyc
program.  Chronyc offers the user a simple command-line driven
interface.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#accheck-command">4.3.4.1 accheck</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Verifying NTP client access
</td></tr>
<tr><td align="left" valign="top"><a href="#activity-command">4.3.4.2 activity</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Check how many NTP servers/peers are online/offline
</td></tr>
<tr><td align="left" valign="top"><a href="#add-peer-command">4.3.4.3 add peer</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Add a new NTP peer
</td></tr>
<tr><td align="left" valign="top"><a href="#add-server-command">4.3.4.4 add server</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Add a new NTP server
</td></tr>
<tr><td align="left" valign="top"><a href="#allow-all-command">4.3.4.5 allow all</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Allowing NTP client access
</td></tr>
<tr><td align="left" valign="top"><a href="#allow-command">4.3.4.6 allow</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Allowing NTP client access
</td></tr>
<tr><td align="left" valign="top"><a href="#authhash-command">4.3.4.7 authhash</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Set the command authentication hash function
</td></tr>
<tr><td align="left" valign="top"><a href="#burst-command">4.3.4.8 burst</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Initiating a rapid set of measurements
</td></tr>
<tr><td align="left" valign="top"><a href="#clients-command">4.3.4.9 clients</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Show clients that have accessed the server
</td></tr>
<tr><td align="left" valign="top"><a href="#cmdaccheck-command">4.3.4.10 cmdaccheck</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Verifying command client access
</td></tr>
<tr><td align="left" valign="top"><a href="#cmdallow-all-command">4.3.4.11 cmdallow all</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Allowing command client access
</td></tr>
<tr><td align="left" valign="top"><a href="#cmdallow-command">4.3.4.12 cmdallow</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Allowing command client access
</td></tr>
<tr><td align="left" valign="top"><a href="#cmddeny-all-command">4.3.4.13 cmddeny all</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Denying command client access
</td></tr>
<tr><td align="left" valign="top"><a href="#cmddeny-command">4.3.4.14 cmddeny</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Denying command client access
</td></tr>
<tr><td align="left" valign="top"><a href="#cyclelogs-command">4.3.4.15 cyclelogs</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Close and re-open open log files
</td></tr>
<tr><td align="left" valign="top"><a href="#delete-command">4.3.4.16 delete</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Remove an NTP server or peer
</td></tr>
<tr><td align="left" valign="top"><a href="#deny-all-command">4.3.4.17 deny all</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Denying NTP client access
</td></tr>
<tr><td align="left" valign="top"><a href="#deny-command">4.3.4.18 deny</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Denying NTP client access
</td></tr>
<tr><td align="left" valign="top"><a href="#dns-command">4.3.4.19 dns</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Configure how are hostnames and IP addresses resolved
</td></tr>
<tr><td align="left" valign="top"><a href="#dump-command">4.3.4.20 dump</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Dump measurement histories to files
</td></tr>
<tr><td align="left" valign="top"><a href="#exit-command">4.3.4.21 exit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Exit from chronyc
</td></tr>
<tr><td align="left" valign="top"><a href="#help-command">4.3.4.22 help</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Generate help summary
</td></tr>
<tr><td align="left" valign="top"><a href="#local-command">4.3.4.23 local</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Let computer be a server when it is unsynchronised
</td></tr>
<tr><td align="left" valign="top"><a href="#makestep-command">4.3.4.24 makestep</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Correct the system clock by stepping instead of slewing
</td></tr>
<tr><td align="left" valign="top"><a href="#manual-command">4.3.4.25 manual</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Enable/disable/configure options for settime
</td></tr>
<tr><td align="left" valign="top"><a href="#maxdelay-command">4.3.4.26 maxdelay</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Set max measurement delay for a source
</td></tr>
<tr><td align="left" valign="top"><a href="#maxdelaydevratio-command">4.3.4.27 maxdelaydevratio</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">    Set max measurement delay for a source as ratio to deviation
</td></tr>
<tr><td align="left" valign="top"><a href="#maxdelayratio-command">4.3.4.28 maxdelayratio</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Set max measurement delay for a source as ratio
</td></tr>
<tr><td align="left" valign="top"><a href="#maxpoll-command">4.3.4.29 maxpoll</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Set maximum polling interval for a source
</td></tr>
<tr><td align="left" valign="top"><a href="#maxupdateskew-command">4.3.4.30 maxupdateskew</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Set safety threshold for clock gain/loss rate
</td></tr>
<tr><td align="left" valign="top"><a href="#minpoll-command">4.3.4.31 minpoll</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Set minimum polling interval for a source
</td></tr>
<tr><td align="left" valign="top"><a href="#minstratum-command">4.3.4.32 minstratum</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Set minimum stratum for a source
</td></tr>
<tr><td align="left" valign="top"><a href="#offline-command">4.3.4.33 offline</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Warn that connectivity to a source will be lost
</td></tr>
<tr><td align="left" valign="top"><a href="#online-command">4.3.4.34 online</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Warn that connectivity to a source has been restored
</td></tr>
<tr><td align="left" valign="top"><a href="#password-command">4.3.4.35 password</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Provide password needed for most commands
</td></tr>
<tr><td align="left" valign="top"><a href="#polltarget-command">4.3.4.36 polltarget</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Set poll target for a source
</td></tr>
<tr><td align="left" valign="top"><a href="#quit-command">4.3.4.37 quit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Exit from chronyc
</td></tr>
<tr><td align="left" valign="top"><a href="#reselect-command">4.3.4.38 reselect</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Reselect synchronisation source
</td></tr>
<tr><td align="left" valign="top"><a href="#reselectdist-command">4.3.4.39 reselectdist</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Set improvement in distance needed to reselect a source
</td></tr>
<tr><td align="left" valign="top"><a href="#retries-command">4.3.4.40 retries</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Set maximum number of retries
</td></tr>
<tr><td align="left" valign="top"><a href="#rtcdata-command">4.3.4.41 rtcdata</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Display RTC parameters
</td></tr>
<tr><td align="left" valign="top"><a href="#settime-command">4.3.4.42 settime</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Provide a manual input of the current time
</td></tr>
<tr><td align="left" valign="top"><a href="#smoothing-command">4.3.4.43 smoothing</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           Display current time smoothing state
</td></tr>
<tr><td align="left" valign="top"><a href="#smoothtime-command">4.3.4.44 smoothtime</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Reset/activate server time smoothing
</td></tr>
<tr><td align="left" valign="top"><a href="#sources-command">4.3.4.45 sources</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Display information about the current set of sources
</td></tr>
<tr><td align="left" valign="top"><a href="#sourcestats-command">4.3.4.46 sourcestats</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Display the rate &amp; offset estimation performance of sources
</td></tr>
<tr><td align="left" valign="top"><a href="#timeout-command">4.3.4.47 timeout</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Set initial response timeout
</td></tr>
<tr><td align="left" valign="top"><a href="#tracking-command">4.3.4.48 tracking</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Display system clock performance
</td></tr>
<tr><td align="left" valign="top"><a href="#trimrtc-command">4.3.4.49 trimrtc</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Correct the RTC time to the current system time
</td></tr>
<tr><td align="left" valign="top"><a href="#waitsync-command">4.3.4.50 waitsync</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Wait until synchronised
</td></tr>
<tr><td align="left" valign="top"><a href="#writertc-command">4.3.4.51 writertc</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Write the RTC parameters to file
</td></tr>
</table>
<hr>
<a name="accheck-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#activity-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="accheck"></a>
<h4 class="subsubsection">4.3.4.1 accheck</h4>
<p>This command allows you to check whether client NTP access is allowed
from a particular host.
</p>
<p>Examples of use, showing a named host and a numeric IP address, are as
follows:
</p>
<div class="example">
<pre class="example">accheck foo.example.net
accheck 1.2.3.4
accheck 2001:db8::1
</pre></div>

<p>This command can be used to examine the effect of a series of
<code>allow</code>, <code>allow all</code>, <code>deny</code> and <code>deny all</code> commands
specified either via chronyc, or in <code>chronyd's</code> configuration file.
</p><hr>
<a name="activity-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#accheck-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#add-peer-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="activity"></a>
<h4 class="subsubsection">4.3.4.2 activity</h4>
<p>This command reports the number of servers/peers that are online and offline.
If the auto_offline option is used in specifying some of the servers/peers, the
<code>activity</code> command may be useful for detecting when all of them have
entered the offline state after the PPP link has been disconnected.
</p>
<p>The report shows the number of servers/peers in 5 states:
</p><ul>
<li> <code>online</code> : the server/peer is currently online (i.e. assumed by
chronyd to be reachable)
</li><li> <code>offline</code> : the server/peer is currently offline (i.e. assumed by
chronyd to be unreachable, and no measurements from it will be attempted.)
</li><li> <code>burst_online</code> : a burst command has been initiated for the
server/peer and is being performed; after the burst is complete, the
server/peer will be returned to the online state.
</li><li> <code>burst_offline</code> : a burst command has been initiated for the
server/peer and is being performed; after the burst is complete, the
server/peer will be returned to the offline state.
</li><li> <code>unresolved</code> : the name of the server/peer wasn&rsquo;t resolved to an
address yet; this server is not visible in the <code>sources</code> and
<code>sourcestats</code> reports.
</li></ul>
<hr>
<a name="add-peer-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#activity-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#add-server-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="add-peer"></a>
<h4 class="subsubsection">4.3.4.3 add peer</h4>
<p>The <code>add peer</code> command allows a new NTP peer to be added whilst
<code>chronyd</code> is running.
</p>
<p>Following the words <code>add peer</code>, the syntax of the following
parameters and options is similar to that for the <code>peer</code>
directive in the configuration file (see section <a href="#peer-directive">peer</a>).
The following peer options can be set in the command:
<code>port</code>, <code>minpoll</code>, <code>maxpoll</code>, <code>presend</code>,
<code>maxdelayratio</code>, <code>maxdelay</code>, <code>key</code>
</p>
<p>An example of using this command is shown below.
</p>
<div class="example">
<pre class="example">add peer foo.example.net minpoll 6 maxpoll 10 key 25
</pre></div>
<hr>
<a name="add-server-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#add-peer-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#allow-all-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="add-server"></a>
<h4 class="subsubsection">4.3.4.4 add server</h4>
<p>The <code>add server</code> command allows a new NTP server to be added whilst
<code>chronyd</code> is running.
</p>
<p>Following the words <code>add server</code>, the syntax of the following
parameters and options is similar to that for the <code>server</code>
directive in the configuration file (see section <a href="#server-directive">server</a>).
The following server options can be set in the command:
<code>port</code>, <code>minpoll</code>, <code>maxpoll</code>, <code>presend</code>,
<code>maxdelayratio</code>, <code>maxdelay</code>, <code>key</code>
</p>
<p>An example of using this command is shown below.
</p>
<div class="example">
<pre class="example">add server foo.example.net minpoll 6 maxpoll 10 key 25
</pre></div>
<hr>
<a name="allow-all-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#add-server-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#allow-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="allow-all"></a>
<h4 class="subsubsection">4.3.4.5 allow all</h4>
<p>The effect of the allow command is identical to the <code>allow all</code>
directive in the configuration file (see section <a href="#allow-directive">allow</a>).
</p><hr>
<a name="allow-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#allow-all-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#authhash-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="allow"></a>
<h4 class="subsubsection">4.3.4.6 allow</h4>
<p>The effect of the allow command is identical to the <code>allow</code> directive in
the configuration file (see section <a href="#allow-directive">allow</a>).
</p>
<p>The syntax is illustrated in the following examples:
</p>
<div class="example">
<pre class="example">allow foo.example.net
allow 1.2
allow 3.4.5
allow 6.7.8/22
allow 6.7.8.9/22
allow 2001:db8:789a::/48
allow 0/0
allow ::/0
allow
</pre></div>

<p>The effect of each of these examples is the same as that of the <code>allow</code>
directive in the configuration file.
</p><hr>
<a name="authhash-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#allow-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#burst-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="authhash"></a>
<h4 class="subsubsection">4.3.4.7 authhash</h4>
<p>This command selects the hash function used for authenticating user commands.
For successful authentication the hash function has to be the same as the
function specified for the command key in the keys file on the server
(see section <a href="#keyfile-directive">keyfile</a>).  It needs to be selected before the
<code>password</code> command is used.  The default hash function is MD5.
</p>
<p>An example is
</p>
<div class="example">
<pre class="example">authhash SHA1
</pre></div>

<p>The authhash command is run automatically on start if <code>chronyc</code> was
started with the &lsquo;-a&rsquo; option.
</p><hr>
<a name="burst-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#authhash-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#clients-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="burst"></a>
<h4 class="subsubsection">4.3.4.8 burst</h4>
<p>The <code>burst</code> command tells <code>chronyd</code> to make a set of measurements to
each of its NTP sources over a short duration (rather than the usual
periodic measurements that it makes).  After such a burst, <code>chronyd</code> will
revert to the previous state for each source.  This might be either
online, if the source was being periodically measured in the normal way,
or offline, if the source had been indicated as being offline.
(Switching a source between the online and offline states is described
in <a href="#online-command">online</a>, <a href="#offline-command">offline</a>).
</p>
<p>The syntax of the burst command is as follows
</p>
<div class="example">
<pre class="example">burst &lt;n-good-measurements&gt;/&lt;max-measurements&gt; [&lt;mask&gt;/&lt;masked-address&gt;]
burst &lt;n-good-measurements&gt;/&lt;max-measurements&gt; [&lt;masked-address&gt;/&lt;masked-bits&gt;]
burst &lt;n-good-measurements&gt;/&lt;max-measurements&gt; [&lt;address&gt;]
</pre></div>

<p>The mask and masked-address arguments are optional, in which case
<code>chronyd</code> will initiate a burst for all of its currently defined sources.
</p>
<p>The arguments have the following meaning and format.
</p>
<dl compact="compact">
<dt><code>n-good-measurements</code></dt>
<dd><p>This defines the number of good measurements that <code>chronyd</code> will want to
obtain from each source.  A measurement is good if it passes certain
tests, for example, the round trip time to the source must be
acceptable.  (This allows <code>chronyd</code> to reject measurements that are likely
to be bogus.)
</p>
</dd>
<dt><code>max-measurements</code></dt>
<dd><p>This defines the maximum number of measurements that <code>chronyd</code> will
attempt to make, even if the required number of good measurements has
not been obtained.
</p>
</dd>
<dt><code>mask</code></dt>
<dd><p>This is an IP address with which the IP address of each of <code>chronyd</code>&rsquo;s
sources is to be masked.
</p>
</dd>
<dt><code>masked-address</code></dt>
<dd><p>This is an IP address.  If the masked IP address of a source matches this value
then the burst command is applied to that source.
</p>
</dd>
<dt><code>masked-bits</code></dt>
<dd><p>This can be used with <code>masked-address</code> for CIDR notation, which is a
shorter alternative to the form with mask.
</p>
</dd>
<dt><code>address</code></dt>
<dd><p>This is an IP address or a hostname.  The burst command is applied only to that
source.
</p>
</dd>
</dl>

<p>If no mask or masked address arguments are provided, every source will
be matched.
</p>
<p>An example of the two-argument form of the command is 
</p>
<div class="example">
<pre class="example">burst 2/10
</pre></div>

<p>This will cause <code>chronyd</code> to attempt to get two good measurements from
each source, stopping after two have been obtained, but in no event will
it try more than ten probes to the source.
</p>
<p>Examples of the four-argument form of the command are
</p>
<div class="example">
<pre class="example">burst 2/10 255.255.0.0/1.2.0.0
burst 2/10 2001:db8:789a::/48
</pre></div>

<p>In the first case, the two out of ten sampling will only be applied to
sources whose IPv4 addresses are of the form <code>1.2.x.y</code>, where x and y
are arbitrary. In the second case, the sampling will be applied to sources
whose IPv6 addresses have first 48 bits equal to <code>2001:db8:789a</code>.
</p>
<p>Example of the three-argument form of the command is
</p>
<div class="example">
<pre class="example">burst 2/10 foo.example.net
</pre></div>
<hr>
<a name="clients-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#burst-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmdaccheck-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="clients"></a>
<h4 class="subsubsection">4.3.4.9 clients</h4>
<p>This command shows a list of all clients that have accessed the server,
through either the NTP or command/monitoring ports.  There are no arguments.
</p>
<p>An example of the output is
</p>
<div class="example">
<pre class="example">Hostname                   Client    Peer CmdAuth CmdNorm  CmdBad  LstN  LstC
=========================  ======  ======  ======  ======  ======  ====  ====
localhost                       0       0      15       1       0   29y     0
aardvark.xxx                    4       0       0       0       0    49   29y
badger.xxx                      4       0       0       0       0     6   29y
</pre></div>

<p>Each row shows the data for a single host.  Only hosts that have passed
the host access checks (set with the <code>allow</code>, <code>deny</code>,
<code>cmdallow</code> and <code>cmddeny</code> commands or configuration file
directives) are logged.
</p>
<p>The columns are as follows:
</p>
<ol>
<li>
The hostname of the client
</li><li>
The number of times the client has accessed the server using an NTP
client mode packet.
</li><li>
The number of times the client has accessed the server using an NTP
symmetric active mode packet.
</li><li>
The number of authenticated command packets that have been processed
from the client (i.e. those following a successful <code>password</code>
command).
</li><li>
The number of unauthenticated command packets that have been processed
from the client.
</li><li>
The number of bad command packets received from the client (not all
forms of bad packet are logged).
</li><li>
Time since the last NTP packet was received
</li><li>
Time since the last command packet was received
</li></ol>

<p>The last two entries will be shown as the time since 1970 if no packet
of that type has ever been received.
</p><hr>
<a name="cmdaccheck-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#clients-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmdallow-all-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmdaccheck"></a>
<h4 class="subsubsection">4.3.4.10 cmdaccheck</h4>
<p>This command is similar to the <code>accheck</code> command, except that it is
used to check whether command access is permitted from a named host.
</p>
<p>Examples of use are as follows:
</p>
<div class="example">
<pre class="example">cmdaccheck foo.example.net
cmdaccheck 1.2.3.4
cmdaccheck 2001:db8::1
</pre></div>
<hr>
<a name="cmdallow-all-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmdaccheck-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmdallow-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmdallow-all"></a>
<h4 class="subsubsection">4.3.4.11 cmdallow all</h4>
<p>This is similar to the <code>allow all</code> command, except that it is used toallow particular hosts or subnets to use the chronyc program to interactwith <code>chronyd</code> on the current host.
</p><hr>
<a name="cmdallow-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmdallow-all-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmddeny-all-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmdallow"></a>
<h4 class="subsubsection">4.3.4.12 cmdallow</h4>
<p>This is similar to the <code>allow</code> command, except that it is used to
allow particular hosts or subnets to use the chronyc program to interact
with <code>chronyd</code> on the current host.
</p><hr>
<a name="cmddeny-all-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmdallow-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cmddeny-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmddeny-all"></a>
<h4 class="subsubsection">4.3.4.13 cmddeny all</h4>
<p>This is similar to the <code>deny all</code> command, except that it is used
to allow particular hosts or subnets to use the chronyc program to
interact with <code>chronyd</code> on the current host.
</p><hr>
<a name="cmddeny-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmddeny-all-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#cyclelogs-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cmddeny"></a>
<h4 class="subsubsection">4.3.4.14 cmddeny</h4>
<p>This is similar to the <code>deny</code> command, except that it is used to
allow particular hosts or subnets to use the chronyc program to interact
with <code>chronyd</code> on the current host.
</p><hr>
<a name="cyclelogs-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cmddeny-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#delete-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="cyclelogs"></a>
<h4 class="subsubsection">4.3.4.15 cyclelogs</h4>
<p>The <code>cyclelogs</code> command causes all of <code>chronyd's</code> open log files to
be closed and re-opened.  This allows them to be renamed so that they can be
periodically purged.  An example of how to do this is shown below.
</p>
<div class="example">
<pre class="example">% mv /var/log/chrony/measurements.log /var/log/chrony/measurements1.log
% chronyc -a cyclelogs
% ls -l /var/log/chrony
-rw-r--r--   1 root     root            0 Jun  8 18:17 measurements.log
-rw-r--r--   1 root     root        12345 Jun  8 18:17 measurements1.log
% rm -f measurements1.log
</pre></div>
<hr>
<a name="delete-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#cyclelogs-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#deny-all-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="delete"></a>
<h4 class="subsubsection">4.3.4.16 delete</h4>
<p>The <code>delete</code> command allows an NTP server or peer to be removed
from the current set of sources.
</p>
<p>The syntax is illustrated in the examples below.
</p>
<div class="example">
<pre class="example">delete foo.example.net
delete 1.2.3.4
delete 2001:db8::1
</pre></div>

<p>There is one parameter, the name or IP address of the server or peer to
be deleted.
</p><hr>
<a name="deny-all-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#delete-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#deny-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deny-all"></a>
<h4 class="subsubsection">4.3.4.17 deny all</h4>
<p>The effect of the allow command is identical to the <code>deny all</code>
directive in the configuration file (see section <a href="#deny-directive">deny</a>).
</p><hr>
<a name="deny-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deny-all-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#dns-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="deny-1"></a>
<h4 class="subsubsection">4.3.4.18 deny</h4>
<p>The effect of the allow command is identical to the <code>deny</code>
directive in the configuration file (see section <a href="#deny-directive">deny</a>).
</p>
<p>The syntax is illustrated in the following examples:
</p>
<div class="example">
<pre class="example">deny foo.example.net
deny 1.2
deny 3.4.5
deny 6.7.8/22
deny 6.7.8.9/22
deny 2001:db8:789a::/48
deny 0/0
deny ::/0
deny
</pre></div>
<hr>
<a name="dns-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#deny-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#dump-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dns"></a>
<h4 class="subsubsection">4.3.4.19 dns</h4>
<p>The <code>dns</code> command configures how are hostnames and IP addresses resolved in
<code>chronyc</code>.  IP addresses can be resolved to hostnames when printing results
of <code>sources</code>, <code>sourcestats</code>, <code>tracking</code> and <code>clients</code>
commands.  Hostnames are resolved in commands that take an address as argument.
</p>
<p>There are five forms of the command:
</p>
<dl compact="compact">
<dt><code>dns -n</code></dt>
<dd><p>Disables resolving IP addresses to hostnames.  Raw IP addresses will be
displayed.
</p></dd>
<dt><code>dns +n</code></dt>
<dd><p>Enables resolving IP addresses to hostnames.  This is the default unless
<code>chronyc</code> was started with <code>-n</code> option.
</p></dd>
<dt><code>dns -4</code></dt>
<dd><p>Resolves hostnames only to IPv4 addresses.
</p></dd>
<dt><code>dns -6</code></dt>
<dd><p>Resolves hostnames only to IPv6 addresses.
</p></dd>
<dt><code>dns -46</code></dt>
<dd><p>Resolves hostnames to both address families.  This is the default unless
<code>chronyc</code> was started with <code>-4</code> or <code>-6</code> option.
</p></dd>
</dl>
<hr>
<a name="dump-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dns-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#exit-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="dump"></a>
<h4 class="subsubsection">4.3.4.20 dump</h4>
<p>The <code>dump</code> command causes <code>chronyd</code> to write its current history of
measurements for each of its sources to dump files, either for
inspection or to support the <code>-r</code> option when <code>chronyd</code> is restarted.
</p>
<p>The <code>dump</code> command is somewhat equivalent to the <code>dumponexit</code>
directive in the chrony configuration file.  See section <a href="#dumponexit-directive">dumponexit</a>.
</p>
<p>To use the <code>dump</code>, you probably want to configure the name of the
directory into which the dump files will be written.  This can only be
done in the configuration file, see <a href="#dumpdir-directive">dumpdir</a>.
</p><hr>
<a name="exit-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#dump-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#help-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="exit"></a>
<h4 class="subsubsection">4.3.4.21 exit</h4>
<p>The exit command exits from chronyc and returns the user to the shell
(same as the quit command).
</p><hr>
<a name="help-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#exit-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#local-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="help"></a>
<h4 class="subsubsection">4.3.4.22 help</h4>
<p>The help command displays a summary of the commands and their arguments.
</p><hr>
<a name="local-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#help-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#makestep-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="local"></a>
<h4 class="subsubsection">4.3.4.23 local</h4>
<p>The <code>local</code> command allows <code>chronyd</code> to be told that it is to appear
as a reference source, even if it is not itself properly synchronised to
an external source.  (This can be used on isolated networks, to allow
one computer to be a master time server with the other computers slaving
to it.)  The <code>local</code> command is somewhat equivalent to the
<code>local</code> directive in the configuration file, see <a href="#local-directive">local</a>.
</p>
<p>The syntax is as shown in the following examples.
</p>
<div class="example">
<pre class="example">local stratum 10
local off
</pre></div>

<p>The first example enables the local reference mode on the host, and sets
the stratum at which it should claim to be synchronised.
</p>
<p>The second example disables the local reference mode.
</p><hr>
<a name="makestep-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#local-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#manual-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="makestep"></a>
<h4 class="subsubsection">4.3.4.24 makestep</h4>
<p>Normally chronyd will cause the system to gradually correct any time
offset, by slowing down or speeding up the clock as required.  In
certain situations, the system clock may be so far adrift that this
slewing process would take a very long time to correct the system clock.
</p>
<p>The <code>makestep</code> command can be used in this situation.  There are two forms
of the command.  The first form has no parameters.  It tells <code>chronyd</code> to
cancel any remaining correction that was being slewed and jump the system clock
by the equivalent amount, making it correct immediately.
</p>
<p>The second form configures the automatic stepping, similarly to the
<code>makestep</code> directive (see section <a href="#makestep-directive">makestep</a>).  It has two parameters,
stepping threshold (in seconds) and number of future clock updates for which
will be the threshold active.  This can be used with the <code>burst</code> command
to quickly make a new measurement and correct the clock by stepping if needed,
without waiting for <code>chronyd</code> to complete the measurement and update the
clock.
</p>
<div class="example">
<pre class="example">makestep 0.1 1
burst 1/2
</pre></div>

<p>BE WARNED - certain software will be seriously affected by such jumps to
the system time.  (That is the reason why chronyd uses slewing
normally.)
</p><hr>
<a name="manual-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#makestep-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxdelay-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="manual"></a>
<h4 class="subsubsection">4.3.4.25 manual</h4>
<p>The manual command enables and disables use of the <code>settime</code>
command (see section <a href="#settime-command">settime</a>), and is used to modify the behaviour
of the manual clock driver.
</p>
<p>Examples of the command are shown below.
</p>
<div class="example">
<pre class="example">manual on
manual off
manual delete 1
manual list
manual reset
</pre></div>

<p>The <code>on</code> form of the command enables use of the <code>settime</code>
command.
</p>
<p>The <code>off</code> form of the command disables use of the <code>settime</code>
command.
</p>
<p>The <code>list</code> form of the command lists all the samples currently
stored in <code>chronyd</code>.  The output is illustrated below.
</p>
<div class="example">
<pre class="example">210 n_samples = 1
#    Date  Time(UTC)    Slewed   Original   Residual
====================================================
 0 27Jan99 22:09:20       0.00       0.97       0.00
</pre></div>

<p>The columns as as follows :
</p>
<ol>
<li>
The sample index (used for the <code>manual delete</code> command)
</li><li>
The date and time of the sample
</li><li>
The system clock error when the timestamp was entered, adjusted to allow
for changes made to the system clock since.
</li><li>
The system clock error when the timestamp was entered, as it originally
was (without allowing for changes to the system clock since).
</li><li>
The regression residual at this point, in seconds.  This allows
&rsquo;outliers&rsquo; to be easily spotted, so that they can be deleted using the
<code>manual delete</code> command.
</li></ol>

<p>The <code>delete</code> form of the command deletes a single sample.  The
parameter is the index of the sample, as shown in the first column of
the output from <code>manual list</code>.  Following deletion of the data
point, the current error and drift rate are re-estimated from the
remaining data points and the system clock trimmed if necessary.  This
option is intended to allow &rsquo;outliers&rsquo; to be discarded, i.e. samples
where the administrator realises he/she has entered a very poor
timestamp.
</p>
<p>The <code>reset</code> form of the command deletes all samples at once.  The
system clock is left running as it was before the command was entered.
</p><hr>
<a name="maxdelay-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#manual-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxdelaydevratio-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxdelay"></a>
<h4 class="subsubsection">4.3.4.26 maxdelay</h4>
<p>This allows the <code>maxdelay</code> option for one of the sources to be
modified, in the same way as specifying the <code>maxdelay</code> option for
the <code>server</code> directive in the configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The following examples illustrate the syntax
</p>
<div class="example">
<pre class="example">maxdelay foo.example.net 0.3
maxdelay 1.2.3.4 0.0015
maxdelay 2001:db8::1 0.0015
</pre></div>

<p>The first example sets the maximum network delay allowed for a
measurement to the host <code>foo.example.net</code> to 0.3 seconds.  The second
and third examples set the maximum network delay for a measurement to
the host with IPv4 address <code>1.2.3.4</code> and the host with IPv6 address
<code>2001:db8::1</code> to 1.5 milliseconds.
</p>
<p>(Any measurement whose network delay exceeds the specified value is
discarded.)
</p><hr>
<a name="maxdelaydevratio-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxdelay-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxdelayratio-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxdelaydevratio"></a>
<h4 class="subsubsection">4.3.4.27 maxdelaydevratio</h4>
<p>This allows the <code>maxdelaydevratio</code> option for one of the sources to be
modified, in the same way as specifying the <code>maxdelaydevratio</code> option
for the <code>server</code> directive in the configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The following examples illustrate the syntax
</p>
<div class="example">
<pre class="example">maxdelaydevratio foo.example.net 0.1
maxdelaydevratio 1.2.3.4 1.0
maxdelaydevratio 2001:db8::1 100.0
</pre></div>
<hr>
<a name="maxdelayratio-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxdelaydevratio-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxpoll-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxdelayratio"></a>
<h4 class="subsubsection">4.3.4.28 maxdelayratio</h4>
<p>This allows the <code>maxdelayratio</code> option for one of the sources to be
modified, in the same way as specifying the <code>maxdelayratio</code> option
for the <code>server</code> directive in the configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The following examples illustrate the syntax
</p>
<div class="example">
<pre class="example">maxdelayratio foo.example.net 1.5
maxdelayratio 1.2.3.4 2.0
maxdelayratio 2001:db8::1 2.0
</pre></div>

<p>The first example sets the maximum network delay for a measurement to
the host <code>foo.example.net</code> to be 1.5 times the minimum delay found
amongst the previous measurements that have been retained.  The second
and third examples set the maximum network delay for a measurement to
the host with IPv4 address <code>1.2.3.4</code> and the host with IPv6
address <code>2001:db8::1</code> to be double the retained minimum.
</p>
<p>As for <code>maxdelay</code>, any measurement whose network delay is too large
will be discarded.
</p><hr>
<a name="maxpoll-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxdelayratio-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#maxupdateskew-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxpoll"></a>
<h4 class="subsubsection">4.3.4.29 maxpoll</h4>
<p>The <code>maxpoll</code> command is used to modify the minimum polling
interval for one of the current set of sources.  It is equivalent to the
<code>maxpoll</code> option in the <code>server</code> directive in the
configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The syntax is as follows
</p>
<div class="example">
<pre class="example">maxpoll &lt;host&gt; &lt;new-maxpoll&gt;
</pre></div>

<p>where the host can be specified as either a machine name or 
IP address.  The new minimum poll is specified as a base-2 logarithm of
the number of seconds between polls (e.g. specify 6 for 64 second
sampling).
</p>
<p>An example is 
</p>
<div class="example">
<pre class="example">maxpoll foo.example.net 10
</pre></div>

<p>which sets the maximum polling interval for the host <code>foo.example.net</code>
to 1024 seconds.
</p>
<p>Note that the new maximum polling interval only takes effect after the
next measurement has been made.
</p><hr>
<a name="maxupdateskew-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxpoll-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#minpoll-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="maxupdateskew"></a>
<h4 class="subsubsection">4.3.4.30 maxupdateskew</h4>
<p>This command has the same effect as the <code>maxupdateskew</code> directive
in the configuration file, see <a href="#maxupdateskew-directive">maxupdateskew</a>.
</p><hr>
<a name="minpoll-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#maxupdateskew-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#minstratum-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="minpoll"></a>
<h4 class="subsubsection">4.3.4.31 minpoll</h4>
<p>The <code>minpoll</code> command is used to modify the minimum polling
interval for one of the current set of sources.  It is equivalent to the
<code>minpoll</code> option in the <code>server</code> directive in the
configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The syntax is as follows
</p>
<div class="example">
<pre class="example">minpoll &lt;host&gt; &lt;new-minpoll&gt;
</pre></div>

<p>where the host can be specified as either a machine name or
IP address.  The new minimum poll is specified as a base-2 logarithm of
the number of seconds between polls (e.g. specify 6 for 64 second
sampling).
</p>
<p>An example is 
</p>
<div class="example">
<pre class="example">minpoll foo.example.net 5
</pre></div>

<p>which sets the minimum polling interval for the host <code>foo.example.net</code>
to 32 seconds.
</p>
<p>Note that the new minimum polling interval only takes effect after the
next measurement has been made.
</p><hr>
<a name="minstratum-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#minpoll-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#offline-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="minstratum"></a>
<h4 class="subsubsection">4.3.4.32 minstratum</h4>
<p>The <code>minstratum</code> command is used to modify the minimum stratum
for one of the current set of sources.  It is equivalent to the
<code>minstratum</code> option in the <code>server</code> directive in the
configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The syntax is as follows
</p>
<div class="example">
<pre class="example">minstratum &lt;host&gt; &lt;new-min-stratum&gt;
</pre></div>

<p>where the host can be specified as either a machine name or
IP address.
</p>
<p>An example is 
</p>
<div class="example">
<pre class="example">minpoll foo.example.net 5
</pre></div>

<p>which sets the minimum stratum for the host <code>foo.example.net</code>
to 5.
</p>
<p>Note that the new minimum stratum only takes effect after the
next measurement has been made.
</p><hr>
<a name="offline-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#minstratum-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#online-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="offline"></a>
<h4 class="subsubsection">4.3.4.33 offline</h4>
<p>The <code>offline</code> command is used to warn <code>chronyd</code> that the network
connection to a particular host or hosts is about to be lost.  It should
be used on computers with a dial-up or similar connection to their time
sources, to warn <code>chronyd</code> that the connection is about to be broken.
</p>
<p>An example of how to use <code>offline</code> in this case is shown in
<a href="#Advising-chronyd-of-internet-availability">How to tell chronyd when the internet link is available.</a>.
</p>
<p>Another case where <code>offline</code> could be used is where a computer
serves time to a local group of computers, and has a permanant
connection to true time servers outside the organisation.  However, the
external connection is heavily loaded at certain times of the day and
the measurements obtained are less reliable at those times.  In this
case, it is probably most useful to determine the gain/loss rate during
the quiet periods and let the whole network coast through the loaded
periods.  The <code>offline</code> and <code>online</code> commands can be used to
achieve this.  The situation is shown in the figure below.
</p>
<div class="example">
<pre class="example">          +----------+
          |Ext source|
          +----------+
              |
              |
              |/| &lt;-- Link with variable
                |     reliability
                |
      +-------------------+
      |Local master server|
      +-------------------+
                |
  +---+---+-----+-----+----+----+
  |   |   |     |     |    |    |
           Local clients
</pre></div>



<p>If the source to which <code>chronyd</code> is currently synchronised is indicated
offline in this way, <code>chronyd</code> will continue to treat it as the
synchronisation source.  If the network connection were broken without
the <code>offline</code> command being used, <code>chronyd</code> would assume that the
source had failed and would attempt to pick another synchronisation
source.
</p>
<p>There are four forms of the <code>offline</code> command.  The first form is a
wildcard, meaning all sources.  The second form allows an IP address mask
and a masked address to be specified.  The third form uses the CIDR
notation.  The fourth form uses an IP address or a hostname.  These forms are
illustrated below.
</p>
<div class="example">
<pre class="example">offline
offline 255.255.255.0/1.2.3.0
offline 2001:db8:789a::/48
offline foo.example.net
</pre></div>

<p>The second form means that the <code>offline</code> command is to be applied
to any source whose IPv4 address is in the <code>1.2.3</code> subnet.  (The host&rsquo;s
address is logically and-ed with the mask, and if the result matches the
masked-address the host is processed).  The third form means that the
command is to be applied to all sources whose IPv6 addresses have first
48 bits equal to <code>2001:db8:789a</code>.  The fourth form means that the command
is to be applied only to that one source.
</p>
<p>The wildcard form of the address is actually equivalent to
</p>
<div class="example">
<pre class="example">offline 0.0.0.0/0.0.0.0
offline ::/0
</pre></div>
<hr>
<a name="online-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#offline-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#password-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="online"></a>
<h4 class="subsubsection">4.3.4.34 online</h4>
<p>The <code>online</code> command is opposite in function to the <code>offline</code>
command.  It is used to advise <code>chronyd</code> that network connectivity to a
particular source or sources has been restored.
</p>
<p>The syntax is identical to that of the <code>offline</code> command, see
<a href="#offline-command">offline</a>.
</p><hr>
<a name="password-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#online-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#polltarget-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="password"></a>
<h4 class="subsubsection">4.3.4.35 password</h4>
<p>The password command is used to allow chronyc to send privileged
commands to <code>chronyd</code>.  The password can either be entered on the command
line, or can be entered without echoing.  The syntax for entering the
password on the command line is as follows
</p>
<div class="example">
<pre class="example">password xyzzy
password ASCII:xyzzy
password HEX:78797a7a79
</pre></div>

<p>To enter the password without it being echoed, enter
</p>
<div class="example">
<pre class="example">password
</pre></div>

<p>The computer will respond with a &lsquo;<samp>Password:</samp>&rsquo; prompt, at which you
should enter the password and press return.
</p>
<p>The password can be encoded as a string of characters not containing a space
with optional <code>ASCII:</code> prefix or as a hexadecimal number with <code>HEX:</code>
prefix.  It has to match <code>chronyd's</code> currently defined command key
(see section <a href="#commandkey-directive">commandkey</a>).  If the command key was specified with a
different hash function than MD5, it&rsquo;s necessary to select the hash function
with the <code>authhash</code> command (see section <a href="#authhash-command">authhash</a>) before entering the
password.
</p>
<p>The password command is run automatically on start if <code>chronyc</code> was
started with the &lsquo;-a&rsquo; option.
</p><hr>
<a name="polltarget-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#password-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#quit-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="polltarget"></a>
<h4 class="subsubsection">4.3.4.36 polltarget</h4>
<p>The <code>polltarget</code> command is used to modify the poll target for
one of the current set of sources.  It is equivalent to the
<code>polltarget</code> option in the <code>server</code> directive in the
configuration file (see section <a href="#server-directive">server</a>).
</p>
<p>The syntax is as follows
</p>
<div class="example">
<pre class="example">polltarget &lt;host&gt; &lt;new-poll-target&gt;
</pre></div>

<p>where the host can be specified as either a machine name or
IP address.
</p>
<p>An example is 
</p>
<div class="example">
<pre class="example">polltarget foo.example.net 12
</pre></div>

<p>which sets the poll target for the host <code>foo.example.net</code>
to 12.
</p><hr>
<a name="quit-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#polltarget-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#reselect-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="quit"></a>
<h4 class="subsubsection">4.3.4.37 quit</h4>
<p>The quit command exits from chronyc and returns the user to the shell
(same as the exit command).
</p><hr>
<a name="reselect-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#quit-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#reselectdist-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="reselect"></a>
<h4 class="subsubsection">4.3.4.38 reselect</h4>
<p>To avoid excessive switching between sources, <code>chronyd</code> may stay
synchronised to a source even when it is not currently the best one among the
available sources.
</p>
<p>The <code>reselect</code> command can be used to force <code>chronyd</code> to
reselect the best synchronisation source.
</p><hr>
<a name="reselectdist-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#reselect-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#retries-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="reselectdist-1"></a>
<h4 class="subsubsection">4.3.4.39 reselectdist</h4>
<p>The <code>reselectdist</code> command sets the reselect distance.  It is equivalent
to the <code>reselectdist</code> directive in the configuration file
(see section <a href="#reselectdist-directive">reselectdist</a>).
</p><hr>
<a name="retries-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#reselectdist-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#rtcdata-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="retries"></a>
<h4 class="subsubsection">4.3.4.40 retries</h4>
<p>The <code>retries</code> command sets the maximum number of retries for
<code>chronyc</code> requests before giving up.  The response timeout is controlled
by <code>timeout</code> command (see section <a href="#timeout-command">timeout</a>).
</p>
<p>The default is 2.
</p><hr>
<a name="rtcdata-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#retries-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#settime-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="rtcdata"></a>
<h4 class="subsubsection">4.3.4.41 rtcdata</h4>
<p>The <code>rtcdata</code> command displays the current real time clock RTC parameters.
</p>
<p>An example output is shown below.
</p>
<div class="example">
<pre class="example">RTC ref time (GMT) : Sat May 30 07:25:56 1998
Number of samples  : 10
Number of runs     : 5
Sample span period :  549
RTC is fast by     :    -1.632736 seconds
RTC gains time at  :  -107.623 ppm
</pre></div>

<p>The fields have the following meaning
</p>
<dl compact="compact">
<dt><code>RTC ref time (GMT)</code></dt>
<dd><p>This is the RTC reading the last time its error was measured.
</p></dd>
<dt><code>Number of samples</code></dt>
<dd><p>This is the number of previous measurements being used to determine the
RTC gain/loss rate.
</p></dd>
<dt><code>Number of runs</code></dt>
<dd><p>This is the number of runs of residuals of the same sign following the
regression fit for (RTC error) versus (RTC time).  A value which is
small indicates that the measurements are not well approximated by a
linear model, and that the algorithm will tend to delete the older
measurements to improve the fit.
</p></dd>
<dt><code>Sample span period</code></dt>
<dd><p>This is the period that the measurements span (from the oldest to the
newest).  Without a unit the value is in seconds; suffixes &lsquo;m&rsquo; for
minutes, &lsquo;h&rsquo; for hours, &lsquo;d&rsquo; for days or &lsquo;y&rsquo; for years may be used.
</p></dd>
<dt><code>RTC is fast by</code></dt>
<dd><p>This is the estimate of how many seconds fast the RTC when it thought
the time was at the reference time (above).  If this value is large, you
may (or may not) want to use the <code>trimrtc</code> command to bring the RTC
into line with the system clock.  (Note, a large error will not affect
<code>chronyd's</code> operation, unless it becomes so big as to start causing
rounding errors.
</p></dd>
<dt><code>RTC gains time at</code></dt>
<dd><p>This is the amount of time gained (positive) or lost (negative) by the
real time clock for each second that it ticks.  It is measured in parts
per million.  So if the value shown was +1, suppose the RTC was exactly
right when it crosses a particular second boundary.  Then it would be 1
microsecond fast when it crosses its next second boundary.
</p></dd>
</dl>
<hr>
<a name="settime-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#rtcdata-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#smoothing-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="settime"></a>
<h4 class="subsubsection">4.3.4.42 settime</h4>
<p>The <code>settime</code> command allows the current time to be entered
manually, if this option has been configured into <code>chronyd</code>.  (It may be
configured either with the <code>manual</code> directive in the configuration
file (see section <a href="#manual-directive">manual</a>), or with the <code>manual</code> command of
chronyc (see section <a href="#manual-command">manual</a>).
</p>
<p>It should be noted that the computer&rsquo;s sense of time will only be as
accurate as the reference you use for providing this input (e.g. your
watch), as well as how well you can time the press of the return key.
</p>
<p>Providing your computer&rsquo;s time zone is set up properly, you will be able
to enter a local time (rather than UTC).
</p>
<p>The response to a successful <code>settime</code> command indicates the amount
that the computer&rsquo;s clock was wrong.  It should be apparent from this if
you have entered the time wrongly, e.g. with the wrong time zone.
</p>
<p>The rate of drift of the system clock is estimated by a regression
process using the entered measurement and all previous measurements
entered during the present run of <code>chronyd</code>.  However, the entered
measurement is used for adjusting the current clock offset (rather than
the estimated intercept from the regression, which is ignored).
Contrast what happens with the <code>manual delete</code> command, where the
intercept is used to set the current offset (since there is no
measurement that has just been typed in in that case).
</p>
<p>The time is parsed by the public domain &lsquo;<tt>getdate</tt>&rsquo; algorithm.
Consequently, you can only specify time to the nearest second.
</p>
<p>Examples of inputs that are valid are shown below.
</p>
<div class="example">
<pre class="example">settime 16:30
settime 16:30:05
settime Nov 21, 1997 16:30:05
</pre></div>

<p>For a full description of <code>getdate</code>, get hold of the getdate
documentation (bundled, for example, with the source for GNU tar).
</p><hr>
<a name="smoothing-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#settime-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#smoothtime-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="smoothing"></a>
<h4 class="subsubsection">4.3.4.43 smoothing</h4>
<p>The <code>smoothing</code> command displays the current state of the NTP server time
smoothing. An example of the output is shown below.
</p>
<div class="example">
<pre class="example">Active         : Yes
Offset         : +1.000268817 seconds
Frequency      : -0.142859 ppm
Wander         : -0.010000 ppm per second
Last update    : 17.8 seconds ago
Remaining time : 19988.4 seconds
</pre></div>

<p>The fields are explained as follows.
</p>
<dl compact="compact">
<dt><code>Active</code></dt>
<dd><p>This shows if the server time smoothing is currently active.  Possible values
are <code>Yes</code> and <code>No</code>.  If the <code>leaponly</code> option is included in the
<code>smoothtime</code> directive, <code>(leap second only)</code> will be shown on the
line.
</p>
</dd>
<dt><code>Offset</code></dt>
<dd><p>This is the current offset applied to the time sent to NTP clients.  Positive
value means the clients are getting time that&rsquo;s ahead of true time.
</p>
</dd>
<dt><code>Frequency</code></dt>
<dd><p>The current frequency offset of the served time.  Negative value means the time
observed by clients is running slower than true time.
</p>
</dd>
<dt><code>Wander</code></dt>
<dd><p>The current frequency wander of the served time.  Negative value means the time
observed by clients is slowing down.
</p>
</dd>
<dt><code>Last update</code></dt>
<dd><p>This field shows how long ago was the time smoothing process updated, e.g.
<code>chronyd</code> accumulated a new measurement.
</p>
</dd>
<dt><code>Remaining time</code></dt>
<dd><p>The time it would take for the smoothing process to get to zero offset and
frequency if there were no more updates.
</p></dd>
</dl>
<hr>
<a name="smoothtime-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#smoothing-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#sources-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="smoothtime-1"></a>
<h4 class="subsubsection">4.3.4.44 smoothtime</h4>
<p>The <code>smoothtime</code> command can be used to reset or activate the server time
smoothing process if it is configured with the <code>smoothtime</code> directive
(see section <a href="#smoothtime-directive">smoothtime</a>).
</p>
<p>The syntax is as follows
</p>
<div class="example">
<pre class="example">smoothtime reset
smoothtime activate
</pre></div>

<hr>
<a name="sources-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#smoothtime-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#sourcestats-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="sources"></a>
<h4 class="subsubsection">4.3.4.45 sources</h4>
<p>This command displays information about the current time sources that
<code>chronyd</code> is accessing.
</p>
<p>The optional argument <code>-v</code> can be specified, meaning <em>verbose</em>.  In
this case, extra caption lines are shown as a reminder of the meanings of the
columns.
</p>
<div class="example">
<pre class="example">210 Number of sources = 3
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
#* GPS0                          0   4   377    11   -479ns[ -621ns] +/-  134ns
^? foo.example.net               2   6   377    23   -923us[ -924us] +/-   43ms
^+ bar.example.net               1   6   377    21  -2629us[-2619us] +/-   86ms
</pre></div>

<p>The columns are as follows:
</p>
<dl compact="compact">
<dt><code>M</code></dt>
<dd><p>This indicates the mode of the source.  <code>^</code> means a server,
<code>=</code> means a peer and <code>#</code> indicates a locally connected
reference clock.
</p>
</dd>
<dt><code>S</code></dt>
<dd><p>This column indicates the state of the sources.  <code>*</code> indicates the
source to which <code>chronyd</code> is currently synchronised.  <code>+</code>
indicates acceptable sources which are combined with the selected
source.  <code>-</code> indicates acceptable sources which are excluded by
the combining algorithm.  <code>?</code> indicates sources to which
connectivity has been lost or whose packets don&rsquo;t pass all tests.
<code>x</code> indicates a clock which <code>chronyd</code>
thinks is is a falseticker (i.e. its time is inconsistent with a
majority of other sources).  <code>~</code> indicates a source whose time
appears to have too much variability.  The <code>?</code> condition is also
shown at start-up, until at least 3 samples have been gathered from it.
</p>
</dd>
<dt><code>Name/IP address</code></dt>
<dd><p>This shows the name or the IP address of the source, or refid for
reference clocks.
</p>
</dd>
<dt><code>Stratum</code></dt>
<dd><p>This shows the stratum of the source, as reported in its most recently
received sample.  Stratum 1 indicates a computer with a locally attached
reference clock.  A computer that is synchronised to a stratum 1
computer is at stratum 2.  A computer that is synchronised to a stratum
2 computer is at stratum 3, and so on.
</p>
</dd>
<dt><code>Poll</code></dt>
<dd><p>This shows the rate at which the source is being polled, as a base-2
logarithm of the interval in seconds.  Thus, a value of 6 would indicate
that a measurement is being made every 64 seconds.
</p>
<p><code>chronyd</code> automatically varies the polling rate in response to prevailing
conditions.
</p>
</dd>
<dt><code>Reach</code></dt>
<dd><p>This shows the source&rsquo;s reachability register printed as octal number.  The
register has 8 bits and is updated on every received or missed packet from
the source.  A value of 377 indicates that a valid reply was received for all
from the last eight transmissions.
</p>
</dd>
<dt><code>LastRx</code></dt>
<dd><p>This column shows how long ago the last sample was received from the
source.  This is normally in seconds.  The letters <code>m</code>, <code>h</code>,
<code>d</code> or <code>y</code> indicate minutes, hours, days or years.  A value
of 10 years indicates there were no samples received from this source
yet.
</p>
</dd>
<dt><code>Last sample</code></dt>
<dd><p>This column shows the offset between the local clock and the source at
the last measurement.  The number in the square brackets shows the
actual measured offset.  This may be suffixed by <code>ns</code> (indicating
nanoseconds), <code>us</code> (indicating
microseconds), <code>ms</code> (indicating milliseconds), or <code>s</code>
(indicating seconds).  The number to the left of the square brackets
shows the original measurement, adjusted to allow for any slews applied
to the local clock since.  The number following the <code>+/-</code> indicator
shows the margin of error in the measurement.
</p>
<p>Positive offsets indicate that the local clock is fast of the source.
</p>
</dd>
</dl>
<hr>
<a name="sourcestats-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#sources-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#timeout-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="sourcestats"></a>
<h4 class="subsubsection">4.3.4.46 sourcestats</h4>

<p>The <code>sourcestats</code> command displays information about the drift rate
and offset estimatation process for each of the sources currently being
examined by <code>chronyd</code>.
</p>
<p>The optional argument <code>-v</code> can be specified, meaning <em>verbose</em>.  In
this case, extra caption lines are shown as a reminder of the meanings of the
columns.
</p>
<p>An example report is
</p>
<div class="example">
<pre class="example">210 Number of sources = 1
Name/IP Address            NP  NR  Span  Frequency  Freq Skew  Offset  Std Dev
===============================================================================
abc.def.ghi                11   5   46m     -0.001      0.045      1us    25us
</pre></div>

<p>The columns are as follows
</p>
<dl compact="compact">
<dt><code>Name/IP Address</code></dt>
<dd><p>This is the name or IP address of the NTP server (or peer) or refid of
the refclock to which the rest of the line relates.
</p>
</dd>
<dt><code>NP</code></dt>
<dd><p>This is the number of sample points currently being retained for the
server.  The drift rate and current offset are estimated by performing a
linear regression through these points.
</p>
</dd>
<dt><code>NR</code></dt>
<dd><p>This is the number of runs of residuals having the same sign following
the last regression.  If this number starts to become too small relative
to the number of samples, it indicates that a straight line is no longer
a good fit to the data.  If the number of runs is too low,
<code>chronyd</code> discards older samples and re-runs the regression until
the number of runs becomes acceptable.
</p>
</dd>
<dt><code>Span</code></dt>
<dd><p>This is the interval between the oldest and newest samples.  If no unit
is shown the value is in seconds.  In the example, the interval is 46
minutes.
</p>
</dd>
<dt><code>Frequency</code></dt>
<dd><p>This is the estimated residual frequency for the server, in parts per
million.  In this case, the computer&rsquo;s clock is estimated to be running
1 part in 10**9 slow relative to the server.
</p>
</dd>
<dt><code>Freq Skew</code></dt>
<dd><p>This is the estimated error bounds on <code>Freq</code> (again in parts per
million).
</p>
</dd>
<dt><code>Offset</code></dt>
<dd><p>This is the estimated offset of the source.
</p>
</dd>
<dt><code>Std Dev</code></dt>
<dd><p>This is the estimated sample standard deviation.
</p>
</dd>
</dl>
<hr>
<a name="timeout-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#sourcestats-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#tracking-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="timeout"></a>
<h4 class="subsubsection">4.3.4.47 timeout</h4>
<p>The <code>timeout</code> command sets the initial timeout for <code>chronyc</code> requests
in milliseconds.  If no response is received from <code>chronyd</code>, the timeout is
doubled and the request is resent.  The maximum number of retries is configured
with the <code>retries</code> command (see section <a href="#retries-command">retries</a>).
</p>
<p>By default, the timeout is 1000 milliseconds or 100 milliseconds if
<code>chronyc</code> is contacting localhost (i.e. the &lsquo;-h&rsquo; option wasn&rsquo;t specified)
and <code>chronyd</code> was compiled with asynchronous name resolving.
</p><hr>
<a name="tracking-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#timeout-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#trimrtc-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="tracking"></a>
<h4 class="subsubsection">4.3.4.48 tracking</h4>
<p>The <code>tracking</code> command displays parameters about the system&rsquo;s clock
performance.  An example of the output is shown below.
</p>
<div class="example">
<pre class="example">Reference ID    : 1.2.3.4 (foo.example.net)
Stratum         : 3
Ref time (UTC)  : Fri Feb  3 15:00:29 2012
System time     : 0.000001501 seconds slow of NTP time
Last offset     : -0.000001632 seconds
RMS offset      : 0.000002360 seconds
Frequency       : 331.898 ppm fast
Residual freq   : 0.004 ppm
Skew            : 0.154 ppm
Root delay      : 0.373169 seconds
Root dispersion : 0.024780 seconds
Update interval : 64.2 seconds
Leap status     : Normal

</pre></div>

<p>The fields are explained as follows.
</p>
<dl compact="compact">
<dt><code>Reference ID</code></dt>
<dd><p>This is the refid and name (or IP address) if available, of the server to which
the computer is currently synchronised.  If this is <code>127.127.1.1</code>
it means the computer is not synchronised to any external source and
that you have the &lsquo;local&rsquo; mode operating (via the <code>local</code> command
in <code>chronyc</code> (see section <a href="#local-command">local</a>), or the <code>local</code> directive
in the &lsquo;<tt>/etc/chrony.conf</tt>&rsquo; file (see section <a href="#local-directive">local</a>)).
</p>
</dd>
<dt><code>Stratum</code></dt>
<dd><p>The stratum indicates how many hops away from a computer with an
attached reference clock we are.  Such a computer is a stratum-1
computer, so the computer in the example is two hops away
(i.e. <code>foo.example.net</code> is a stratum-2 and is synchronised from a stratum-1).
</p>
</dd>
<dt><code>Ref time</code></dt>
<dd><p>This is the time (UTC) at which the last measurement from the reference
source was processed.
</p>
</dd>
<dt><code>System time</code></dt>
<dd><p>In normal operation, <code>chronyd</code> <em>never</em> steps the system clock,
because any jump in the timescale can have adverse consequences for
certain application programs.  Instead, any error in the system clock is
corrected by slightly speeding up or slowing down the system clock until
the error has been removed, and then returning to the system clock&rsquo;s
normal speed.  A consequence of this is that there will be a period when
the system clock (as read by other programs using the
<code>gettimeofday()</code> system call, or by the <code>date</code> command in the
shell) will be different from <code>chronyd's</code> estimate of the current
true time (which it reports to NTP clients when it is operating in
server mode).  The value reported on this line is the difference due to
this effect.
</p>
<p>On systems other than Linux, <code>chronyd</code> doesn&rsquo;t
adjust the fundamental rate of the system clock, so keeps the system
time correct by periodically making offsets to it as though an error had
been measured.  The build up of these offsets will be observed in this
report.
</p>
</dd>
<dt><code>Last offset</code></dt>
<dd><p>This is the estimated local offset on the last clock update.
</p>
</dd>
<dt><code>RMS offset</code></dt>
<dd><p>This is a long-term average of the offset value.
</p>
</dd>
<dt><code>Frequency</code></dt>
<dd><p>The &lsquo;frequency&rsquo; is the rate by which the system&rsquo;s clock would be would
be wrong if <code>chronyd</code> was not correcting it.  It is expressed in
ppm (parts per million).  For example, a value of 1ppm would mean that
when the system&rsquo;s clock thinks it has advanced 1 second, it has actually
advanced by 1.000001 seconds relative to true time.
</p>
<p>As you can see in the example, the clock in the computer is not a very
good one - it gains about 30 seconds per day!
</p> 
</dd>
<dt><code>Residual freq</code></dt>
<dd><p>This shows the &lsquo;residual frequency&rsquo; for the currently selected reference
source.  This reflects any difference between what the measurements from
the reference source indicate the frequency should be and the frequency
currently being used.
</p>
<p>The reason this is not always zero is that a smoothing procedure is
applied to the frequency.  Each time a measurement from the reference
source is obtained and a new residual frequency computed, the estimated
accuracy of this residual is compared with the estimated accuracy (see
&lsquo;skew&rsquo; next) of the existing frequency value.  A weighted average is
computed for the new frequency, with weights depending on these
accuracies.  If the measurements from the reference source follow a
consistent trend, the residual will be driven to zero over time.
</p>
</dd>
<dt><code>Skew</code></dt>
<dd><p>This is the estimated error bound on the the frequency.
</p>
</dd>
<dt><code>Root delay</code></dt>
<dd><p>This is the total of the network path delays to the stratum-1 computer
from which the computer is ultimately synchronised.
</p>
</dd>
<dt><code>Root dispersion</code></dt>
<dd><p>This is the total dispersion accumulated through all the computers back
to the stratum-1 computer from which the computer is ultimately
synchronised.  Dispersion is due to system clock resolution, statistical
measurement variations etc.
</p>
<p>An absolute bound on the computer&rsquo;s clock accuracy (assuming the
stratum-1 computer is correct) is given by 
</p>
<div class="example">
<pre class="example">clock_error &lt;= root_dispersion + (0.5 * |root_delay|)
</pre></div>

</dd>
<dt><code>Update interval</code></dt>
<dd><p>This is the interval between the last two clock updates.
</p>
</dd>
<dt><code>Leap status</code></dt>
<dd><p>This is the leap status, which can be <code>Normal</code>, <code>Insert second</code>,
<code>Delete second</code> or <code>Not synchronised</code>.
</p>
</dd>
</dl>
<hr>
<a name="trimrtc-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#tracking-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#waitsync-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="trimrtc"></a>
<h4 class="subsubsection">4.3.4.49 trimrtc</h4>
<p>The <code>trimrtc</code> command is used to correct the system&rsquo;s real time
clock (RTC) to the main system clock.  It has no effect if the error
between the two clocks is currently estimated at less than a second (the
resolution of the RTC is only 1 second).
</p>
<p>The command takes no arguments.  It performs the following steps (if the
RTC is more than 1 second away from the system clock):
</p>
<ol>
<li>
Remember the currently estimated gain/loss rate of the RTC and flush the
previous measurements.
</li><li>
Step the real time clock to bring it within a second of the system clock.
</li><li>
Make several measurements to accurately determine the new offset between
the RTC and the system clock (i.e. the remaining fraction of a second
error)
</li><li>
Save the RTC parameters to the RTC file (specified with the
<code>rtcfile</code> directive in the configuration file (see section <a href="#rtcfile-directive">rtcfile</a>).
</li></ol>

<p>The last step is done as a precaution against the computer suffering a
power failure before either the daemon exits or the <code>writertc</code>
command is issued.
</p>
<p><code>chronyd</code> will still work perfectly well both whilst operating and
across machine reboots even if the <code>trimrtc</code> command is never used
(and the RTC is allowed to drift away from true time).  The
<code>trimrtc</code> command is provided as a method by which it can be
corrected, in a manner compatible with <code>chronyd</code> using it to
maintain accurate time across machine reboots.
</p>
<p>The <code>trimrtc</code> command can be executed automatically by <code>chronyd</code>
with the <code>rtcautotrim</code> directive (see section <a href="#rtcautotrim-directive">rtcautotrim</a>).
</p><hr>
<a name="waitsync-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#trimrtc-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#writertc-command" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="waitsync"></a>
<h4 class="subsubsection">4.3.4.50 waitsync</h4>
<p>The <code>waitsync</code> command waits for <code>chronyd</code> to synchronise.
</p>
<p>Up to three optional arguments can be specified, the first is the maximum
number of tries in 10 second intervals before giving up and returning a
non-zero error code.  When 0 is specified, or there are no arguments, the
number of tries will not be limited.
</p>
<p>The second and third arguments are the maximum allowed remaining correction of
the system clock and the maximum allowed skew (in ppm) as reported by the
<code>tracking</code> command (see section <a href="#tracking-command">tracking</a>) in the <code>System time</code>
and <code>Skew</code> fields.  If not specified or zero, the value will not be
checked.
</p>
<p>An example is
</p>
<div class="example">
<pre class="example">waitsync 60 0.01
</pre></div>

<p>which will wait up to about 10 minutes for <code>chronyd</code> to synchronise to a
source and the remaining correction to be less than 10 milliseconds.
</p><hr>
<a name="writertc-command"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#waitsync-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Chronyc-command-reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GPL" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="writertc"></a>
<h4 class="subsubsection">4.3.4.51 writertc</h4>
<p>The <code>writertc</code> command writes the currently estimated error and
gain/loss rate parameters for the RTC to the RTC file (specified with
the <code>rtcfile</code> directive (see section <a href="#rtcfile-directive">rtcfile</a>)).  This
information is also written automatically when <code>chronyd</code> is killed
(with SIGHUP, SIGINT, SIGQUIT or SIGTERM) or when the <code>trimrtc</code>
command is issued.
</p><hr>
<a name="GPL"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Usage-reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#writertc-command" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="GNU-General-Public-License"></a>
<h1 class="appendix">Appendix A GNU General Public License</h1>

<p align="center">GNU GENERAL PUBLIC LICENSE
</p><p align="center">Version 2, June 1991
</p>
<p> Copyright (C) 1989, 1991 Free Software Foundation, Inc.,
 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.
</p>
<p>			    Preamble
</p>
<p>  The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
License is intended to guarantee your freedom to share and change free
software&ndash;to make sure the software is free for all its users.  This
General Public License applies to most of the Free Software
Foundation&rsquo;s software and to any other program whose authors commit to
using it.  (Some other Free Software Foundation software is covered by
the GNU Lesser General Public License instead.)  You can apply it to
your programs, too.
</p>
<p>  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.
</p>
<p>  To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the rights.
These restrictions translate to certain responsibilities for you if you
distribute copies of the software, or if you modify it.
</p>
<p>  For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have.  You must make sure that they, too, receive or can get the
source code.  And you must show them these terms so they know their
rights.
</p>
<p>  We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.
</p>
<p>  Also, for each author&rsquo;s protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software.  If the software is modified by someone else and passed on, we
want its recipients to know that what they have is not the original, so
that any problems introduced by others will not reflect on the original
authors&rsquo; reputations.
</p>
<p>  Finally, any free program is threatened constantly by software
patents.  We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary.  To prevent this, we have made it clear that any
patent must be licensed for everyone&rsquo;s free use or not licensed at all.
</p>
<p>  The precise terms and conditions for copying, distribution and
modification follow.
</p>
<p>		    GNU GENERAL PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
</p>
<p>  0. This License applies to any program or other work which contains
a notice placed by the copyright holder saying it may be distributed
under the terms of this General Public License.  The &quot;Program&quot;, below,
refers to any such program or work, and a &quot;work based on the Program&quot;
means either the Program or any derivative work under copyright law:
that is to say, a work containing the Program or a portion of it,
either verbatim or with modifications and/or translated into another
language.  (Hereinafter, translation is included without limitation in
the term &quot;modification&quot;.)  Each licensee is addressed as &quot;you&quot;.
</p>
<p>Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the
Program (independent of having been made by running the Program).
Whether that is true depends on what the Program does.
</p>
<p>  1. You may copy and distribute verbatim copies of the Program&rsquo;s
source code as you receive it, in any medium, provided that you
conspicuously and appropriately publish on each copy an appropriate
copyright notice and disclaimer of warranty; keep intact all the
notices that refer to this License and to the absence of any warranty;
and give any other recipients of the Program a copy of this License
along with the Program.
</p>
<p>You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a fee.
</p>
<p>  2. You may modify your copy or copies of the Program or any portion
of it, thus forming a work based on the Program, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:
</p>
<p>    a) You must cause the modified files to carry prominent notices
    stating that you changed the files and the date of any change.
</p>
<p>    b) You must cause any work that you distribute or publish, that in
    whole or in part contains or is derived from the Program or any
    part thereof, to be licensed as a whole at no charge to all third
    parties under the terms of this License.
</p>
<p>    c) If the modified program normally reads commands interactively
    when run, you must cause it, when started running for such
    interactive use in the most ordinary way, to print or display an
    announcement including an appropriate copyright notice and a
    notice that there is no warranty (or else, saying that you provide
    a warranty) and that users may redistribute the program under
    these conditions, and telling the user how to view a copy of this
    License.  (Exception: if the Program itself is interactive but
    does not normally print such an announcement, your work based on
    the Program is not required to print an announcement.)
</p>
<p>These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote it.
</p>
<p>Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.
</p>
<p>In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.
</p>
<p>  3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:
</p>
<p>    a) Accompany it with the complete corresponding machine-readable
    source code, which must be distributed under the terms of Sections
    1 and 2 above on a medium customarily used for software interchange; or,
</p>
<p>    b) Accompany it with a written offer, valid for at least three
    years, to give any third party, for a charge no more than your
    cost of physically performing source distribution, a complete
    machine-readable copy of the corresponding source code, to be
    distributed under the terms of Sections 1 and 2 above on a medium
    customarily used for software interchange; or,
</p>
<p>    c) Accompany it with the information you received as to the offer
    to distribute corresponding source code.  (This alternative is
    allowed only for noncommercial distribution and only if you
    received the program in object code or executable form with such
    an offer, in accord with Subsection b above.)
</p>
<p>The source code for a work means the preferred form of the work for
making modifications to it.  For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable.  However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.
</p>
<p>If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.
</p>
<p>  4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense or distribute the Program is
void, and will automatically terminate your rights under this License.
However, parties who have received copies, or rights, from you under
this License will not have their licenses terminated so long as such
parties remain in full compliance.
</p>
<p>  5. You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Program or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.
</p>
<p>  6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions.  You may not impose any further
restrictions on the recipients&rsquo; exercise of the rights granted herein.
You are not responsible for enforcing compliance by third parties to
this License.
</p>
<p>  7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all.  For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.
</p>
<p>If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.
</p>
<p>It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.
</p>
<p>This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.
</p>
<p>  8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded.  In such case, this License incorporates
the limitation as if written in the body of this License.
</p>
<p>  9. The Free Software Foundation may publish revised and/or new versions
of the General Public License from time to time.  Such new versions will
be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.
</p>
<p>Each version is given a distinguishing version number.  If the Program
specifies a version number of this License which applies to it and &quot;any
later version&quot;, you have the option of following the terms and conditions
either of that version or of any later version published by the Free
Software Foundation.  If the Program does not specify a version number of
this License, you may choose any version ever published by the Free Software
Foundation.
</p>
<p>  10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the author
to ask for permission.  For software which is copyrighted by the Free
Software Foundation, write to the Free Software Foundation; we sometimes
make exceptions for this.  Our decision will be guided by the two goals
of preserving the free status of all derivatives of our free software and
of promoting the sharing and reuse of software generally.
</p>
<p>			    NO WARRANTY
</p>
<p>  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
PROVIDE THE PROGRAM &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
REPAIR OR CORRECTION.
</p>
<p>  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES.
</p>
<p>		     END OF TERMS AND CONDITIONS
</p>
<p>	    How to Apply These Terms to Your New Programs
</p>
<p>  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.
</p>
<p>  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least
the &quot;copyright&quot; line and a pointer to where the full notice is found.
</p>
<p>    &lt;one line to give the program&rsquo;s name and a brief idea of what it does.&gt;
    Copyright (C) &lt;year&gt;  &lt;name of author&gt;
</p>
<p>    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.
</p>
<p>    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
</p>
<p>    You should have received a copy of the GNU General Public License along
    with this program; if not, write to the Free Software Foundation, Inc.,
    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
</p>
<p>Also add information on how to contact you by electronic and paper mail.
</p>
<p>If the program is interactive, make it output a short notice like this
when it starts in an interactive mode:
</p>
<p>    Gnomovision version 69, Copyright (C) year name of author
    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type &lsquo;show w&rsquo;.
    This is free software, and you are welcome to redistribute it
    under certain conditions; type &lsquo;show c&rsquo; for details.
</p>
<p>The hypothetical commands &lsquo;show w&rsquo; and &lsquo;show c&rsquo; should show the appropriate
parts of the General Public License.  Of course, the commands you use may
be called something other than &lsquo;show w&rsquo; and &lsquo;show c&rsquo;; they could even be
mouse-clicks or menu items&ndash;whatever suits your program.
</p>
<p>You should also get your employer (if you work as a programmer) or your
school, if any, to sign a &quot;copyright disclaimer&quot; for the program, if
necessary.  Here is a sample; alter the names:
</p>
<p>  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
  &lsquo;Gnomovision&rsquo; (which makes passes at compilers) written by James Hacker.
</p>
<p>  &lt;signature of Ty Coon&gt;, 1 April 1989
  Ty Coon, President of Vice
</p>
<p>This General Public License does not permit incorporating your program into
proprietary programs.  If your program is a subroutine library, you may
consider it more useful to permit linking proprietary applications with the
library.  If this is what you want to do, use the GNU Lesser General
Public License instead of this License.
</p><hr size="6">
<a name="SEC_Contents"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Table of Contents</h1>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Introduction-1" href="#Introduction">1 Introduction</a>
  <ul class="no-bullet">
    <li><a name="toc-Overview-1" href="#Overview">1.1 Overview</a></li>
    <li><a name="toc-Acknowledgements-1" href="#Acknowledgements">1.2 Acknowledgements</a></li>
    <li><a name="toc-Availability-1" href="#Availability">1.3 Availability</a>
    <ul class="no-bullet">
      <li><a name="toc-Getting-the-software-1" href="#Getting-the-software">1.3.1 Getting the software</a></li>
      <li><a name="toc-Platforms-1" href="#Platforms">1.3.2 Platforms</a></li>
    </ul></li>
    <li><a name="toc-Relationship-to-other-software-packages" href="#Other-time-synchronisation-packages">1.4 Relationship to other software packages</a>
    <ul class="no-bullet">
      <li><a name="toc-ntpd" href="#Comparison-with-ntpd">1.4.1 ntpd</a></li>
      <li><a name="toc-timed" href="#Comparison-with-timed">1.4.2 timed</a></li>
    </ul></li>
    <li><a name="toc-Distribution-rights-and-_0028lack-of_0029-warranty" href="#Distribution-and-warranty">1.5 Distribution rights and (lack of) warranty</a></li>
    <li><a name="toc-Bug-reporting-and-suggestions" href="#Bug-reporting">1.6 Bug reporting and suggestions</a></li>
    <li><a name="toc-Contributions" href="#Contributing">1.7 Contributions</a></li>
  </ul></li>
  <li><a name="toc-Installation-1" href="#Installation">2 Installation</a>
  <ul class="no-bullet">
    <li><a name="toc-Support-for-line-editing-libraries" href="#line-editing-support">2.1 Support for line editing libraries</a></li>
    <li><a name="toc-Extra-options-for-package-builders" href="#package-builders">2.2 Extra options for package builders</a></li>
  </ul></li>
  <li><a name="toc-Typical-operating-scenarios" href="#Typical-scenarios">3 Typical operating scenarios</a>
  <ul class="no-bullet">
    <li><a name="toc-Computers-connected-to-the-internet" href="#Computers-on-the-net">3.1 Computers connected to the internet</a></li>
    <li><a name="toc-Infrequent-connection-to-true-NTP-servers" href="#Infrequent-connection">3.2 Infrequent connection to true NTP servers</a>
    <ul class="no-bullet">
      <li><a name="toc-Setting-up-the-configuration-file-for-infrequent-connections" href="#Configuration-for-infrequent-connections">3.2.1 Setting up the configuration file for infrequent connections</a></li>
      <li><a name="toc-How-to-tell-chronyd-when-the-internet-link-is-available_002e" href="#Advising-chronyd-of-internet-availability">3.2.2 How to tell chronyd when the internet link is available.</a></li>
    </ul></li>
    <li><a name="toc-Isolated-networks-1" href="#Isolated-networks">3.3 Isolated networks</a></li>
    <li><a name="toc-The-home-PC-with-a-dial_002dup-connection" href="#Dial_002dup-home-PCs">3.4 The home PC with a dial-up connection</a>
    <ul class="no-bullet">
      <li><a name="toc-Assumptions_002fhow-the-software-works" href="#Dial_002dup-overview">3.4.1 Assumptions/how the software works</a></li>
      <li><a name="toc-Typical-configuration-files_002e" href="#Dial_002dup-configuration">3.4.2 Typical configuration files.</a></li>
    </ul></li>
    <li><a name="toc-Other-important-configuration-options" href="#Configuration-options-overview">3.5 Other important configuration options</a></li>
  </ul></li>
  <li><a name="toc-Usage-reference-1" href="#Usage-reference">4 Usage reference</a>
  <ul class="no-bullet">
    <li><a name="toc-Starting-chronyd-1" href="#Starting-chronyd">4.1 Starting chronyd</a></li>
    <li><a name="toc-The-chronyd-configuration-file" href="#Configuration-file">4.2 The chronyd configuration file</a>
    <ul class="no-bullet">
      <li><a name="toc-Comments-in-the-configuration-file" href="#comments-in-config-file">4.2.1 Comments in the configuration file</a></li>
      <li><a name="toc-acquisitionport" href="#acquisitionport-directive">4.2.2 acquisitionport</a></li>
      <li><a name="toc-allow-1" href="#allow-directive">4.2.3 allow</a></li>
      <li><a name="toc-bindacqaddress" href="#bindacqaddress-directive">4.2.4 bindacqaddress</a></li>
      <li><a name="toc-bindaddress" href="#bindaddress-directive">4.2.5 bindaddress</a></li>
      <li><a name="toc-bindcmdaddress" href="#bindcmdaddress-directive">4.2.6 bindcmdaddress</a></li>
      <li><a name="toc-broadcast" href="#broadcast-directive">4.2.7 broadcast</a></li>
      <li><a name="toc-clientloglimit" href="#clientloglimit-directive">4.2.8 clientloglimit</a></li>
      <li><a name="toc-cmdallow-1" href="#cmdallow-directive">4.2.9 cmdallow</a></li>
      <li><a name="toc-cmddeny-1" href="#cmddeny-directive">4.2.10 cmddeny</a></li>
      <li><a name="toc-cmdport" href="#cmdport-directive">4.2.11 cmdport</a></li>
      <li><a name="toc-combinelimit" href="#combinelimit-directive">4.2.12 combinelimit</a></li>
      <li><a name="toc-commandkey" href="#commandkey-directive">4.2.13 commandkey</a></li>
      <li><a name="toc-corrtimeratio" href="#corrtimeratio-directive">4.2.14 corrtimeratio</a></li>
      <li><a name="toc-deny" href="#deny-directive">4.2.15 deny</a></li>
      <li><a name="toc-driftfile" href="#driftfile-directive">4.2.16 driftfile</a></li>
      <li><a name="toc-dumpdir" href="#dumpdir-directive">4.2.17 dumpdir</a></li>
      <li><a name="toc-dumponexit" href="#dumponexit-directive">4.2.18 dumponexit</a></li>
      <li><a name="toc-fallbackdrift" href="#fallbackdrift-directive">4.2.19 fallbackdrift</a></li>
      <li><a name="toc-generatecommandkey" href="#generatecommandkey-directive">4.2.20 generatecommandkey</a></li>
      <li><a name="toc-hwclockfile" href="#hwclockfile-directive">4.2.21 hwclockfile</a></li>
      <li><a name="toc-include" href="#include-directive">4.2.22 include</a></li>
      <li><a name="toc-initstepslew" href="#initstepslew-directive">4.2.23 initstepslew</a></li>
      <li><a name="toc-keyfile" href="#keyfile-directive">4.2.24 keyfile</a></li>
      <li><a name="toc-leapsecmode" href="#leapsecmode-directive">4.2.25 leapsecmode</a></li>
      <li><a name="toc-leapsectz" href="#leapsectz-directive">4.2.26 leapsectz</a></li>
      <li><a name="toc-local-1" href="#local-directive">4.2.27 local</a></li>
      <li><a name="toc-lock_005fall" href="#lock_005fall-directive">4.2.28 lock_all</a></li>
      <li><a name="toc-log" href="#log-directive">4.2.29 log</a>
      <ul class="no-bullet">
        <li><a name="toc-Measurements-log-file-format" href="#measurements-log">4.2.29.1 Measurements log file format</a></li>
        <li><a name="toc-Statistics-log-file-format" href="#statistics-log">4.2.29.2 Statistics log file format</a></li>
        <li><a name="toc-Tracking-log-file-format" href="#tracking-log">4.2.29.3 Tracking log file format</a></li>
        <li><a name="toc-Real_002dtime-clock-log-file-format" href="#RTC-log">4.2.29.4 Real-time clock log file format</a></li>
        <li><a name="toc-Refclocks-log-file-format" href="#refclocks-log">4.2.29.5 Refclocks log file format</a></li>
        <li><a name="toc-Tempcomp-log-file-format" href="#tempcomp-log">4.2.29.6 Tempcomp log file format</a></li>
      </ul></li>
      <li><a name="toc-logbanner" href="#logbanner-directive">4.2.30 logbanner</a></li>
      <li><a name="toc-logchange" href="#logchange-directive">4.2.31 logchange</a></li>
      <li><a name="toc-logdir" href="#logdir-directive">4.2.32 logdir</a></li>
      <li><a name="toc-mailonchange" href="#mailonchange-directive">4.2.33 mailonchange</a></li>
      <li><a name="toc-makestep-1" href="#makestep-directive">4.2.34 makestep</a></li>
      <li><a name="toc-manual-1" href="#manual-directive">4.2.35 manual</a></li>
      <li><a name="toc-maxchange" href="#maxchange-directive">4.2.36 maxchange</a></li>
      <li><a name="toc-maxclockerror" href="#maxclockerror-directive">4.2.37 maxclockerror</a></li>
      <li><a name="toc-maxsamples" href="#maxsamples-directive">4.2.38 maxsamples</a></li>
      <li><a name="toc-maxslewrate" href="#maxslewrate-directive">4.2.39 maxslewrate</a></li>
      <li><a name="toc-maxupdateskew-1" href="#maxupdateskew-directive">4.2.40 maxupdateskew</a></li>
      <li><a name="toc-minsamples" href="#minsamples-directive">4.2.41 minsamples</a></li>
      <li><a name="toc-minsources" href="#minsources-directive">4.2.42 minsources</a></li>
      <li><a name="toc-noclientlog" href="#noclientlog-directive">4.2.43 noclientlog</a></li>
      <li><a name="toc-peer" href="#peer-directive">4.2.44 peer</a></li>
      <li><a name="toc-pidfile" href="#pidfile-directive">4.2.45 pidfile</a></li>
      <li><a name="toc-pool" href="#pool-directive">4.2.46 pool</a></li>
      <li><a name="toc-port" href="#port-directive">4.2.47 port</a></li>
      <li><a name="toc-refclock" href="#refclock-directive">4.2.48 refclock</a></li>
      <li><a name="toc-reselectdist" href="#reselectdist-directive">4.2.49 reselectdist</a></li>
      <li><a name="toc-rtcautotrim" href="#rtcautotrim-directive">4.2.50 rtcautotrim</a></li>
      <li><a name="toc-rtcdevice" href="#rtcdevice-directive">4.2.51 rtcdevice</a></li>
      <li><a name="toc-rtcfile" href="#rtcfile-directive">4.2.52 rtcfile</a></li>
      <li><a name="toc-rtconutc" href="#rtconutc-directive">4.2.53 rtconutc</a></li>
      <li><a name="toc-rtcsync" href="#rtcsync-directive">4.2.54 rtcsync</a></li>
      <li><a name="toc-sched_005fpriority" href="#sched_005fpriority-directive">4.2.55 sched_priority</a></li>
      <li><a name="toc-server" href="#server-directive">4.2.56 server</a></li>
      <li><a name="toc-smoothtime" href="#smoothtime-directive">4.2.57 smoothtime</a></li>
      <li><a name="toc-stratumweight" href="#stratumweight-directive">4.2.58 stratumweight</a></li>
      <li><a name="toc-tempcomp" href="#tempcomp-directive">4.2.59 tempcomp</a></li>
      <li><a name="toc-user" href="#user-directive">4.2.60 user</a></li>
    </ul></li>
    <li><a name="toc-Running-chronyc-1" href="#Running-chronyc">4.3 Running chronyc</a>
    <ul class="no-bullet">
      <li><a name="toc-Basic-use" href="#Chronyc-basic-use">4.3.1 Basic use</a></li>
      <li><a name="toc-Command-line-options" href="#Chronyc-command-line-options">4.3.2 Command line options</a></li>
      <li><a name="toc-Security-with-chronyc-1" href="#Security-with-chronyc">4.3.3 Security with chronyc</a></li>
      <li><a name="toc-Command-reference" href="#Chronyc-command-reference">4.3.4 Command reference</a>
      <ul class="no-bullet">
        <li><a name="toc-accheck" href="#accheck-command">4.3.4.1 accheck</a></li>
        <li><a name="toc-activity" href="#activity-command">4.3.4.2 activity</a></li>
        <li><a name="toc-add-peer" href="#add-peer-command">4.3.4.3 add peer</a></li>
        <li><a name="toc-add-server" href="#add-server-command">4.3.4.4 add server</a></li>
        <li><a name="toc-allow-all" href="#allow-all-command">4.3.4.5 allow all</a></li>
        <li><a name="toc-allow" href="#allow-command">4.3.4.6 allow</a></li>
        <li><a name="toc-authhash" href="#authhash-command">4.3.4.7 authhash</a></li>
        <li><a name="toc-burst" href="#burst-command">4.3.4.8 burst</a></li>
        <li><a name="toc-clients" href="#clients-command">4.3.4.9 clients</a></li>
        <li><a name="toc-cmdaccheck" href="#cmdaccheck-command">4.3.4.10 cmdaccheck</a></li>
        <li><a name="toc-cmdallow-all" href="#cmdallow-all-command">4.3.4.11 cmdallow all</a></li>
        <li><a name="toc-cmdallow" href="#cmdallow-command">4.3.4.12 cmdallow</a></li>
        <li><a name="toc-cmddeny-all" href="#cmddeny-all-command">4.3.4.13 cmddeny all</a></li>
        <li><a name="toc-cmddeny" href="#cmddeny-command">4.3.4.14 cmddeny</a></li>
        <li><a name="toc-cyclelogs" href="#cyclelogs-command">4.3.4.15 cyclelogs</a></li>
        <li><a name="toc-delete" href="#delete-command">4.3.4.16 delete</a></li>
        <li><a name="toc-deny-all" href="#deny-all-command">4.3.4.17 deny all</a></li>
        <li><a name="toc-deny-1" href="#deny-command">4.3.4.18 deny</a></li>
        <li><a name="toc-dns" href="#dns-command">4.3.4.19 dns</a></li>
        <li><a name="toc-dump" href="#dump-command">4.3.4.20 dump</a></li>
        <li><a name="toc-exit" href="#exit-command">4.3.4.21 exit</a></li>
        <li><a name="toc-help" href="#help-command">4.3.4.22 help</a></li>
        <li><a name="toc-local" href="#local-command">4.3.4.23 local</a></li>
        <li><a name="toc-makestep" href="#makestep-command">4.3.4.24 makestep</a></li>
        <li><a name="toc-manual" href="#manual-command">4.3.4.25 manual</a></li>
        <li><a name="toc-maxdelay" href="#maxdelay-command">4.3.4.26 maxdelay</a></li>
        <li><a name="toc-maxdelaydevratio" href="#maxdelaydevratio-command">4.3.4.27 maxdelaydevratio</a></li>
        <li><a name="toc-maxdelayratio" href="#maxdelayratio-command">4.3.4.28 maxdelayratio</a></li>
        <li><a name="toc-maxpoll" href="#maxpoll-command">4.3.4.29 maxpoll</a></li>
        <li><a name="toc-maxupdateskew" href="#maxupdateskew-command">4.3.4.30 maxupdateskew</a></li>
        <li><a name="toc-minpoll" href="#minpoll-command">4.3.4.31 minpoll</a></li>
        <li><a name="toc-minstratum" href="#minstratum-command">4.3.4.32 minstratum</a></li>
        <li><a name="toc-offline" href="#offline-command">4.3.4.33 offline</a></li>
        <li><a name="toc-online" href="#online-command">4.3.4.34 online</a></li>
        <li><a name="toc-password" href="#password-command">4.3.4.35 password</a></li>
        <li><a name="toc-polltarget" href="#polltarget-command">4.3.4.36 polltarget</a></li>
        <li><a name="toc-quit" href="#quit-command">4.3.4.37 quit</a></li>
        <li><a name="toc-reselect" href="#reselect-command">4.3.4.38 reselect</a></li>
        <li><a name="toc-reselectdist-1" href="#reselectdist-command">4.3.4.39 reselectdist</a></li>
        <li><a name="toc-retries" href="#retries-command">4.3.4.40 retries</a></li>
        <li><a name="toc-rtcdata" href="#rtcdata-command">4.3.4.41 rtcdata</a></li>
        <li><a name="toc-settime" href="#settime-command">4.3.4.42 settime</a></li>
        <li><a name="toc-smoothing" href="#smoothing-command">4.3.4.43 smoothing</a></li>
        <li><a name="toc-smoothtime-1" href="#smoothtime-command">4.3.4.44 smoothtime</a></li>
        <li><a name="toc-sources" href="#sources-command">4.3.4.45 sources</a></li>
        <li><a name="toc-sourcestats" href="#sourcestats-command">4.3.4.46 sourcestats</a></li>
        <li><a name="toc-timeout" href="#timeout-command">4.3.4.47 timeout</a></li>
        <li><a name="toc-tracking" href="#tracking-command">4.3.4.48 tracking</a></li>
        <li><a name="toc-trimrtc" href="#trimrtc-command">4.3.4.49 trimrtc</a></li>
        <li><a name="toc-waitsync" href="#waitsync-command">4.3.4.50 waitsync</a></li>
        <li><a name="toc-writertc" href="#writertc-command">4.3.4.51 writertc</a></li>
      </ul>
</li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-GNU-General-Public-License" href="#GPL">Appendix A GNU General Public License</a></li>
</ul>
</div>
<hr>
<a name="SEC_About"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[Index]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>

<p>
  This document was generated on <i>April 4, 2016</i> using <a href="http://www.nongnu.org/texi2html/"><i>texi2html 5.0</i></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr>
